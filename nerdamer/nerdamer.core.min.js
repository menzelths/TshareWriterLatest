var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,g,m){p!=Array.prototype&&p!=Object.prototype&&(p[g]=m.value)};$jscomp.getGlobal=function(p){return"undefined"!=typeof window&&window===p?p:"undefined"!=typeof global&&null!=global?global:p};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(p){return $jscomp.SYMBOL_PREFIX+(p||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var p=$jscomp.global.Symbol.iterator;p||(p=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[p]&&$jscomp.defineProperty(Array.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(p){var g=0;return $jscomp.iteratorPrototype(function(){return g<p.length?{done:!1,value:p[g++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(p){$jscomp.initSymbolIterator();p={next:p};p[$jscomp.global.Symbol.iterator]=function(){return this};return p};$jscomp.iteratorFromArray=function(p,g){$jscomp.initSymbolIterator();p instanceof String&&(p+="");var m=0,r={next:function(){if(m<p.length){var l=m++;return{value:g(l,p[l]),done:!1}}r.next=function(){return{done:!0,value:void 0}};return r.next()}};r[Symbol.iterator]=function(){return r};return r};
$jscomp.polyfill=function(p,g,m,r){if(g){m=$jscomp.global;p=p.split(".");for(r=0;r<p.length-1;r++){var l=p[r];l in m||(m[l]={});m=m[l]}p=p[p.length-1];r=m[p];g=g(r);g!=r&&null!=g&&$jscomp.defineProperty(m,p,{configurable:!0,writable:!0,value:g})}};$jscomp.polyfill("Array.prototype.keys",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(g){return g})}},"es6-impl","es3");
$jscomp.polyfill("Math.cosh",function(p){if(p)return p;var g=Math.exp;return function(m){m=Number(m);return(g(m)+g(-m))/2}},"es6-impl","es3");$jscomp.polyfill("Math.sign",function(p){return p?p:function(g){g=Number(g);return 0===g||isNaN(g)?g:0<g?1:-1}},"es6-impl","es3");$jscomp.polyfill("Math.sinh",function(p){if(p)return p;var g=Math.exp;return function(m){m=Number(m);return 0===m?m:(g(m)-g(-m))/2}},"es6-impl","es3");
$jscomp.polyfill("Math.tanh",function(p){return p?p:function(g){g=Number(g);if(0===g)return g;var m=Math.exp(-2*Math.abs(g)),m=(1-m)/(1+m);return 0>g?-m:m}},"es6-impl","es3");$jscomp.polyfill("Math.asinh",function(p){return p?p:function(g){g=Number(g);if(0===g)return g;var m=Math.log(Math.abs(g)+Math.sqrt(g*g+1));return 0>g?-m:m}},"es6-impl","es3");$jscomp.polyfill("Math.acosh",function(p){return p?p:function(g){g=Number(g);return Math.log(g+Math.sqrt(g*g-1))}},"es6-impl","es3");
$jscomp.polyfill("Math.log1p",function(p){return p?p:function(g){g=Number(g);if(.25>g&&-.25<g){for(var m=g,p=1,l=g,ia=0,M=1;ia!=l;)m*=g,M*=-1,l=(ia=l)+M*m/++p;return l}return Math.log(1+g)}},"es6-impl","es3");$jscomp.polyfill("Math.atanh",function(p){if(p)return p;var g=Math.log1p;return function(m){m=Number(m);return(g(m)-g(-m))/2}},"es6-impl","es3");$jscomp.polyfill("Math.log10",function(p){return p?p:function(g){return Math.log(g)/Math.LN10}},"es6-impl","es3");
var nerdamer=function(p){function g(a,c,k){var b="hash"===c;var v="decimals"===c||"decimal"===c,f=b?void 0:c;if(d(a)){var l="",m=c="";k=a.group||k;var C=a.value;if(!b){var u=v?a.multiplier.valueOf():a.multiplier.toString();"-1"==u&&(m="-",u="1");"1"!=u&&(l=u);u=a.power?v?a.power.valueOf():a.power.toString():"";"1"!=u&&(c=d(u)?g(u,f):u)}switch(k){case D:l="";C="-1"==a.multiplier?"1":v?a.valueOf():a.multiplier.toString();c="";break;case z:C=a.collectSymbols(g,f).join("+").replace(/\+\-/g,"-");break;
case J:C=a.collectSymbols(g,f).join("+").replace(/\+\-/g,"-");break;case B:C=a.collectSymbols(function(a){var c=a.group;return(c===z||c===J)&&a.power.equals(1)&&a.multiplier.equals(1)?T(g(a,f)):g(a,f)}).join("*");break;case F:var u=a.previousGroup,h=a.power.group;u===z&&(C=a.collectSymbols(g,f).join("+").replace("+-","-"));u===D||u===R||u===P||b||(C=T(C));h!==J&&h!==B&&h!==z&&"1"==a.power.multiplier.toString()||!c||(c=T(c))}k===P&&v&&(C=a.fname+T(a.args.map(function(a){return g(a,f)}).join(",")));
!c||E(c)||k===F||v||(c=T(c));if((k===J||k===z)&&(l&&"1"!=l||"-"===m)||(k===B||k===J||k===z)&&c&&"1"!=c||!b&&k===Q&&-1==C||a.fname===la)C=T(C);b=m+l;!l||E(l)||v||(b=T(b));0>c&&(c=T(c));l&&(b+="*");c&&(c=y.POWER_OPERATOR+c);k===F&&"-"===C.charAt(0)&&(C=T(C));v=b+C;a.parens&&(v=T(v));return v+c}if(x(a)){v=a.elements.length;b=[];for(c=0;c<v;c++)b.push(a.elements[c].text());return"["+b.join(",")+"]"}try{return a.toString()}catch(Na){return""}}function m(a){this.symbol=a}function r(a){if(a instanceof r)return a;
if(void 0===a)return this;E(a)?(this.num=U(a),this.den=U(1)):(a=Ba.convert(a),this.num=new U(a[0]),this.den=new U(a[1]))}function l(a){if(!(this instanceof l))return new l(a);isNaN(a)||"Infinity"===a?(this.group=R,ba(a),this.value=a,this.multiplier=new r(1),this.imaginary=a===y.IMAGINARY):(this.group=D,this.value=ta,this.multiplier=new r(a));this.power=new r(1);return this}function ia(a){if(ja(a))return[a];for(var c=a,b=1,e=[];b<c;){var d=a/b,f=Math.floor(d);2.220446049250313E-16>=d-f&&1<b&&(-1!==
ca.indexOf(b)&&e.push(b),c=f);b++}return e.sort(function(a,c){return a-c})}function M(a,c,b,e,d,f,g){this.val=a;this.fn=c;this.precedence=b;this.left_assoc=e;this.is_prefix=d;this.is_postfix=f||!1;this.operation=g;this.is_operator=!0}function qa(a,c,b,e,d){this.val=a;this.bracket_id=c;this.open=!!b;this.fn=e;this.type=d}function ma(a){this.operation=a.operation;this.val=a.val;this.is_prefix_operator=!0}function ua(a){this.message=a||""}function Z(a){this.message=a||""}function pa(){function a(a){return y.PARSE2NUMBER?
a:q.symfunction("parens",[a])}function c(a){a.multiplier.lessThan(0)&&a.multiplier.negate();if(u(a)||fa(a.power))return a;if(a.isComposite()){var c=[];a.each(function(a){c.push(a.multiplier)});V.QGCD.apply(null,c).lessThan(0)&&(a.multiplier=a.multiplier.multiply(new r(-1)),a.distributeMultiplier())}return q.symfunction(ra,[a])}function b(a){return y.PARSE2NUMBER&&a.isConstant()?(a=E(a)?V.bigfactorial(a):V.gamma(a.multiplier.toDecimal()+1),w(a)):q.symfunction(na,[a])}function e(a){""===a.fname&&a.power.equals(1)&&
(a=a.args[0]);if(y.PARSE2NUMBER&&a.isConstant()&&!a.multiplier.lessThan(0))return new l(Math.sqrt(a.multiplier.toDecimal()));var c=a.isConstant();if(a.group===B&&a.isLinear()){c=e(l(a.multiplier));for(b in a.symbols){var n=a.symbols[b];c=q.multiply(c,e(n))}a=c}else if(a.fname===aa){var b=a.args[0];b.setPower(a.power.multiply(new r(.25)));a=b}else if(a.power.isInteger()){if(c&&a.multiplier.lessThan(0)){var k=l.imaginary();a.multiplier=a.multiplier.abs()}b=a.multiplier.toDecimal();c=Math.sqrt(Math.abs(b));
if(E(c))c=new l(c);else if(E(b)){var d=V.ifactor(b),f=1;for(n in d)if(c=d[n],c-=c%2){var v=Math.pow(n,c),f=f*Math.pow(n,c/2);b/=v}c=q.multiply(q.symfunction(aa,[new l(b)]),new l(f))}else c=a.multiplier.num.toString(),n=a.multiplier.den.toString(),b=Math.sqrt(c),d=Math.sqrt(n),c=q.multiply("1"===c?new l(1):E(b)?new l(b):q.symfunction(aa,[new l(c)]),"1"===n?new l(1):E(d)?(new l(d)).invert():q.symfunction(aa,[new l(n)]).invert());a=a.toUnitMultiplier(!0);a=a.isOne()?a:fa(a.power.toString())?q.pow(a.clone(),
new l(.5)):q.symfunction(aa,[a]);c&&(a=q.multiply(c,a));k&&(a=q.multiply(k,a))}else a.setPower(a.power.multiply(new r(.5)));return a}function f(a,c){if(x(c)){var n=new W;c.each(function(c){n.elements.push(f(a.clone(),c))});return n}return Y("PARSE2NUMBER",function(){return q.pow(a,c.invert())},!0)}function m(a){var c=new l(1);if(a.isConstant()){var n=a.multiplier.toDecimal();if(E(n)){a=V.ifactor(n);for(var b in a)n=a[b],c=q.multiply(c,q.symfunction("parens",[(new l(b)).setPower(new r(n))]))}else c=
m(new l(a.multiplier.num)),b=m(new l(a.multiplier.den)),c=q.multiply(q.symfunction("parens",[c]),q.symfunction("parens",[b]).invert())}return c}function h(a){a.equals(0)&&G("log(0) is undefined!");if(a.group===F&&a.power.multiplier.lessThan(0)||"-1"===a.power.toString())a.power.negate(),a=h(a).negate();else if("e"===a.value&&a.multiplier.equals(1)){var c=a.power;a=d(c)?c:new l(c)}else if(a.group===P&&"exp"===a.fname)c=a.args[0],a=a.multiplier.equals(1)?q.multiply(c,new l(a.power)):q.symfunction("log",
[a]);else if(y.PARSE2NUMBER&&u(a)){if(a.multiplier.lessThan(0)){a.negate();var n=q.multiply(new l(Math.PI),new l("i"))}a=new l(Math.log(a.multiplier.toDecimal()));n&&(a=q.add(a,n))}else a.power.equals(1)||(c=a.group===F?a.power:new l(a.power),a.toLinear()),a=q.symfunction("log",[a]),c&&(a=q.multiply(c,a));return a}function p(a){a%=2;0>a&&(a=2+a);return 0<=a&&.5>=a?1:.5<a&&1>=a?2:1<a&&1.5>=a?3:4}function w(a){if(!isFinite(a)){var c=Math.sign(a);a=new l(String(Math.abs(a)));a.multiplier=a.multiplier.multiply(new r(c));
return a}if(d(a))return a;"number"===typeof a&&(a=r.simple(a));c=new l(0);c.multiplier=a;return c}function A(a){var c=a.group;if(c===J){var c=a.getNum(),b=a.getDenom()||new l(1),n=Number(a.power),k=new l(1);if(1===Math.abs(n)){b.each(function(a){a.group===B?k=q.multiply(k,A(a.getDenom())):a.power.lessThan(0)&&(k=q.multiply(k,A(a.clone().toUnitMultiplier())))});var e=new l(0);b.each(function(a){e=q.add(q.divide(a,k.clone()),e)});k.invert();if(c.isComposite()){var d=new l(0);c.each(function(a){d=q.add(q.multiply(A(a),
k.clone()),d)})}else d=q.multiply(k,c);var f=q.divide(d,e)}}else c===B?(f=new l(1),a.each(function(a){f=q.multiply(f,q.clean(a))})):c===P&&1===a.args.length&&a.args[0].isConstant()&&(f=Y("PARSE2NUMBER",function(){return q.parse(a)},!0));f||(f=a);return f}function T(a){if(!a.symbols)return a;var c=a.clone();try{var b=a.power;var k=a.multiplier,n=Number(b);if(!a.symbols)return a;for(t in a.symbols){var e=a.symbols[t];a.symbols[t]=T(e)}a=q.parse(a);if(E(b)&&0<n&&a.isComposite()){a=a.toLinear().toUnitMultiplier();
var f=a.clone();for(var v=0;v<n-1;v++){var g=new l(0);for(t in a.symbols){e=a.symbols[t];for(var x in f.symbols){var m=f.symbols[x];var C=q.expand(q.multiply(e.clone(),m.clone())),X=Number(C.power);if(C.group===B&&1!==X||C.group===z&&1!==X)C=T(C);g=q.add(g,C)}}f=g}if(!k.equals(1))for(t in f.symbols)e=f.symbols[t],e.multiplier=e.multiplier.multiply(k),e.isComposite()&&e.distributeMultiplier(),a.symbols[t]=e;return f}if(a.group===B){var k=!1,u=a.power;for(e in a.symbols){var h=a.symbols[e];if(h.isComposite()){k=
!0;break}d(h.power)||d(u)?(h.power=q.multiply(h.power,l(u)),h.group=F):h.power=h.power.multiply(u)}a.toLinear();a=q.parse(a.text());if(!k)return a;f=new l(0);var u=[],H=new l(a.multiplier);for(t in a.symbols)e=a.symbols[t],e.isComposite()?(b=e.power,h=!1,E(b)&&0>b&&(e.power.negate(),h=!0),h?(e.power.negate(),H=q.multiply(H,e)):u.push(e)):H=q.multiply(H,e);var p=u.length;f=u[0];for(v=1;v<p;v++){g=new l(0);var t=u[v];for(var ea in f.symbols)for(x in e=f.symbols[ea],t.symbols){m=t.symbols[x];var r=q.multiply(e.clone(),
m.clone());g=q.add(g,r)}f=g}var A=new l(0);for(t in f.symbols)e=f.symbols[t],A=q.add(A,T(q.multiply(H,e)));a=A}}catch(Oa){return c}return a}function L(a){a=xa(q.parse(a));return a.contains(y.IMAGINARY,!0)?a.symbols.i.multiplier:0}function wa(a){return""+xa(q.parse(a)).contains(y.IMAGINARY,!0)}function S(){return new W([].slice.call(arguments))}function U(){return O.fromArray(arguments)}function Ca(a,c){if(x(a)&&x(c))return a.dot(c);G("function dot expects 2 vectors")}function Da(a){if(C(a))return a.transpose();
G("function transpose expects a matrix")}function ya(a){if(C(a))return a.invert();G("invert expects a matrix")}function ca(a){if(!d(a.power)&&a.power.absEquals(.5)){var c=a.power.sign();return e(a.group===Q?new l(a.value):a.toLinear()).setPower(new r(c))}return a}function ga(a){if(a.group===Q){var c=a.group===D?a.multiplier.toDecimal():a.value,b=ia(c)[0],c=(new r(Math.log(c)/Math.log(b))).multiply(a.power);if(c.den>a.power.den)return a;a=E(c)?l(Math.pow(b,c)):(new l(b)).setPower(c)}return a}var q=
this,ha={},ja=this.constants={PI:Math.PI,E:Math.E},ba={e:Math.E,pi:Math.PI},oa=this.operators={"^":new M("^","pow",6,!1,!1),"**":new M("**","pow",6,!1,!1),"!!":new M("!!","dfactorial",5,!1,!1,!0,function(a){return q.symfunction(sa,[a])}),"!":new M("!","factorial",5,!1,!1,!0,function(a){return q.symfunction(na,[a])}),"!+":new M("!+","factadd",3,!0,!0,!1),"!!+":new M("!!+","dfactadd",3,!0,!0,!1),"!-":new M("!-","factsub",3,!0,!0,!1),"!!-":new M("!!-","dfactsub",3,!0,!0,!1),"*":new M("*","multiply",
4,!0,!1),"/":new M("/","divide",4,!0,!1),"+":new M("+","add",3,!0,!0,!1,function(a){return a}),"-":new M("-","subtract",3,!0,!0,!1,function(a){return a.negate()}),"=":new M("=","equals",2,!1,!1),"==":new M("==","eq",1,!1,!1),"<":new M("<","lt",1,!1,!1),"<=":new M("<=","lte",1,!1,!1),">":new M(">","gt",1,!1,!1),">=":new M(">=","gte",1,!1,!1),",":new M(",","comma",0,!0,!1)},Z={"(":new qa("(",0,!0,null,"round"),")":new qa(")",0,!1,null,"round"),"[":new qa("[",1,!0,function(){var a=new l("vector");a.is_function=
!0;return a},"square"),"]":new qa("]",1,!1,null,"square")},ka=this.functions={cos:[function(a){if(y.PARSE2NUMBER&&a.isConstant())return new l(Math.cos(a.valueOf()));var c=!1,b=p(a.multiplier.toDecimal()),k=a.multiplier.abs();a.multiplier=k;if(a.isPi()&&a.isLinear())if(E(k))var n=new l(fa(k)?1:-1);else n=Number(k.den),2===n?n=new l(0):3===n?(n=q.parse("1/2"),c=!0):4===n?(n=q.parse("1/sqrt(2)"),c=!0):6===n?(n=q.parse("sqrt(3)/2"),c=!0):n=q.symfunction("cos",[a]);!c||2!==b&&3!==b||n.negate();n||(n=q.symfunction("cos",
[a]));return n},1],sin:[function(a){if(y.PARSE2NUMBER&&a.isConstant())return new l(Math.sin(a.valueOf()));var c=!1,b=p(a.multiplier.toDecimal()),k=a.multiplier.sign(),n=a.multiplier.abs();a.multiplier=n;if(a.isPi()&&a.isLinear())if(E(n))var e=new l(0);else e=n.den,2==e?(e=new l(1),c=!0):3==e?(e=q.parse("sqrt(3)/2"),c=!0):4==e?(e=q.parse("1/sqrt(2)"),c=!0):6==e?(e=q.parse("1/2"),c=!0):e=q.symfunction("sin",[a]);e||(e=q.multiply(new l(k),q.symfunction("sin",[a])));!c||3!==b&&4!==b||e.negate();return e},
1],tan:[function(a){if(y.PARSE2NUMBER&&a.isConstant())return new l(Math.tan(a.valueOf()));var c=!1,b=p(a.multiplier.toDecimal()),k=a.multiplier;a.multiplier=k;if(a.isPi()&&a.isLinear())if(E(k))var n=new l(0);else k=k.den,2==k?G("tan is undefined for "+a.toString()):3==k?(n=q.parse("sqrt(3)"),c=!0):4==k?(n=new l(1),c=!0):6==k?(n=q.parse("1/sqrt(3)"),c=!0):n=q.symfunction("tan",[a]);n||(n=q.symfunction("tan",[a]));!c||2!==b&&4!==b||n.negate();return n},1],sec:[function(a){if(y.PARSE2NUMBER&&a.isConstant())return new l(V.sec(a.valueOf()));
var c=!1,b=p(a.multiplier.toDecimal()),k=a.multiplier.abs();a.multiplier=k;if(a.isPi()&&a.isLinear())if(E(k))var n=new l(fa(k)?1:-1);else k=k.den,2==k?G("sec is undefined for "+a.toString()):3==k?(n=new l(2),c=!0):4==k?(n=q.parse("sqrt(2)"),c=!0):6==k?(n=q.parse("2/sqrt(3)"),c=!0):n=q.symfunction("sec",[a]);!c||2!==b&&3!==b||n.negate();n||(n=q.symfunction("sec",[a]));return n},1],csc:[function(a){if(y.PARSE2NUMBER&&a.isConstant())return new l(V.csc(a.valueOf()));var c=!1,b=p(a.multiplier.toDecimal()),
k=a.multiplier.abs();a.multiplier=k;if(a.isPi()&&a.isLinear())if(E(k))G("csc is undefined for "+a.toString());else{var n=k.den;2==n?(n=new l(1),c=!0):3==n?(n=q.parse("2/sqrt(3)"),c=!0):4==n?(n=q.parse("sqrt(2)"),c=!0):6==n?(n=new l(2),c=!0):n=q.symfunction("csc",[a])}n||(n=q.symfunction("csc",[a]));!c||3!==b&&4!==b||n.negate();return n},1],cot:[function(a){if(y.PARSE2NUMBER&&a.isConstant())return new l(V.cot(a.valueOf()));var c=!1,b=p(a.multiplier.toDecimal()),k=a.multiplier;a.multiplier=k;if(a.isPi()&&
a.isLinear())if(E(k))G("cot is undefined for "+a.toString());else{var n=k.den;2==n?n=new l(0):3==n?(n=q.parse("1/sqrt(3)"),c=!0):4==n?(n=new l(1),c=!0):6==n?(n=q.parse("sqrt(3)"),c=!0):n=q.symfunction("cot",[a])}n||(n=q.symfunction("cot",[a]));!c||2!==b&&4!==b||n.negate();return n},1],acos:[,1],asin:[,1],atan:[,1],sinh:[,1],cosh:[,1],tanh:[,1],asinh:[,1],acosh:[,1],atanh:[,1],log10:[,1],exp:[,1],min:[,-1],max:[,-1],erf:[,1],floor:[,1],ceil:[,1],Si:[,1],step:[,1],rect:[,1],sinc:[,1],tri:[,1],sign:[,
1],Ci:[,1],Ei:[,1],Shi:[,1],Chi:[,1],fib:[,1],fact:[b,1],factorial:[b,1],dfactorial:[,1],gamma_incomplete:[,[1,2]],round:[,1],mod:[function(a,c){if(a.isConstant()&&c.isConstant()){var b=new l(1);b.multiplier=b.multiplier.multiply(a.multiplier.mod(c.multiplier));return b}return q.symfunction("mod",[a,c])},2],pfactor:[m,1],vector:[S,-1],matrix:[U,-1],parens:[a,-1],sqrt:[e,1],nthroot:[f,2],log:[h,1],expand:[T,1],abs:[c,1],invert:[ya,1],transpose:[Da,1],dot:[Ca,2],cross:[function(a,c){if(x(a)&&x(c))return a.cross(c);
G("function cross expects 2 vectors")},2],vecget:[function(a,c){return a.elements[c]},2],vecgetlength:[function(a){return a.elements.length},1],vecreal:[function(a){for(var c=new W,b=0,k=0;k<a.elements.length;k++)"false"==wa(a.elements[k])&&(c.elements[b+1]=a.elements[k],b++);c.elements[0]=xa(q.parse(b));return c},1],isimaginary:[wa,1],im:[L,1],re:[function(a){return xa(q.subtract(a,q.multiply(q.parse(L(a)),q.parse(y.IMAGINARY))))},1],vecset:[function(a,c,b){a.elements[c]=b;return a},3],matget:[function(a,
c,b){return a.elements[c][b]},3],matset:[function(a,c,b,k){a.elements[c][b]=k;return a},4],imatrix:[function(a){return O.identity(a)},1],IF:[function(a,c,b){"boolean"!==typeof a&&u(a)&&(a=!!Number(a));return a?c:b},3]};this.error=G;this.override=function(a,c){ha[a]||(ha[a]=[]);ha[a].push(this[a]);this[a]=c};this.restore=function(a){this[a]&&(this[a]=ha[a].pop())};this.extend=function(a,c,b){var k=this;if("function"===typeof this[a]&&"function"===typeof c){var e=this[a];this[a]=function(a,n){return d(a)&&
d(n)&&!b?e.call(k,a,n):c.call(k,a,n,e)}}};this.symfunction=function(a,c){var b=new l(a);b.group=P;"object"===typeof c&&(c=[].slice.call(c));b.args=c;b.fname=a===la?"":a;b.updateHash();return b};this.callfunction=function(a,c){var b=ka[a];b||G("Nerdamer currently does not support the function "+a);var k=b[1]||allowed_args,e=b[0];c instanceof Array||(c=void 0!==c?[c]:[]);if(-1!==k){var n=H(k),d=n?k[0]:k,k=n?k[1]:k,n=c.length,K=a+" requires a {0} of {1} arguments. {2} provided!";n<d&&G(va(K,"minimum",
d,n));n>k&&G(va(K,"maximum",k,n))}if(e)a=e.apply(b[2],c);else{a:{e=y.FUNCTION_MODULES;b=e.length;for(d=0;d<b;d++)if(k=e[d],a in k){e=k[a];break a}G("The function "+a+" is undefined!");e=void 0}if(b=y.PARSE2NUMBER)a:{for(b=0;b<c.length;b++)if(c[b].group!==D){b=!1;break a}b=!0}a=b?w(e.apply(e,c)):q.symfunction(a,c)}return a};this.operator_filter_regex=function(){var a="^\\"+Object.keys(oa).filter(function(a){if(1===a.length)return a}).join("\\");return new RegExp("(["+a+"])\\s+(["+a+"])")}();this.parseTree=
function(a){for(var c=[],b=a.length,k=0;k<b;k++){var e=a[k];if(e.is_prefix_operator||e.is_postfix)c.push(e.operation(c.pop()));else if(e.is_operator){var n=c.pop(),d=c.pop();H(n)&&q.error('Unrecognized function "'+d.value+'"');c.push(this[e.fn](d,n))}else e.value in ka?c.push(q.callfunction(e.value,c.pop())):""===e?c.push(new l(0)):(n=e,e in ja?e=new l(ja[e]):e in ba?e=ba[e].clone():e in da&&(e=da[e].clone()),e.unsubbed=n,c.push(e))}return c[0]||new l(0)};this.parse=function(a,c,b){var k;if(c){for(var e in c)c[e]=
q.parse(c[e]);ba=c}else ba={};y.PARSE2NUMBER&&(ba.e=new l(Math.E),ba.pi=new l(Math.PI));for(var n=String(a);;){a=this.operator_filter_regex.exec(n);if(!a)break;n=n.replace(a[0],a[1]+"*"+a[2])}n=n.split(" ").join("").replace(/\d+\.*\d*e\+?\-?\d+/gi,function(a){return I(a)}).replace(/([\+\-\/\*]*[0-9]+)([a-z_]+[\+\-\/\*]*)/gi,function(a,c,b,k,e){a="";var n="*";e.charAt(k).match(/[\+\-\/\*]/)||(a=e.charAt(k-1));a.match(/[a-z]/i)&&(n="");return c+n+b}).replace(/([a-z0-9_]+)(\()|(\))([a-z0-9]+)/gi,function(a,
c,b,k,e){a=c||k;b=b||e;return a in ka?a+b:a+"*"+b}).replace(/\)\(/g,")*(")||"0";a=n.length;var d=[],K=[],f=0;c=[0,0];var v=[],g=!0;e=function(a){a!==f&&(X=new l(n.substring(f,a)),d.push(X),g=!1)};for(var x=function(a){a.is_prefix||G(a+" is not a valid prefix operator")},m=function(a,c){return c?a.val===c.val?new ma(oa["+"]):new ma(oa["-"]):a},C=function(a){var c=K.length;c&&K[c-1].is_prefix_operator&&K.push(m(a,K.pop()));K.push(a)},Ga=function(a){if(v.length){for(var c=v.pop();v.length;)c=m(c,v.pop());
a?d.push(c):K.push(c)}},X,u=0,u=0;u<a;u++){var h=n.charAt(u);if(h in oa){e(u);for(k=u;n.charAt(u+1)in oa;)u++;h=u+1;for(var t=n.substring(k,h);!(t in oa);){var H=t.length-1;k=oa[t.charAt(H)];t=t.substring(0,H);try{x(k),v.push(new ma(k))}catch(Ha){H=t.length;for(var p,E=0;E<H;E++)p=oa[t.charAt(E)],(!p||p&&!p.is_postfix)&&G(Ha.message);p="";do{if(""===t)break;t in oa?(d.push(oa[t]),t=p,p=""):(H=t.length-1,p+=t.charAt(H),t=t.substring(0,H))}while(1);t=k.val;break}}k=oa[t];for(f=h;;){h=K.length;for(t=
K[h-1];void 0!==t&&t.is_prefix_operator;)t=K[--h-1];if(0===h||!(k.left_assoc&&k.precedence<=t.precedence||!k.left_assoc&&k.precedence<t.precedence))break;d.push(K.pop())}if(g){x(k);for(k=new ma(k);v.length;)k=m(k,v.pop());C(k)}else(h=K.length)&&K[h-1].is_prefix_operator&&k.left_assoc&&d.push(K.pop()),K.push(k),Ga()}else if(h in Z){var ea=Z[h];if(ea.open)c[ea.bracket_id]++,f!==u&&(h=new l(n.substring(f,u)),h.is_function=!0,K.push(h)),ea.fn&&K.push(ea.fn()),g=!0,K.push(ea);else{c[ea.bracket_id]--;for(e(u);h=
K.pop(),void 0===h&&G("Unmatched open bracket for bracket '"+ea+"'!"),h.bracket_id!==ea.bracket_id;)d.push(h);(h=K.length)&&K[h-1].is_function&&d.push(K.pop())}f=u+1}}for(e(a);K.length;)d.push(K.pop());for(u=0;u<c.length;u++)if(0<c[u]){var r;for(ea in Z)Z[ea].bracket_id!==u||Z[ea].open||(r=Z[ea]);G("Unmatched close bracket for bracket "+r+"!")}return b?d:this.parseTree(d)};this.toObject=function(a){var c=[[]];a=a.split(" ").join("");for(var b=[],k=0,e=c[0],n=function(a){""!==a&&e.push(new l(a))},
d=0,f=a.length;d<f;d++){var v=a.charAt(d);if(v in oa)k=a.substring(k,d),n(k),e.push(v),k=d+1;else if(v in Z){v=Z[v];if(v.open)b.push(a.substring(k,d)),e=[],c.push(e);else{k=a.substring(k,d);n(k);var k=c.pop(),g=b.pop();g in ka?k=q.symfunction(g,k):""===g?k.type=v.type:k=g;e=c[c.length-1];e.push(k)}k=d+1}}n(a.substring(k,d));return c[0]};var pa=function(a){var c=0,b=[[]];var k=0;for(var e=a.length;k<e;k++)","===a[k]?(c++,b[c]=[]):b[c].push(a[k]);return b},ta=function(a){return a.replace(/^\\left\((.+)\\right\)$/g,
function(a,c){return c?c:a})};this.toTeX=function(a){var c="string"===typeof a?this.toObject(a):a,b=[];if(H(c)){var k=[];for(a=0;a<c.length;a++){var e=c[a];if("^"===c[a+1]){var n=c[a+2];k.push(N.braces(this.toTeX([e]))+"^"+N.braces(this.toTeX([n])));a+=2}else k.push(e)}c=k}a=0;for(k=c.length;a<k;a++){var f=c[a];"*"===f&&(f="\\cdot");if(d(f))if(f.group===P){var v=f.fname;if(v===aa)e="\\sqrt"+N.braces(this.toTeX(f.args));else if(v===ra)e=N.brackets(this.toTeX(f.args),"abs");else if(v===la)e=N.brackets(this.toTeX(f.args),
"parens");else if("log10"===v)e="\\log_{10}\\left( "+this.toTeX(f.args)+"\\right)";else if("integrate"===v)f=pa(f.args),n=N.braces(this.toTeX(f[0])),e=this.toTeX(f[1]),e="\\int "+n+"\\, d"+e;else if("defint"===v)f=pa(f.args),n=N.braces(this.toTeX(f[0])),e=this.toTeX(f[1]),v=this.toTeX(f[2]),f=this.toTeX(f[3]),e="\\int\\limits_{"+v+"}^{"+f+"} "+n+"\\, d"+e;else if("diff"===v){f=pa(f.args);n=N.braces(this.toTeX(f[0]));if(1==f.length){v=[];for(e=0;e<f[0].length;e++)3===f[0][e].group&&v.push(f[0][e].value);
v=v.sort();e=0<v.length?"\\frac{d}{d "+v[0]+"}":"\\frac{d}{d x}"}else e=2==f.length?"\\frac{d}{d "+f[1]+"}":"\\frac{d^{"+f[2]+"}}{d "+this.toTeX(f[1])+"^{"+f[2]+"}}";e=e+"\\left("+n+"\\right)"}else if("sum"===v||"product"===v){n=[[],[],[],[]];for(a=e=0;a<f.args.length;a++)","===f.args[a]?e++:n[e].push(f.args[a]);e=("sum"===v?"\\sum_":"\\prod_")+N.braces(this.toTeX(n[1])+" = "+this.toTeX(n[2]));e+="^"+N.braces(this.toTeX(n[3]))+N.braces(this.toTeX(n[0]))}else e=v===na||v===sa?this.toTeX(f.args)+(v===
na?"!":"!!"):"\\mathrm"+N.braces(v)+N.brackets(this.toTeX(f.args),"parens");b.push(e)}else b.push(N.latex(f));else H(f)?b.push(N.brackets(this.toTeX(f))):"/"===f?b.push(N.frac(ta(b.pop()),ta(this.toTeX([c[++a]])))):b.push(f)}return b.join(" ")};this.expand=T;this.clean=A;this.ext={log:h,sqrt:e,abs:c,vector:S,matrix:U,parens:a,determinant:function(a){return C(a)?a.determinant():a},dot:Ca,invert:ya,transpose:Da};this.mapped_function=function(){for(var a={},c=this.params,b=0;b<c.length;b++)a[c[b]]=arguments[b];
return q.parse(this.body,a)};this.add=function(a,c){var b,k=d(a),f=d(c);if(k&&f){a.isComposite()&&a.isLinear()&&c.isComposite()&&c.isLinear()&&(a.distributeMultiplier(),c.distributeMultiplier());if(a.multiplier.equals(0))return c;if(c.multiplier.equals(0))return a;if(a.isConstant()&&c.isConstant()&&y.PARSE2NUMBER)return new l(a.multiplier.add(c.multiplier).valueOf());k=a.group;var n=c.group;var f=a.power.toString(),v=c.power.toString();if(k<n||k===n&&f>v&&0<v)return this.add(c,a);k===B&&n===z&&a.value===
c.value&&(n=a,a=c,c=n,k=a.group,n=c.group,f=a.power.toString(),v=c.power.toString());var v=f===v,f=a.value,K=c.value,m=a.isComposite(),u=c.isComposite(),h;m&&(b=g(a,"hash"));u&&(h=g(c,"hash"));if(k===J&&n===J&&c.isLinear()&&!a.isLinear()&&b!==h)return this.add(a,c);k===z&&n===z&&(f=b,K=h);var u=k===Q&&n===D,X=a.value===c.multiplier.toString();if((K=f===K||b===h&&!1||u&&X)&&v&&k===n)if(u&&(c=c.convert(Q)),k!==z||n!==R&&n!==Q)if(h=a,a.multiplier.isOne()&&c.multiplier.isOne()&&k===J)for(t in c.symbols)b=
c.symbols[t],h.attach(b);else h.multiplier=h.multiplier.add(c.multiplier);else a.distributeMultiplier(),h=a.attach(c);else if(K&&k!==z)h=l.shell(z).attach([a,c]),h.value=k===z?b:f;else if(m&&a.isLinear())if(b=k===n,(n=k===z&&n===z)&&(b=a.value===c.value),a.distributeMultiplier(),c.isComposite()&&c.isLinear()&&b){c.distributeMultiplier();for(t in c.symbols)b=c.symbols[t],a.attach(b);h=a}else n&&a.value!==h||k===z&&!K?(h=l.shell(J).attach([a,c]),h.updateHash()):h=a.attach(c);else{if(k===P&&a.fname===
aa&&n!==F&&c.power.equals(.5)){var t=c.multiplier.clone();c=e(c.toUnitMultiplier().toLinear());c.multiplier=t}h=l.shell(J).attach([a,c]);h.updateHash()}h.multiplier.equals(0)&&(h=new l(0));1===h.length&&(t=h.multiplier,h=za(h.symbols),h.multiplier=h.multiplier.multiply(t));return h}f&&!k&&(n=a,a=c,c=n,n=f,f=k,k=n);t=C(c);if(k&&t)c.eachElement(function(c){return q.add(a.clone(),c)});else if(C(a)&&t)c=a.add(c);else if(k&&x(c))c.each(function(b,k){k--;c.elements[k]=q.add(a.clone(),c.elements[k])});else if(x(a)&&
x(c))c.each(function(b,k){k--;c.elements[k]=q.add(a.elements[k],c.elements[k])});else{if(x(a)&&C(c))return q.add(c,a);if(C(a)&&x(c)){if(c.elements.length===a.rows()){var H=new O,p=a.cols();c.each(function(c,b){for(var k=[],e=0;e<p;e++)k.push(q.add(a.elements[b-1][e].clone(),c.clone()));H.elements.push(k)});return H}G("Dimensions must match!")}}return c};this.subtract=function(a,c){var b=b=d(a),k=d(c);if(b&&k)return this.add(a,c.negate());k&&(b=c,c=a,a=b,b=k);if(b&&x(c))c=c.map(function(c){return q.subtract(c,
a.clone())});else if(x(a)&&x(c))a.dimensions()===c.dimensions()?c=a.subtract(c):q.error("Unable to subtract vectors. Dimensions do not match.");else if(C(a)&&x(c)){if(c.elements.length===a.rows()){var e=new O;var f=a.cols();c.each(function(c,b){for(var k=[],d=0;d<f;d++)k.push(q.subtract(a.elements[b-1][d].clone(),c.clone()));e.elements.push(k)});return e}G("Dimensions must match!")}else{if(x(a)&&C(c))return e=c.clone().negate(),q.add(e,a);C(a)&&C(c)&&(c=a.subtract(c))}return c};this.multiply=function(a,
c){var b=d(a),k=d(c);if(b&&k){if(a.isConstant()&&c.isConstant()&&y.PARSE2NUMBER)return new l(a.multiplier.multiply(c.multiplier).valueOf());if(a.isOne())return c.clone();if(c.isOne())return a.clone();if(a.multiplier.equals(0)||c.multiplier.equals(0))return new l(0);if(c.group>a.group&&c.group!==J)return this.multiply(c,a);if(a.group===B&&c.group===z&&a.value===c.value){var e=a;a=c;c=e}var f=a.group,v=c.group;e=c.multiplier.num;k=c.multiplier.den;f!==P||a.fname!==aa||c.isConstant()||a.args[0].value!==
c.value||(b=a.power,a=a.args[0].clone(),a.setPower((new r(.5)).multiply(b)),f=a.group);var n=a.value,h=c.value,m=new r(a.multiplier.lessThan(0)?-1:1),u=f===Q&&v===D&&c.multiplier.equals(a.value),b=u?(new r(1)).multiply(a.multiplier).abs():a.multiplier.multiply(c.multiplier).abs(),t=a.clone().toUnitMultiplier();c=c.clone().toUnitMultiplier(!0);n===h&&f===z&&f===v&&(n=a.text("hash"),h=c.text("hash"));v===F&&c.previousGroup===z&&f===z&&(n=g(a,"hash",F));if(n!==h&&!u||f===z&&(v===R||v===Q||v===P)||f===
z&&v===B)if(f===B&&a.isLinear())if(v===B&&c.distributeExponent(),v===B&&c.isLinear()){for(var X in c.symbols)t=t.combine(c.symbols[X]);t.multiplier=t.multiplier.multiply(c.multiplier)}else t.combine(c);else f!==D?f===B?(t.distributeExponent(),t.combine(c)):c.isOne()||(v=c.multiplier.clone(),c.toUnitMultiplier(),t=l.shell(B).combine([t,c]),t.multiplier=t.multiplier.multiply(v)):t=c.clone().toUnitMultiplier();else X=a.power,n=c.power,h=d(X),u=d(n),h=h||u,f===z&&v!==z&&c.previousGroup!==z&&X.equals(1)?
(t=new l(0),a.each(function(a){t=q.add(t,q.multiply(a,c.clone()))},!0)):(t.power=h?q.add(d(X)?X:new l(X),d(n)?n:new l(n)):f===D?X:X.add(n),t.power.equals(0)&&(t=t.convert(D)),h&&t.convert(F),a.imaginary&&c.imaginary&&fa(t.power%2)&&(t=new l(1),b.negate()),t.group!==F&&t.previousGroup&&(t.previousGroup=void 0),t.multiplier=t.multiplier.multiply(c.multiplier));t.group===Q&&(f=Math.log(t.value),v=Math.log(e)/f,f=Math.log(k)/f,X=b.num/e,n=b.den/k,0!==v&&E(v)&&E(X)&&(t.power=t.power.add(new r(v)),b.num/=
e),0!==f&&E(f)&&E(n)&&(t.power=t.power.subtract(new r(f)),b.den/=k));1===t.length&&(e=t.multiplier,t=za(t.symbols),t.multiplier=t.multiplier.multiply(e));fa(t.power.toString())&&t.fname===aa?(e=t.power,t=t.args[0],t=q.multiply(new l(b),q.pow(t,new l(e.divide(new r(2)))))):t.multiplier=t.multiplier.multiply(b).multiply(m);t.group===Q&&E(t.power.toDecimal())&&(t=t.convert(D));return t}k&&!b&&(e=a,a=c,c=e,e=k,k=b,b=e);e=C(c);k=C(a);if(b&&e)c.eachElement(function(c){return q.multiply(a.clone(),c)});else if(k&&
e)c=a.multiply(c);else if(b&&x(c))c.each(function(b,k){k--;c.elements[k]=q.multiply(a.clone(),c.elements[k])});else if(x(a)&&x(c))c.each(function(b,k){k--;c.elements[k]=q.multiply(a.elements[k],c.elements[k])});else{if(x(a)&&C(c))return this.multiply(c,a);if(C(a)&&x(c)){if(c.elements.length===a.rows()){var K=new O,H=a.cols();c.each(function(c,b){for(var k=[],e=0;e<H;e++)k.push(q.multiply(a.elements[b-1][e].clone(),c.clone()));K.elements.push(k)});return K}G("Dimensions must match!")}}return c};this.divide=
function(a,c){var b=d(a),k=d(c);if(b&&k){if(c.equals(0))throw new ua("Division by zero not allowed!");a.isConstant()&&c.isConstant()?(k=a.clone(),k.multiplier=k.multiplier.divide(c.multiplier)):(c.invert(),k=q.multiply(a,c));return k}var e=x(a),f=x(c);b&&f?c=c.map(function(c){return q.divide(a.clone(),c)}):e&&k?c=a.map(function(a){return q.divide(a,c.clone())}):e&&f?a.dimensions()===c.dimensions()?c=c.map(function(c,b){return q.divide(a.elements[--b],c)}):q.error("Cannot divide vectors. Dimensions do not match!"):
(b=C(a),e=C(c),b&&k?(a.eachElement(function(a){return q.divide(a,c.clone())}),c=a):b&&e?a.rows()===c.rows()&&a.cols()===c.cols()?a.eachElement(function(a,b,k){return q.divide(a,c.elements[b][k])}):q.error("Dimensions do not match!"):b&&f&&(a.cols()===c.dimensions()?(a.eachElement(function(a,b,k){return q.divide(a,c.elements[b].clone())}),c=a):q.error("Unable to divide matrix by vector.")));return c};this.pow=function(a,c){var b=d(a);var k=d(c);if(b&&k){(b=a.equals(0))&&c.equals(0)&&G("0^0 is undefined!");
if(b&&c.isConstant()&&c.multiplier.greaterThan(0))return new l(0);var e=c.isConstant(),f=a.isConstant(),v=c.isInteger();k=a.multiplier;b=a.clone();b.toUnitMultiplier();if(b.group!==P||b.fname!==aa||e){var g=k.sign();Ia(c)&&0>g&&(b.negate(),b=q.symfunction(la,[b]),b.negate());b.multiplyPower(c)}else{var n=b.args[0];n.multiplyPower(new l(.5));n.multiplier.multiply(b.multiplier);n.multiplyPower(c);b=n}if(f&&e&&y.PARSE2NUMBER){if(0>g)if(a.negate(),c.multiplier.den.equals(2))var t=new l(y.IMAGINARY);else E(c.multiplier)?
t=fa(c.multiplier)?new l(1):new l(-1):fa(c.multiplier.den)?t=q.pow(q.symfunction(la,[new l(g)]),c.clone()):(g=Math.pow(g,c.multiplier.num),t=new l(Math.pow(a,c)*g));b=new l(Math.pow(a.multiplier.toDecimal(),c.multiplier.toDecimal()));t&&(b=q.multiply(b,t))}else if(v&&!k.equals(1))a=c.multiplier.toDecimal(),a=new r(Math.pow(k.num,a)/Math.pow(k.den,a)),b.multiplier=b.multiplier.multiply(a);else if(g=a.sign(),c.isConstant()&&a.isConstant()&&!c.multiplier.den.equals(1)&&0>g)c.multiplier.den.equals(2)?
(b=new l(y.IMAGINARY),a.negate(),c.lessThan(0)&&(b.negate(),c.negate()),b=q.multiply(q.pow(a,c),b)):(g=a.clone(),g.multiplier.negate(),b=q.pow(q.symfunction(la,[new l(-1)]),c.clone()),a=q.pow(new l(g.multiplier.num),c.clone()),g=q.pow(new l(g.multiplier.den),c.clone()),a=q.divide(a,g),b=q.multiply(b,a));else{t=a.group===D&&0>g;var h=ca((new l(t?k.num:Math.abs(k.num))).setPower(c.clone()));var m=ca((new l(k.den)).setPower(c.clone()).invert());a.imaginary&&(b=c.multiplier.multiply(r.quick(1,2)),k=Math.pow(-1,
b.num),b=fa(b.den)?(new l(-1)).setPower(b,!0):new l(k));0>g&&!t&&b.negate();e&&a.group!==F&&(g=fa(c.multiplier.den),a=fa(a.power),k=b.power.toDecimal(),e=fa(k),g&&a&&!e&&(1===k?b=q.symfunction(ra,[b]):E(k)?b=q.multiply(q.symfunction(ra,[b.clone().toLinear()]),b.clone().setPower(new r(k-1))):(a=b.power,b=q.symfunction(ra,[b.toLinear()]).setPower(a))))}b=ca(b);h&&m&&(b=q.multiply(b,ga(q.multiply(h,m))));b.fname===aa?(m=b.group===F,fa(m?b.power.multiplier.toString():b.power.toString())&&(m=m?q.divide(b.power,
new l(2)):new l(b.power.divide(new r(2))),k=b.multiplier,b=q.pow(b.args[0],m),b.multiplier=b.multiplier.multiply(k))):b.isE()&&b.group===F&&b.power.contains("pi")&&b.power.contains(y.IMAGINARY)&&(m=b.multiplier,b=new l(fa(b.power.multiplier)?m:m.negate()));return b}x(a)&&k?a=a.map(function(a){return q.pow(a,c.clone())}):C(a)&&k&&a.eachElement(function(a){return q.pow(a,c.clone())});return a};this.comma=function(a,c){var b=a instanceof Array,k=c instanceof Array,e=b&&a[0]instanceof Array;b&&e||b&&
!k?a.push(c):a=[a,c];return a};this.equals=function(a,c){a.group===R||a.isLinear()||G("Cannot set equality for "+a.toString());da[a.value]=c.clone();return c};this.eq=function(a,c){return a.equals(c)};this.gt=function(a,c){return a.gt(c)};this.gte=function(a,c){return a.gte(c)};this.lt=function(a,c){return a.lt(c)};this.lte=function(a,c){return a.lte(c)};this.factorial=function(a){return this.symfunction(na,[a])};this.dfactorial=function(a){return this.symfunction(sa,[a])};this.factadd=function(a,
c){return q.add(this.symfunction(na,[a]),c)};this.dfactadd=function(a,c){return q.add(this.symfunction(sa,[a]),c)};this.factsub=function(a,c){return q.subtract(this.symfunction(na,[a]),c)};this.dfactsub=function(a,c){return q.subtract(this.symfunction(sa,[a]),c)}}function W(a){x(a)?this.elements=a.items.slice(0):H(a)?this.elements=a.slice(0):this.elements=[].slice.call(arguments)}function O(){var a=arguments,c=a.length,b,e=[];if(C(a))for(b=0;b<c;b++)e.push(a[b].slice(0));else for(b=0;b<c;b++){var d=
a[b];x(d)&&(d=d.elements);H(d)||(d=[d]);var f=d.length;g&&g!==f&&G("Unable to create Matrix. Row dimensions do not match!");e.push(d);var g=f}this.elements=e}var h=new pa,U=p.bigInt;p={};var ca=[],w={},y={init_primes:1E3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03c0"],POWER_OPERATOR:"^"},D=p.N=1,Q=p.P=2,R=p.S=3,F=p.EX=4,P=p.FN=5,z=p.PL=6,B=p.CB=7,J=p.CP=8,ta=y.CONST_HASH="#",la=y.PARENTHESIS="parens";y.VECTOR="vector";var aa=y.SQRT=
"sqrt",ra=y.ABS="abs",na=y.FACTORIAL="factorial",sa=y.DOUBLEFACTORIAL="dfactorial",A=[],da={},ka=["__u__"],ga=w.isReserved=function(a){return-1!==ka.indexOf(a)},G=function(a){if(!y.suppress_errors)throw Error(a);},ba=w.validateName=function(a,c){c=c||"variable";if(-1===y.ALLOW_CHARS.indexOf(a)&&!/^[a-z_][a-z\d\_]*$/gi.test(a))throw Error(a+" is not a valid "+c+" name");};w.intersection=function(a,c,b){var k=[];if(a.length>c.length){var d=a;a=c;c=d}c=c.slice();for(var d=a.length,f=c.length,g=0;g<d;g++)for(var l=
a[g],x=0;x<f;x++){var h=c[x];void 0!==h&&(b?b(l,h):l===h)&&(c[x]=void 0,k.push(l))}return k};var I=w.scientificToDecimal=function(a){if(/\d+\.?\d*e[\+\-]*\d+/i.test(a)){var c=String(a).toLowerCase().split("e"),b=c.pop();a=Math.abs(b);b/=a;c=c[0].split(".");-1===b?a="0."+Array(a).join("0")+c.join(""):((b=c[1])&&(a-=b.length),a=c.join("")+Array(a+1).join("0"))}return a},ja=w.isPrime=function(a){for(var c=Math.floor(Math.sqrt(a)),b=2;b<=c;b++)if(0===a%b)return!1;return!0},b=w.isFraction=function(a){return d(a)?
b(a.multiplier.toDecimal()):0!==a%1},d=w.isSymbol=function(a){return a instanceof l},f=w.isExpression=function(a){return a instanceof m},x=w.isVector=function(a){return a instanceof W},C=w.isMatrix=function(a){return a instanceof O},u=w.isNumericSymbol=function(a){return a.group===D},H=w.isArray=function(a){return a instanceof Array},E=w.isInt=function(a){return 0===a%1},wa=w.isNegative=function(a){d(a)&&(a=a.multiplier);return a.lessThan(0)},T=w.inBrackets=function(a){return"("+a+")"};w.stringReplace=
function(a,c,b,e){return a.substr(0,c)+e+a.substr(b,a.length)};w.customType=function(a){return void 0!==a&&a.custom};w.sameSign=function(a,c){return 0>a===0>c};var va=w.format=function(){var a=[].slice.call(arguments);return a.shift().replace(/{(\d+)}/g,function(c,b){c=a[b];return"function"===typeof c?c():c})},ya=w.keys=Object.keys,za=w.firstObject=function(a){for(var c in a)break;return a[c]};w.compare=function(a,c,b){for(var k={},d,f=0;f<b.length;f++)k[b[f]]=new l(Math.floor(5*Math.random())+1);
Y("PARSE2NUMBER",function(){d=h.parse(a,k).equals(h.parse(c,k))});return d};w.arrayMax=function(a){return Math.max.apply(void 0,a)};w.arrayMin=function(a){return Math.min.apply(void 0,a)};w.arrayClone=function(a){for(var c=[],b=a.length,e=0;e<b;e++)c[e]=a[e].clone();return c};w.comboSort=function(a,c){for(var b=a.length,e=[],d=0;d<a.length;d++)e.push([a[d],c[d]]);e.sort(function(a,c){return a[0]-c[0]});a=[];c=[];for(d=0;d<b;d++)a.push(e[d][0]),c.push(e[d][1]);return[a,c]};var Ja=w.round=function(a,
c){c=c||14;return Math.round(a*Math.pow(10,c))/Math.pow(10,c)},ha=w.variables=function(a,c,b){b=b||{c:[],add:function(a){-1===this.c.indexOf(a)&&isNaN(a)&&this.c.push(a)}};if(d(a)){var k=a.group,f=a.previousGroup;k===F&&ha(a.power,c,b);if(k===J||k===B||f===J||f===B)for(var g in a.symbols)ha(a.symbols[g],c,b);else if(k===R||f===R)"e"!==a.value&&"pi"!==a.value&&b.add(a.value);else if(k===z||f===z)ha(za(a.symbols),c,b);else if(k===F)isNaN(a.value)||b.add(a.value),ha(a.power,c,b);else if(k===P&&!c)for(k=
0;k<a.args.length;k++)ha(a.args[k],c,b)}return b.c.sort()},Ka=w.each=function(a,c){if(H(a))for(var b=a.length,e=0;e<b;e++)c.call(a,e);else for(b in a)a.hasOwnProperty(b)&&c.call(a,b)},fa=w.even=function(a){return 0===a%2},Ia=w.evenFraction=function(a){return 0===1/(a%1)%2},La=w.arrayUnique=function(a){for(var c=a.length,b=[],e=0;e<c;e++){var d=a[e];-1===b.indexOf(d)&&b.push(d)}return b},Aa=w.reserveNames=function(a){var c=function(a){-1===ka.indexOf(a)&&ka.push(a)};"string"===typeof a?c(a):Ka(a,function(a){c(a)})},
Ea=w.remove=function(a,c){if(H(a))var b=a.splice(c,1)[0];else b=a[c],delete a[c];return b},Y=w.block=function(a,c,b,e){var k=y[a];y[a]=void 0===b?!0:!!b;c=c.call(e);y[a]=k;return c};w.arguments2Array=function(a){return[].slice.call(a)};w.getCoeffs=function(a,c){var b=[];a.each(function(a){if(a.contains(c)){var k=a.stripVar(c);a=h.divide(a.clone(),k.clone()).power.toDecimal()}else k=a,a=0;var e=b[a];b[a]=e?h.add(e,k):k},!0);for(a=0;a<b.length;a++)b[a]||(b[a]=new l(0));return b};var Fa=w.generatePrimes=
function(a){for(var c=ca[ca.length-1]||2;c<a;c++)ja(c)&&ca.push(c)},xa=w.evaluate=function(a){return Y("PARSE2NUMBER",function(){return h.parse(a)},!0)},V={csc:function(a){return 1/Math.sin(a)},sec:function(a){return 1/Math.cos(a)},cot:function(a){return 1/Math.tan(a)},erf:function(a){var c=1/(1+.5*Math.abs(a)),c=1-c*Math.exp(-a*a-1.26551223+c*(1.00002368+c*(.37409196+c*(.09678418+c*(-.18628806+c*(.27886807+c*(-1.13520398+c*(1.48851587+c*(-.82215223+.17087277*c)))))))));return 0<=a?c:-c},bigpow:function(a,
c){a=r.simple(a);for(var b=a.clone(),e=0;e<c-1;e++)b=b.multiply(a);return b},gamma:function(a){var c=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9.984369578019572E-6,1.5056327351493116E-7];if(.5>a)return Math.PI/(Math.sin(Math.PI*a)*gamma(1-a));--a;for(var b=c[0],e=1;9>e;e++)b+=c[e]/(a+e);c=a+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(c,a+.5)*Math.exp(-c)*b},bigfactorial:function(a){for(var c=new r(1),b=2;b<=a;b++)c=
c.multiply(new r(b));return c},factorial:function(a){if(0>a)throw Error("factorial not defined for negative numbers");for(var c=1,b=2;b<=a;b++)c*=b;return c},dfactorial:function(a){var c=0===a%2;a=c?a/2:(a+1)/2;var b=new r(1);if(c)for(c=1;c<=a;c++)b=b.multiply((new r(2)).multiply(new r(c)));else for(c=1;c<=a;c++)b=b.multiply((new r(2)).multiply(new r(c)).subtract(new r(1)));return b},GCD:function(){for(var a=La([].slice.call(arguments).map(function(a){return Math.abs(a)})).sort(),c=Math.abs(a.shift()),
b=a.length;0<b--;)for(var e=Math.abs(a.shift());;){c%=e;if(0===c){c=e;break}e%=c;if(0===e)break}return c},QGCD:function(){for(var a=[].slice.call(arguments),c=a[0],b=1;b<a.length;b++){var e=a[b],d=c.isNegative()&&e.isNegative()?-1:1,c=e.gcd(c);0>d&&c.negate()}return c},LCM:function(a,c){return a*c/V.GCD(a,c)},pow:function(a,c){return 0>a&&1>Math.abs(c)?0===1/c%2?NaN:-Math.pow(Math.abs(a),c):Math.pow(a,c)},factor:function(a){a=V.ifactor(a);var c=new l;c.symbols={};c.group=B;for(var b in a){var e=new l(1);
e.group=Q;e.value=b;e.power=new l(a[b]);c.symbols[b]=e}c.updateHash();return c},ifactor:function(a,c){c=c||{};var b=Math.floor(Math.sqrt(a));b>ca[ca.length-1]&&1E6>a&&Fa(b);for(var b=ca.length,e=0;e<b;e++)for(var d=ca[e];0===a%d;)a/=d,c[d]=(c[d]||0)+1;1<a&&(c[a]=1);return c},boxfactor:function(a,c){c=c||200;for(var b,e,d=Math.floor(5/12*a),f=0,g=!1;;){b=Math.floor(a/d);e=a%d;if(0===e)break;if(g)return[a,1];d=Math.max(e,d-e);f++;g=f>c}return[b,d,f]},fib:function(a){for(var c=0,b=1,e=1,d=2;d<=a;d++)e=
c+b,c=b,b=e;return e},mod:function(a,c){return a%c},num_integrate:function(a,c,b,e){e=e||.001;b=(b-c)/e;var k=0;for(var d=1;d<=b;d++){var f=c+(d-1)*e;var g=c+d*e;f=e*(a(f)+a(g))/2;k+=f}return k=Ja(k,13)},Ci:function(a){for(var c=0,b=1;20>b;b++)var e=2*b,c=c+Math.pow(-1,b)*Math.pow(a,e)/(e*V.factorial(e));return Math.log(a)+.5772156649015329+c},Si:function(a){for(var c=0,b=0;20>b;b++)var e=2*b,c=c+Math.pow(-1,b)*Math.pow(a,e+1)/((e+1)*V.factorial(e+1));return c},Ei:function(a){if(a.equals(0))return-Infinity;
for(var c=0,b=1;30>b;b++)c+=Math.pow(a,b)/(b*V.factorial(b));return.5772156649015329+Math.abs(Math.log(a))+c},Shi:function(a){for(var c=0,b,e,d=0;30>d;d++)b=2*d,e=b+1,c+=Math.pow(a,e)/(e*e*V.factorial(b));return c},Chi:function(a){return Math.log(a)+.5772156649015329+V.num_integrate(function(a){return(Math.cosh(a)-1)/a},.002,a,.001)},gamma_incomplete:function(a,c){--a;var b=0;c=c||0;for(var e=0;e<a;e++)b+=Math.pow(c,e)/V.factorial(e);return V.factorial(a)*Math.exp(-c)*b},step:function(a){return 0<
a?1:0>a?0:.5},rect:function(a){a=Math.abs(a);return.5===a?a:.5<a?0:1},sinc:function(a){return a.equals(0)?1:Math.sin(a)/a},tri:function(a){a=Math.abs(a);return 1<=a?0:1-a}};y.FUNCTION_MODULES.push(V);y.FUNCTION_MODULES.push(V);Math.sign=Math.sign||function(a){a=+a;return 0===a||isNaN(a)?a:0<a?1:-1};Math.cosh=Math.cosh||function(a){a=Math.exp(a);return(a+1/a)/2};Math.sinh=Math.sinh||function(a){a=Math.exp(a);return(a-1/a)/2};Math.tanh=Math.tanh||function(a){if(Infinity===a)return 1;if(-Infinity===
a)return-1;a=Math.exp(2*a);return(a-1)/(a+1)};Math.asinh=Math.asinh||function(a){return-Infinity===a?a:Math.log(a+Math.sqrt(a*a+1))};Math.acosh=Math.acosh||function(a){return Math.log(a+Math.sqrt(a*a-1))};Math.atanh=Math.atanh||function(a){return Math.log((1+a)/(1-a))/2};Math.log10=Math.log10||function(a){return Math.log(a)*Math.LOG10E};Aa(V);w.text=g;m.getExpression=function(a,c){"last"!==a&&a||(a=A.length);"first"===a&&(a=1);return(a=A[a-1])?new m(a):a};m.prototype={text:function(a){a=a||"decimals";
return this.symbol.text_?this.symbol.text_(a):g(this.symbol,a)},latex:function(a){return this.symbol.latex_?this.symbol.latex_(a):N.latex(this.symbol,a)},valueOf:function(){return this.symbol.valueOf()},evaluate:function(){var a=arguments[0],c=1;if("string"===typeof a)var b="%"===a.charAt(0)?m.getExpression(a.substr(1)).text():a;else a instanceof m||d(a)?b=a.text():(b=this.symbol.text(),c--);var e=arguments[c]||{};return new m(Y("PARSE2NUMBER",function(){return h.parse(b,e)},!0))},buildFunction:function(a){return Ma(this.symbol,
a)},isNumber:function(){return u(this.symbol)},isInfinity:function(){return Infinity===Math.abs(this.symbol.multiplier)},variables:function(){return ha(this.symbol)},toString:function(){try{return H(this.symbol)?"["+this.symbol.toString()+"]":this.symbol.toString()}catch(a){return""}},toDecimal:function(){return this.symbol.toDecimal()},isFraction:function(){return b(this.symbol)},isPolynomial:function(){return this.symbol.isPoly()},sub:function(a,c){return new m(this.symbol.sub(h.parse(a),h.parse(c)))},
operation:function(a,c){f(c)?c=c.symbol:d(c)||(c=h.parse(c));return new m(h[a](this.symbol.clone(),c.clone()))},add:function(a){return this.operation("add",a)},subtract:function(a){return this.operation("subtract",a)},multiply:function(a){return this.operation("multiply",a)},divide:function(a){return this.operation("divide",a)},pow:function(a){return this.operation("pow",a)},expand:function(){return new m(h.expand(this.symbol))},each:function(a,c){if(this.symbol.each)this.symbol.each(a,c);else if(H(this.symbol))for(c=
0;c<this.symbol.length;c++)a.call(this.symbol,this.symbol[c],c);else a.call(this.symbol)},eq:function(a){a=h.parse(a);return this.symbol.isConstant()&&a.isConstant()?this.symbol.equals(h.parse(a)):!1},lt:function(a){a=h.parse(a);return this.symbol.isConstant()&&a.isConstant()?this.symbol.lessThan(h.parse(a)):!1},gt:function(a){a=h.parse(a);return this.symbol.isConstant()&&a.isConstant()?this.symbol.greaterThan(h.parse(a)):!1},gte:function(a){return this.greaterThan(a)||this.equals(a)},lte:function(a){return this.lessThan(a)||
this.equals(a)}};m.prototype.toTeX=m.prototype.latex;r.isFrac=function(a){return a instanceof r};r.quick=function(a,c){var b=new r;b.num=new U(a);b.den=new U(c);return b};r.simple=function(a){var c=String(a).split(".");a=c.join("");for(var b=1,c=(c[1]||"").length,e=0;e<c;e++)b+="0";return r.quick(a,b).simplify()};r.prototype={multiply:function(a){if(this.isOne())return a.clone();if(a.isOne())return this.clone();var c=this.clone();c.num=c.num.multiply(a.num);c.den=c.den.multiply(a.den);return c.simplify()},
divide:function(a){if(a.equals(0))throw Error("Division by zero not allowed!");return this.clone().multiply(a.clone().invert()).simplify()},subtract:function(a){return this.clone().add(a.clone().neg())},neg:function(){this.num=this.num.multiply(-1);return this},add:function(a){var c=this.den,b=a.den,e=this.clone(),d=e.num;a=a.num;c.equals(b)?e.num=d.add(a):(e.num=d.multiply(b).add(a.multiply(c)),e.den=c.multiply(b));return e.simplify()},mod:function(a){var c=this.clone();a=a.clone();c.num=c.num.multiply(a.den);
c.den=c.den.multiply(a.den);a.num=a.num.multiply(this.den);a.den=a.den.multiply(this.den);c.num=c.num.mod(a.num);return c.simplify()},simplify:function(){var a=U.gcd(this.num,this.den);this.num=this.num.divide(a);this.den=this.den.divide(a);return this},clone:function(){var a=new r;a.num=new U(this.num);a.den=new U(this.den);return a},toDecimal:function(){return this.num/this.den},qcompare:function(a){return[this.num.multiply(a.den),a.num.multiply(this.den)]},equals:function(a){isNaN(a)||(a=new r(a));
a=this.qcompare(a);return a[0].equals(a[1])},absEquals:function(a){isNaN(a)||(a=new r(a));a=this.qcompare(a);return a[0].abs().equals(a[1])},greaterThan:function(a){isNaN(a)||(a=new r(a));a=this.qcompare(a);return a[0].gt(a[1])},lessThan:function(a){isNaN(a)||(a=new r(a));a=this.qcompare(a);return a[0].lt(a[1])},isInteger:function(){return this.den.equals(1)},negate:function(){this.num=this.num.multiply(-1);return this},invert:function(){var a=this.den,c=this.num.isNegative();this.den=this.num.abs();
this.num=a;c&&(this.num=this.num.multiply(-1));return this},isOne:function(){return this.num.equals(1)&&this.den.equals(1)},sign:function(){return this.num.isNegative()?-1:1},abs:function(){this.num=this.num.abs();return this},gcd:function(a){return r.quick(U.gcd(a.num,this.num),U.lcm(a.den,this.den))},toString:function(){return this.den.equals(1)?this.num.toString():this.num.toString()+"/"+this.den.toString()},valueOf:function(){return this.num/this.den},isNegative:function(){return 0>this.toDecimal()}};
l.imaginary=function(){var a=new l(y.IMAGINARY);a.isImaginary=!0;return a};l.shell=function(a,c){c=new l(c);c.group=a;c.symbols={};c.length=0;return c};l.unwrapSQRT=function(a,c){var b=a.power;if(a.fname===aa&&(a.isLinear()||c)){var e=a.args[0].clone();e.power=e.power.multiply(new r(.5));e.multiplier=e.multiplier.multiply(a.multiplier);a=e;c&&(a.power=b.multiply(new r(.5)))}return a};l.prototype={equals:function(a){d(a)||(a=new l(a));return this.value===a.value&&this.power.equals(a.power)&&this.multiplier.equals(a.multiplier)},
gt:function(a){d(a)||(a=new l(a));return this.isConstant()&&a.isConstant()&&this.multiplier.greaterThan(a.multiplier)},gte:function(a){d(a)||(a=new l(a));return this.equals(a)||this.isConstant()&&a.isConstant()&&this.multiplier.greaterThan(a.multiplier)},lt:function(a){d(a)||(a=new l(a));return this.isConstant()&&a.isConstant()&&this.multiplier.lessThan(a.multiplier)},lte:function(a){d(a)||(a=new l(a));return this.equals(a)||this.isConstant()&&a.isConstant()&&this.multiplier.lessThan(a.multiplier)},
isPoly:function(a){var c=this.group,b=this.power;if(!E(b)||0>b)return!1;if(c===D||c===R)return!0;if(this.isComposite()||c===B&&a){if(!a&&1<ha(this))return!1;for(var e in this.symbols)if(!this.symbols[e].isPoly(a))return!1}else return!1;return!0},stripVar:function(a){if(this.group!==z&&this.group!==R||this.value!==a)if(this.group===B&&this.isLinear()){var c=new l(1);this.each(function(b){b.contains(a,!0)||(c=h.multiply(c,b.clone()))});c.multiplier=c.multiplier.multiply(this.multiplier)}else this.group!==
J||this.isLinear()?this.group===J&&this.isLinear()?(c=new l(0),this.each(function(b){b.contains(a)||(b=b.clone(),b.multiplier=b.multiplier.multiply(this.multiplier),c=h.add(c,b))}),c.equals(0)&&(c=new l(this.multiplier))):c=this.group===F&&this.power.contains(a,!0)?new l(this.multiplier):this.group===P&&this.contains(a)?new l(this.multiplier):this.clone():c=new l(this.multiplier);else c=new l(this.multiplier);return c},toArray:function(a,c){c=c||{arr:[],add:function(a,c){var b=this.arr[c];this.arr[c]=
b?h.add(b,a):a}};var b=this.group;if(b===R&&this.contains(a))c.add(new l(this.multiplier),this.power);else if(b===B){var b=this.stripVar(a),e=h.divide(this.clone(),b.clone()),e=e.isConstant()?0:e.power;c.add(b,e)}else if(b===z&&this.value===a)this.each(function(b,k){c.add(b.stripVar(a),k)});else if(b===J)this.each(function(b){b.toArray(a,c)});else{if(this.contains(a))throw Error("Cannot convert to array! Exiting");c.add(this.clone(),0)}c=c.arr;for(b=0;b<c.length;b++)c[b]||(c[b]=new l(0));return c},
hasFunc:function(a){var c=this.group===P||this.group===F;if(c&&!a||c&&this.contains(a))return!0;if(this.symbols)for(var b in this.symbols)if(this.symbols[b].hasFunc(a))return!0;return!1},sub:function(a,c){a=d(a)?a.clone():h.parse(a);c=d(c)?c.clone():h.parse(c);a.group!==D&&a.group!==Q||G("Cannot substitute a number. Must be a variable");var b=!1,e=a.multiplier.equals(1),f=this.multiplier.clone();if(this.value===a.value&&(this.group!==z&&a.group!==z||this.group===z&&a.group===z)){if(e||a.multiplier.equals(this.multiplier)){if(a.isLinear())var g=
c;else a.power.equals(this.power)&&(g=c,b=!0);a.multiplier.equals(this.multiplier)&&(f=new r(1))}}else if(this.group===B||this.previousGroup===B)g=new l(1),this.each(function(b){g=h.multiply(g,b.sub(a,c))});else if(this.isComposite())g=new l(0),this.each(function(b){g=h.add(g,b.sub(a,c))});else if(this.group===F)g=h.parse(this.value).sub(a,c);else if(this.group===P){for(var e=[],x=0;x<this.args.length;x++){var m=this.args[x];d(m)||(m=h.parse(m));e.push(m.sub(a,c))}g=h.symfunction(this.fname,e)}return g?
(b||(b=this.group===F?this.power.sub(a,c):h.parse(this.power),g=h.pow(g,b)),g.multiplier=g.multiplier.multiply(f),g):this.clone()},isMonomial:function(){if(this.group===R)return!0;if(this.group===B)for(var a in this.symbols){if(this.symbols[a].group!==R)return!1}else return!1;return!0},isPi:function(){return this.group===R&&"pi"===this.value},sign:function(){return this.multiplier.sign()},isE:function(){return"e"===this.value},isSQRT:function(){return this.fname===aa},isConstant:function(){return this.value===
ta},isInteger:function(){return this.isConstant()&&this.multiplier.isInteger()},isLinear:function(a){if(a){if(this.isConstant())return!0;if(this.group===R)return this.value===a?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(var c in this.symbols)if(!this.symbols[c].isLinear(a))return!1;return!0}return this.group===B&&this.symbols[a]?this.symbols[a].isLinear(a):!1}return this.power.equals(1)},containsFunction:function(a){"string"===typeof a&&(a=[a]);if(this.group===P&&-1!==
a.indexOf(this.fname))return!0;if(this.symbols)for(var c in this.symbols)if(this.symbols[c].hasIntegral(a))return!0;return!1},multiplyPower:function(a){if(this.group===D&&this.multiplier.equals(1))return this;var c=this.power;this.group!==F&&a.group===D?(a=a.multiplier,this.group!==D||a.isInteger()||this.convert(Q),this.power=c.equals(1)?a.clone():c.multiply(a),this.group===Q&&E(this.power)&&(this.value=Math.pow(this.value,this.power),this.toLinear(),this.convert(D))):(this.group!==F&&(c=new l(c),
this.convert(F)),this.power=h.multiply(c,a));return this},setPower:function(a,c){if(this.group===D&&this.multiplier.equals(1))return this;if(this.group!==F||d(a)){var b=!1;d(a)&&(a.group===D?a=a.multiplier:b=!0);b=b?F:Q;this.power=a;this.group===D&&b&&this.convert(b,c)}else this.group=this.previousGroup,delete this.previousGroup,this.power=a;return this},isInverse:function(){return this.group===F?this.power.multiplier.lessThan(0):0>this.power},clone:function(a){a=a||new l(0);var c="value group length previousGroup imaginary fname args".split(" "),
b=c.length,e;if(this.symbols)for(e in a.symbols={},this.symbols)a.symbols[e]=this.symbols[e].clone();for(e=0;e<b;e++)void 0!==this[c[e]]&&(a[c[e]]=this[c[e]]);a.power=this.power.clone();a.multiplier=this.multiplier.clone();return a},toUnitMultiplier:function(a){this.multiplier.num=new U(this.multiplier.num.isNegative()&&a?-1:1);this.multiplier.den=new U(1);return this},toLinear:function(){this.setPower(new r(1));return this},each:function(a,c){if(this.symbols)for(var b in this.symbols){var e=this.symbols[b];
if(e.group===z&&c)for(var d in e.symbols)a.call(b,e.symbols[d],d);else a.call(this,e,b)}else a.call(this,this,this.value)},valueOf:function(){return this.group===D?this.multiplier.valueOf():0===this.power?1:0===this.multiplier?0:g(this,"decimals")},contains:function(a,c){var b=this.group;if(this.value===a)return!0;if(this.symbols)for(var e in this.symbols)if(this.symbols[e].contains(a,c))return!0;if(b===P||this.previousGroup===P)for(e=0;e<this.args.length;e++)if(this.args[e].contains(a,c))return!0;
return b===F&&(c&&this.power.contains(a,c)||this.value===a)?!0:this.value===a},negate:function(){this.multiplier.negate();this.group!==J&&this.group!==z||this.distributeMultiplier();return this},invert:function(a){a||(this.multiplier=this.multiplier.invert());d(this.power)?this.power.negate():this.power&&this.group!==D&&this.power.negate();return this},distributeMultiplier:function(a){a=a?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&a&&this.group!==B&&!this.multiplier.equals(1)){for(var c in this.symbols)a=
this.symbols[c],a.multiplier=a.multiplier.multiply(this.multiplier),a.distributeMultiplier();this.toUnitMultiplier()}return this},distributeExponent:function(){if(1!==this.power){var a=this.power,c;for(c in this.symbols){var b=this.symbols[c];b.group===F?b.power=h.multiply(b.power,new l(a)):this.symbols[c].power=this.symbols[c].power.multiply(a)}this.toLinear()}return this},convert:function(a,c){a>P?(c=this.clone(),this.symbols={},a===B?c.toUnitMultiplier():this.toUnitMultiplier(),this.group===P&&
(c.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[c.keyForGroup(a)]=c,this.group=a,this.length=1):a===F?this.group===D&&this.multiplier.equals(1)||(this.group!==F&&(this.previousGroup=this.group),this.group===D?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=g(this,"hash"),this.group=F):a===D?(a=this.multiplier.toDecimal(),this.symbols&&(this.symbols=void 0),(new l(this.group===Q?a*Math.pow(this.value,
this.power):a)).clone(this)):a===Q&&this.group===D&&(this.value=c?this.multiplier.num.toString():Math.abs(this.multiplier.num.toString()),this.toUnitMultiplier(!c),this.group=Q);return this},insert:function(a,c){d(a)||G("Object "+a+" is not of type Symbol!");if(this.symbols){var b=this.group;if(b>P){var b=a.keyForGroup(b),e=b in this.symbols?this.symbols[b]:!1;"add"===c?e?(this.symbols[b]=h.add(e,a),this.symbols[b].multiplier.equals(0)&&(delete this.symbols[b],this.length--,0===this.length&&(this.convert(D),
this.multiplier=new r(0)))):(this.symbols[b]=a,this.length++):(a.group===Q&&E(a.power)&&a.convert(D),a.group!==F?(this.multiplier=this.multiplier.multiply(a.multiplier),a.toUnitMultiplier()):(a.parens=a.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(a.multiplier.clone().abs()),a.toUnitMultiplier(!0)),e&&(a=h.multiply(Ea(this.symbols,b),a),a.isConstant()&&(this.multiplier=this.multiplier.multiply(a.multiplier),a=new l(1)),this.length--),a.isOne(!0)?a.multiplier.lessThan(0)&&this.negate():
(this.symbols[b]=a,this.length++));0===this.length&&this.convert(D);this.group!==J&&this.group!==B||this.updateHash()}}return this},attach:function(a){if(H(a)){for(var c=0;c<a.length;c++)this.insert(a[c],"add");return this}return this.insert(a,"add")},combine:function(a){if(H(a)){for(var c=0;c<a.length;c++)this.insert(a[c],"multiply");return this}return this.insert(a,"multiply")},updateHash:function(){if(this.group!==D)if(this.group===P){for(var a="",c=this.args,b=this.fname===la,e=0;e<c.length;e++)a+=
(0===e?"":",")+g(c[e]);this.value=(b?"":this.fname)+(b?a:T(a))}else this.group!==R&&this.group!==z&&(this.value=g(this,"hash"))},keyForGroup:function(a){var c=this.group;if(c===D)var b=this.value;else c===R||c===Q?b=a===z?this.power.toDecimal():this.value:c===P?b=a===z?this.power.toDecimal():g(this,"hash"):c===z?b=a===B?g(this,"hash"):a===J?this.power.equals(1)?this.value:T(g(this,"hash"))+y.POWER_OPERATOR+this.power.toDecimal():a===z?this.power.toString():this.value:c===J?(a===J&&g(this,"hash"),
b=a===z?this.power.toDecimal():this.value):c===B?b=a===z?this.power.toDecimal():g(this,"hash"):c===F&&(b=a===z?g(this.power):g(this,"hash"));return b},collectSymbols:function(a,c,b,e){var k=[];if(this.symbols)for(var d in this.symbols){var f=this.symbols[d];!e||f.group!==z&&f.group!==J?k.push(a?a(f,c):f):k=k.concat(f.collectSymbols())}else k.push(this);null===b&&(b=void 0);return k.sort(b)},latex:function(a){return N.latex(this,a)},text:function(a){return g(this,a)},isOne:function(a){return this.group===
D?this.multiplier[a?"absEquals":"equals"](1):this.power.equals(0)},isComposite:function(){var a=this.group,c=this.previousGroup;return a===J||a===z||c===z||c===J},isCombination:function(){var a=this.previousGroup;return this.group===B||a===B},lessThan:function(a){return this.multiplier.lessThan(a)},greaterThan:function(a){return this.multiplier.greaterThan(a)},getDenom:function(){var a;if(this.power.lessThan(0))return this.clone();this.group===B&&(a=new l(1));for(var c in this.symbols)0>this.symbols[c].power&&
(a=h.multiply(a,this.symbols[c].clone()));return a},getNum:function(){if(this.power.lessThan(0))return new l(this.multiplier.num);if(this.group===B){var a=new l(1),c;for(c in this.symbols)0<this.symbols[c].power&&(a=h.multiply(a,this.symbols[c].clone()));return a}return this.clone()},toString:function(){return this.text()}};M.prototype.toString=function(){return this.val};qa.prototype.toString=function(){return this.val};ma.prototype.toString=function(){return"`"+this.val};ua.prototype=Error();Z.prototype=
Error();var Ba={convert:function(a,c){if(0===a)c=[0,1];else if(1E-6>a||1E20<a){if(c=this.quickConversion(Number(a)),1E20>=c[1]){var b=Math.abs(a);a/=b;c=this.fullConversion(b.toFixed((c[1]+"").length-1));c[0]*=a}}else c=this.fullConversion(a);return c},quickConversion:function(a){a=(a.toExponential()+"").split("e");var c=a[0].split(".")[1],c=c?c.length:0;return[Math.pow(10,c)*a[0],Math.pow(10,Math.abs(a[1])+c)]},fullConversion:function(a){for(var c,b,e=!1,d=0,f=1,g=1,x=0,l=0,h=a;!e;){l++;1E4<l&&(e=
!0);var m=Math.floor(h);b=d+m*g;c=f+m*x;d=h-m;1E-16>d&&(e=!0);h=1/d;d=g;f=x;g=b;x=c;if(1E-16>Math.abs(b/c-a)||30<l)e=!0}return[b,c]}},N={space:"~",dot:" \\cdot ",latex:function(a,c){if(H(a)){var b=[];for(var e=0;e<a.length;e++)b.push(this.latex(a[e]));return this.brackets(b.join(", "),"square")}if(C(a)){b="\\begin{pmatrix}\n";for(e=0;e<a.elements.length;e++){var f=[],g=a.elements[e];for(c=0;c<g.length;c++)f.push(this.latex(g[c]));b+=f.join(" & ");e<a.elements.length-1&&(b+="\\\\\n")}return b+"\\end{pmatrix}"}if(x(a)){b=
"\\begin{pmatrix}\n";for(e=0;e<a.elements.length;e++)b+=this.latex(a.elements[e])+" "+(e!==a.elements.length-1?"\\\\":"");return b+"\\end{pmatrix}"}a=a.clone();var l="decimal"===c,h=a.power,e=wa(h);b=a.multiplier.lessThan(0);if(a.group===Q&&l)return String(a.multiplier.toDecimal()*Math.pow(a.value,a.power.toDecimal()));a.multiplier=a.multiplier.abs();l?(f=String(a.multiplier.toDecimal()),"1"!=f||l||(f=""),f=[f,""]):f=[a.multiplier.num,a.multiplier.den];g=this.value(a,e,c,b);e&&h.negate();l?(c=d(h)?
N.latex(h,c):String(h.toDecimal()),"1"==c&&(c="")):c=d(h)?this.latex(h,c):this.formatFrac(h,!0);l=["",""];l[e?1:0]=c;return((b?"-":"")+this.set(f,g,l,a.group===B)).replace(/\+\-/gi,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",
psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},value:function(a,c,b,e){var k=a.group;var f=a.previousGroup,g=["",""];c=c?1:0;if(k===R||k===Q||f===R||f===Q||f===D)k=a.value,(e=this.greek[k])&&(k=e),g[c]=k;else if(k===P||f===P){e=[];f=a.fname;for(k=0;k<a.args.length;k++){var l=a.args[k];l="string"===typeof l?l:this.latex(l,b);e.push(l)}f===aa?g[c]="\\sqrt"+
this.braces(e.join(",")):f===ra?g[c]=this.brackets(e.join(","),"abs"):f===la?g[c]=this.brackets(e.join(","),"parens"):"integrate"===f?g[c]="\\int"+this.braces(e[0])+this.braces("d"+e[1]):f===na||f===sa?(l=a.args[0],l.power.equals(1)&&(l.isComposite()||l.isCombination())&&(e[0]=this.brackets(e[0])),g[c]=e[0]+(f===na?"!":"!!")):(k=""!==f?"\\mathrm"+this.braces(f):"",g[c]=k+this.brackets(e.join(","),"parens"))}else if(a.isComposite()){f=a.collectSymbols().sort(k===J||f===J?function(a,c){return c.group-
a.group}:function(a,c){a=d(a.power)?-1:a.power;return(d(c.power)?-1:c.power)-a});l=[];var h=f.length;for(k=0;k<h;k++)l.push(N.latex(f[k],b));k=l.join("+");g[c]=a.isLinear()&&a.multiplier.equals(1)&&!e?k:this.brackets(k,"parens")}else if(k===B||f===F){var x=[],m=[],u=[],C=[],H=0,p=0;c=function(a,c,b){if(1<b&&0<c.length){b=c.length;for(var e=0;e<b;e++){var k=c[e],d=a[k];/^\\left\(.+\\right\)\^\{.+\}$/g.test(d)||/^\\left\(.+\\right\)$/g.test(d)||(a[k]=N.brackets(d,"parens"))}}return a};a.each(function(c){if(wa(c.power)){var e=
N.latex(c.invert(),b);p++;c.isComposite()&&(1!=a.multiplier.den&&1==Math.abs(c.power)&&(e=N.brackets(e,"parens")),u.push(x.length));x.push(e)}else e=N.latex(c,b),H++,c.isComposite()&&(1!=a.multiplier.num&&1==Math.abs(c.power)&&(e=N.brackets(e,"parens")),C.push(m.length)),m.push(e)});c(m,C,H);g[0]=m.join(this.dot);c(x,u,p);g[1]=x.join(this.dot)}return g},set:function(a,c,b,e){b&&(b=this.formatP(b));if(e){var k=b[0];b[0]=""}c=this.merge(c,b);b=a[0];a=a[1];var d=c[0];c=c[1];d&&1==b&&(b="");1==a&&(a=
"");b=this.join(b,d,/^\\left\(.+\\right\)$/.test(d)?"":this.dot);c=this.join(a,c,/^\\left\(.+\\right\)$/.test(c)?"":this.dot);return b&&c?(c=this.frac(b,c),e&&k&&(c=this.brackets(c)+k),c):b},merge:function(a,c){for(var b=[],e=0;2>e;e++)b[e]=a[e]+c[e];return b},join:function(a,c,b){return a||c?a&&!c?a:c&&!a?c:a+b+c:""},formatP:function(a){for(var c=0;2>c;c++){var b=a[c];b&&(a[c]="^"+this.braces(b))}return a},formatFrac:function(a,c){var b=a.num.toString();a=a.den.toString();return c&&"1"===b&&"1"===
a?"":"1"===a?b:this.frac(b,a)},frac:function(a,c){return"\\frac"+this.braces(a)+this.braces(c)},braces:function(a){return"{"+a+"}"},brackets:function(a,c){c={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[c||"parens"];return"\\left"+c[0]+a+"\\right"+c[1]}};W.arrayPrefill=function(a,c){var b=[];c=c||0;for(var e=0;e<a;e++)b[e]=c;return b};W.fromArray=function(a){var c=new W;c.elements=a;return c};W.prototype={custom:!0,e:function(a){return 1>a||a>this.elements.length?
null:this.elements[a-1]},set:function(a,c){this.elements[a]=new l(c)},dimensions:function(){return this.elements.length},modulus:function(){return Y("SAFE",function(){return h.pow(this.dot(this.clone()),new l(.5))},void 0,this)},eql:function(a){var c=this.elements.length;a=a.elements||a;if(c!==a.length)return!1;do if(Math.abs(h.subtract(this.elements[c-1],a[c-1]).valueOf())>PRECISION)return!1;while(--c);return!0},clone:function(){for(var a=new W,c=this.elements.length,b=0;b<c;b++)a.elements.push(this.elements[b].clone());
return a},map:function(a){var c=[];this.each(function(b,e){c.push(a(b,e))});return new W(c)},each:function(a){var c=this.elements.length,b=c;do{var e=b-c;a(this.elements[e],e+1)}while(--c)},toUnitVector:function(){return Y("SAFE",function(){var a=this.modulus();return 0===a.valueOf()?this.clone():this.map(function(c){return h.divide(c,a)})},void 0,this)},angleFrom:function(a){return Y("SAFE",function(){var c=a.elements||a;if(this.elements.length!==c.length)return null;var b=new l(0),e=new l(0),d=
new l(0);this.each(function(a,k){b=h.add(b,h.multiply(a,c[k-1]));e=h.add(e,h.multiply(a,a));d=h.add(d,h.multiply(c[k-1],c[k-1]))});var e=h.pow(e,new l(.5)),d=h.pow(d,new l(.5)),f=h.multiply(e,d);if(0===f.valueOf())return null;var f=h.divide(b,f),g=f.valueOf();-1>g&&(f=-1);1<g&&(f=1);return new l(Math.acos(f))},void 0,this)},isParallelTo:function(a){a=this.angleFrom(a).valueOf();return null===a?null:a<=PRECISION},isAntiparallelTo:function(a){a=this.angleFrom(a).valueOf();return null===a?null:Math.abs(a-
Math.PI)<=Sylvester.precision},isPerpendicularTo:function(a){a=this.dot(a);return null===a?null:Math.abs(a)<=Sylvester.precision},add:function(a){return Y("SAFE",function(){var c=a.elements||a;return this.elements.length!==c.length?null:this.map(function(a,b){return h.add(a,c[b-1])})},void 0,this)},subtract:function(a){return Y("SAFE",function(){var c=a.elements||a;return this.elements.length!==c.length?null:this.map(function(a,b){return h.subtract(a,c[b-1])})},void 0,this)},multiply:function(a){return this.map(function(c){return c.clone()*
a.clone()})},x:function(a){return this.multiply(a)},dot:function(a){return Y("SAFE",function(){var c=a.elements||a,b=new l(0),e=this.elements.length;if(e!==c.length)return null;do b=h.add(b,h.multiply(this.elements[e-1],c[e-1]));while(--e);return b},void 0,this)},cross:function(a){var c=a.elements||a;if(3!==this.elements.length||3!==c.length)return null;var b=this.elements;return Y("SAFE",function(){return new W([h.subtract(h.multiply(b[1],c[2]),h.multiply(b[2],c[1])),h.subtract(h.multiply(b[2],c[0]),
h.multiply(b[0],c[2])),h.subtract(h.multiply(b[0],c[1]),h.multiply(b[1],c[0]))])},void 0,this)},max:function(){var a=0,c=this.elements.length,b=c;do{var e=b-c;Math.abs(this.elements[e].valueOf())>Math.abs(a.valueOf())&&(a=this.elements[e])}while(--c);return a},indexOf:function(a){var c=null,b=this.elements.length,e=b;do{var d=e-b;null===c&&this.elements[d].valueOf()===a.valueOf()&&(c=d+1)}while(--b);return c},text:function(a){return g(this)},toString:function(){return this.text()},latex:function(a){var c=
[],b;for(b in this.elements)c.push(N.latex.call(N,this.elements[b],a));return"["+c.join(", ")+"]"}};O.identity=function(a){for(var c=new O,b=0;b<a;b++){c.elements.push([]);for(var e=0;e<a;e++)c.set(b,e,b===e?new l(1):new l(0))}return c};O.fromArray=function(a){function c(a){return O.apply(this,a)}c.prototype=O.prototype;return new c(a)};O.zeroMatrix=function(a,c){for(var b=new O,e=0;e<a;e++)b.elements.push(W.arrayPrefill(c,new l(0)));return b};O.prototype={custom:!0,get:function(a,c){if(this.elements[a])return this.elements[a][c]},
set:function(a,c,b){this.elements[a]||(this.elements[a]=[]);this.elements[a][c]=d(b)?b:new l(b)},cols:function(){return this.elements[0].length},rows:function(){return this.elements.length},row:function(a){return!a||a>this.cols()?[]:this.elements[a-1]},col:function(a){var c=this.rows(),b=[];if(a>this.cols()||!a)return b;for(var e=0;e<c;e++)b.push(this.elements[e][a-1]);return b},eachElement:function(a){var c=this.rows(),b=this.cols(),e,d;for(e=0;e<c;e++)for(d=0;d<b;d++)this.elements[e][d]=a.call(this,
this.elements[e][d],e,d)},determinant:function(){if(!this.isSquare())return null;var a=this.toRightTriangular(),c=a.elements[0][0],b=a.elements.length-1,e=b;do{var d=e-b+1;c=h.multiply(c,a.elements[d][d])}while(--b);return c},isSquare:function(){return this.elements.length===this.elements[0].length},isSingular:function(){return this.isSquare()&&0===this.determinant()},augment:function(a){var c=this.rows(),b=a.rows();c!==b&&G("Cannot augment matrix. Rows don't match.");for(b=0;b<c;b++)this.elements[b]=
this.elements[b].concat(a.elements[b]);return this},clone:function(){for(var a=this.rows(),c=this.cols(),b=new O,e=0;e<a;e++){b.elements[e]=[];for(var f=0;f<c;f++){var g=this.elements[e][f];b.elements[e][f]=d(g)?g.clone():g}}return b},invert:function(){this.isSquare()||G("Matrix is not square!");return Y("SAFE",function(){var a=this.elements.length,c=a;var b=O.identity(a);var e=this.augment(b).toRightTriangular(),d=e.elements[0].length,f=[];do{b=a-1;var g=[];var l=d;f[b]=[];var x=e.elements[b][b];
do{var m=d-l;var u=h.divide(e.elements[b][m],x.clone());g.push(u);m>=c&&f[b].push(u)}while(--l);e.elements[b]=g;for(x=0;x<b;x++){g=[];l=d;do m=d-l,g.push(h.subtract(e.elements[x][m].clone(),h.multiply(e.elements[b][m].clone(),e.elements[x][b].clone())));while(--l);e.elements[x]=g}}while(--a);return O.fromArray(f)},void 0,this)},toRightTriangular:function(){return Y("SAFE",function(){var a=this.clone(),c,b=this.elements.length,e=b,d=this.elements[0].length;do{var f=e-b;var g=a.elements[f][f];if(0===
g.valueOf())for(g=f+1;g<e;g++)if((c=a.elements[g][f])&&0!==c.valueOf()){c=[];var x=d;do{var m=d-x;c.push(h.add(a.elements[f][m].clone(),a.elements[g][m].clone()))}while(--x);a.elements[f]=c;break}g=a.elements[f][f];if(0!==g.valueOf())for(g=f+1;g<e;g++){var u=h.divide(a.elements[g][f].clone(),a.elements[f][f].clone());c=[];x=d;do m=d-x,c.push(m<=f?new l(0):h.subtract(a.elements[g][m].clone(),h.multiply(a.elements[f][m].clone(),u.clone())));while(--x);a.elements[g]=c}}while(--b);return a},void 0,this)},
transpose:function(){var a=this.elements.length,b=this.elements[0].length,d=new O,e=b;do{var f=b-e;d.elements[f]=[];var g=a;do{var l=a-g;d.elements[f][l]=this.elements[l][f].clone()}while(--g)}while(--e);return d},canMultiplyFromLeft:function(a){a=C(a)?a.elements.length:a.length;return this.elements[0].length===a},sameSize:function(a){return this.rows()===a.rows()&&this.cols()===a.cols()},multiply:function(a){return Y("SAFE",function(){var b=a.elements||a;if(!this.canMultiplyFromLeft(b)){if(this.sameSize(a)){for(var b=
new O,d=this.rows(),e=0;e<d;e++){var f=h.multiply(new W(this.elements[e]),new W(a.elements[e]));b.elements[e]=f.elements}return b}return null}var f=d=this.elements.length,g=b[0].length,x=this.elements[0].length,m=[];do{e=f-d;m[e]=[];var u=g;do{var C=g-u;var H=new l(0);var p=x;do{var E=x-p;H=h.add(H,h.multiply(this.elements[e][E],b[E][C]))}while(--p);m[e][C]=H}while(--u)}while(--d);return O.fromArray(m)},void 0,this)},add:function(a){var b=new O;this.sameSize(a)&&this.eachElement(function(c,e,d){b.set(e,
d,h.add(c.clone(),a.elements[e][d]))});return b},subtract:function(a){var b=new O;this.sameSize(a)&&this.eachElement(function(c,e,d){b.set(e,d,h.subtract(c.clone(),a.elements[e][d]))});return b},negate:function(){this.each(function(a){return a.negate()});return this},toVector:function(){if(1===this.rows()||1===this.cols()){var a=new W;a.elements=this.elements;return a}return this},toString:function(a){a=this.rows();for(var b=[],d=0;d<a;d++)b.push("["+this.elements[d].map(function(a){return void 0!==
a?a.toString():""}).join(",")+"]");return"matrix"+T(b.join(","))},text:function(){return"matrix("+this.toString("")+")"},latex:function(a){var b=this.cols(),d=this.elements;return va("\\begin{vmatrix}{0}\\end{vmatrix}",function(){var c=[],f;for(f in d){for(var k=[],g=0;g<b;g++)k.push(N.latex.call(N,d[f][g],a));c.push(k.join(" & "))}return c.join(" \\cr ")})}};O.prototype.each=O.prototype.eachElement;var Ma=w.build=function(a,b){a=Y("PARSE2NUMBER",function(){return h.parse(a)},!0);var c=ha(a),d=[],
f=function(a,b){b=b||[];var c=[],e=a.group,k="",g=function(c){c=c===B?"*":"+";var e=[],d;for(d in a.symbols){var k=a.symbols[d],g=f(k,b)[0];k.isComposite()&&(g=T(g));e.push(g)}return d=(d=e.join(c))&&!a.multiplier.equals(1)?T(d):d},l=function(c){c in Math?c="Math."+c:-1===d.indexOf(c)&&(b.push("var "+c+" = "+V[c].toString()+"; "),d.push(c));return c+=T(a.args.map(function(a){return f(a,b)[0]}).join(","))};e===D?c.push(a.multiplier.toDecimal()):a.multiplier.equals(-1)?k="-":a.multiplier.equals(1)||
c.push(a.multiplier.toDecimal());e===R||e===Q?g=a.value:e===P?g=l(a.fname):e===F?(e=a.previousGroup,g=e===D||e===R?a.value:e===P?l(a.fname):g(a.previousGroup)):g=g(a.group);a.group===D||a.power.equals(1)||(l=f(h.parse(a.power)),b.push(l[1]),g="Math.pow"+T(g+","+l[0]));g&&c.push(k+g);return[c.join("*"),b.join("").replace(/\n+\s+/g," ")]};if(b){for(var g=0;g<c.length;g++){var l=c[g];-1===b.indexOf(l)&&G(l+" not found in argument array")}c=b}b=f(a);return new Function(c,b[1]+" return "+b[0]+";")};Aa(h.constants);
Aa(h.functions);Fa(y.init_primes);var S={exceptions:{}};S.Operator=M;S.groups=p;S.Symbol=l;S.Expression=m;S.Frac=r;S.Vector=W;S.Matrix=O;S.Parser=pa;S.Fraction=Ba;S.Math2=V;S.LaTeX=N;S.Utils=w;S.PRIMES=ca;S.PARSER=h;S.PARENTHESIS=la;S.Settings=y;S.VARS=da;S.err=G;S.bigInt=U;S.exceptions.DivisionByZero=ua;S.exceptions.ParseError=Z;h.error||(h.error=G);var L=function(a,b,d,e){a instanceof m&&(a=a.toString());var c=H(d),f=c?-1!==d.indexOf("numer"):"numer"===d;if(c?-1!==d.indexOf("expand"):"expand"===
d)a=va("{0}({1})","expand",a);d=Y("PARSE2NUMBER",function(){return h.parse(a,b)},f||y.PARSE2NUMBER);e?A[e-1]=d:A.push(d);return new m(d)};L.rpn=function(a){return h.parse(a,null,!0)};L.convertToLaTeX=function(a){return h.toTeX(a)};L.version=function(a){if(a)try{return S[a].version}catch(c){return"No module named "+a+" found!"}return"0.7.11"};L.getWarnings=function(){return""};L.setConstant=function(a,b){ba(a);if(!ga(a))if("delete"===b)delete h.constants[a];else{if(isNaN(b))throw Error("Constant must be a number!");
h.constants[a]=b}return this};L.setFunction=function(a,b,d){ba(a);return ga(a)?!1:(b=b||ha(h.parse(d)),h.functions[a]=[h.mapped_function,b.length,{name:a,params:b,body:d}],!0)};L.getCore=function(){return S};L.getExpression=L.getEquation=m.getExpression;L.reserved=function(a){return a?ka:ka.join(", ")};L.clear=function(a,b){"all"===a?A=[]:"last"===a?A.pop():"first"===a?A.shift():(a=a?a-1:A.length,!0===b?A[a]=void 0:Ea(A,a));return this};L.flush=function(){this.clear("all");return this};L.expressions=
function(a,b,d){for(var c=a?{}:[],f=0;f<A.length;f++){var k=b?N.latex(A[f],d):g(A[f],d);a?c[f+1]=k:c.push(k)}return c};L.register=function(a){var b=this.getCore();if(H(a))for(var d=0;d<a.length;d++)a&&this.register(a[d]);else if(a&&-1===y.exclude.indexOf(a.name)){if(a.dependencies)for(d=0;d<a.dependencies.length;d++)if(!b[a.dependencies[d]])throw Error(va("{0} requires {1} to be loaded!",a.name,a.dependencies[d]));var d=a.parent,e=a.build.call(b);d&&(b[d]||(b[a.parent]={}),("nerdamer"===d?this:b[d])[a.name]=
e);a.visible&&(h.functions[a.name]=[e,a.numargs])}};L.validateName=ba;L.validVarName=function(a){try{return ba(a),-1===ka.indexOf(a)}catch(c){return!1}};L.supported=function(){return ya(h.functions)};L.numEquations=L.numExpressions=function(){return A.length};L.setVar=function(a,b){ba(a);a in h.constants&&G("Cannot set value for constant "+a);"delete"===b?delete da[a]:da[a]=d(b)?b:h.parse(b);return this};L.clearVars=function(){da={};return this};L.load=function(a){a.call(this);return this};L.getVars=
function(a,b){a=a||"text";var c={};if("object"===a)c=da;else for(var d in da)"latex"===a?c[d]=da[d].latex(b):"text"===a&&(c[d]=da[d].text(b));return c};L.set=function(a,b){-1!==["SAFE"].indexOf(a)&&G("Cannot modify setting: "+a);y[a]=b};L.api=function(a){var b=function(a){return function(){for(var b=[].slice.call(arguments),c=0;c<b.length;c++)b[c]=h.parse(b[c]);return new m(Y("PARSE2NUMBER",function(){return h.callfunction(a,b)}))}},d;for(d in h.functions)d in L&&!a||(L[d]=b(d))};L.convert=function(a){return h.parse(a,
null,!0)};L.api();return L}({bigInt:function(p){function g(b,d){this.value=b;this.sign=d;this.isSmall=!1}function m(b){this.value=b;this.sign=0>b;this.isSmall=!0}function r(b){return-9007199254740992<b&&9007199254740992>b}function l(b){return 1E7>b?[b]:1E14>b?[b%1E7,Math.floor(b/1E7)]:[b%1E7,Math.floor(b/1E7)%1E7,Math.floor(b/1E14)]}function ia(b){M(b);var d=b.length;if(4>d&&0>F(b,da))switch(d){case 0:return 0;case 1:return b[0];case 2:return b[0]+1E7*b[1];default:return b[0]+1E7*(b[1]+1E7*b[2])}return b}
function M(b){for(var d=b.length;0===b[--d];);b.length=d+1}function qa(b){for(var d=Array(b),f=-1;++f<b;)d[f]=0;return d}function ma(b){return 0<b?Math.floor(b):Math.ceil(b)}function ua(b,d){var f=b.length,g=d.length,l=Array(f),m=0,h;for(h=0;h<g;h++){var p=b[h]+d[h]+m;m=1E7<=p?1:0;l[h]=p-1E7*m}for(;h<f;)p=b[h]+m,m=1E7===p?1:0,l[h++]=p-1E7*m;0<m&&l.push(m);return l}function Z(b,d){return b.length>=d.length?ua(b,d):ua(d,b)}function pa(b,d){var f=b.length,g=Array(f),l;for(l=0;l<f;l++){var m=b[l]-1E7+
d;d=Math.floor(m/1E7);g[l]=m-1E7*d;d+=1}for(;0<d;)g[l++]=d%1E7,d=Math.floor(d/1E7);return g}function W(b,d){var f=b.length,g=d.length,l=Array(f),m=0,h;for(h=0;h<g;h++){var p=b[h]-m-d[h];0>p?(p+=1E7,m=1):m=0;l[h]=p}for(h=g;h<f;h++){p=b[h]-m;if(0>p)p+=1E7;else{l[h++]=p;break}l[h]=p}for(;h<f;h++)l[h]=b[h];M(l);return l}function O(b,d,f){var l=b.length,h=Array(l);d=-d;var u;for(u=0;u<l;u++){var p=b[u]+d;d=Math.floor(p/1E7);p%=1E7;h[u]=0>p?p+1E7:p}h=ia(h);return"number"===typeof h?(f&&(h=-h),new m(h)):
new g(h,f)}function h(b,d){var f=b.length,g=d.length,l=qa(f+g),h;for(h=0;h<f;++h){var m=b[h];for(var p=0;p<g;++p){var r=d[p];r=m*r+l[h+p];var A=Math.floor(r/1E7);l[h+p]=r-1E7*A;l[h+p+1]+=A}}M(l);return l}function U(b,d){var f=b.length,g=Array(f),l=0,h;for(h=0;h<f;h++){var m=b[h]*d+l;l=Math.floor(m/1E7);g[h]=m-1E7*l}for(;0<l;)g[h++]=l%1E7,l=Math.floor(l/1E7);return g}function ca(b,d){for(var f=[];0<d--;)f.push(0);return f.concat(b)}function w(b,d){var f=Math.max(b.length,d.length);if(30>=f)return h(b,
d);var f=Math.ceil(f/2),g=b.slice(f);b=b.slice(0,f);var l=d.slice(f),m=d.slice(0,f);d=w(b,m);var p=w(g,l),g=w(Z(b,g),Z(m,l)),f=Z(Z(d,ca(W(W(g,d),p),f)),ca(p,2*f));M(f);return f}function y(b,d,f){return 1E7>b?new g(U(d,b),f):new g(h(d,l(b)),f)}function D(b){var d=b.length,f=qa(d+d),g;for(g=0;g<d;g++){var l=b[g];for(var h=0;h<d;h++){var m=b[h];m=l*m+f[g+h];var p=Math.floor(m/1E7);f[g+h]=m-1E7*p;f[g+h+1]+=p}}M(f);return f}function Q(b,d){var f=b.length,g=qa(f);var l=0;for(--f;0<=f;--f){l=1E7*l+b[f];
var h=ma(l/d);l-=h*d;g[f]=h|0}return[g,l|0]}function R(b,d){d=A(d);var f=b.value;var h=d.value;if(0===h)throw Error("Cannot divide by zero");if(b.isSmall)return d.isSmall?[new m(ma(f/h)),new m(f%h)]:[I[0],b];if(d.isSmall){if(1===h)return[b,I[0]];if(-1==h)return[b.negate(),I[0]];h=Math.abs(h);if(1E7>h)return h=Q(f,h),f=ia(h[0]),h=h[1],b.sign&&(h=-h),"number"===typeof f?(b.sign!==d.sign&&(f=-f),[new m(f),new m(h)]):[new g(f,b.sign!==d.sign),new m(h)];h=l(h)}var p=F(f,h);if(-1===p)return[I[0],b];if(0===
p)return[I[b.sign===d.sign?1:-1],I[0]];if(200>=f.length+h.length){var u=h,r=f.length;h=u.length;var p=qa(u.length),E=u[h-1],z=Math.ceil(1E7/(2*E)),f=U(f,z),u=U(u,z),w,y,B;f.length<=r&&f.push(0);u.push(0);E=u[h-1];for(w=r-h;0<=w;w--){r=9999999;f[w+h]!==E&&(r=Math.floor((1E7*f[w+h]+f[w+h-1])/E));var D=y=0;var G=u.length;for(B=0;B<G;B++){y+=r*u[B];var J=Math.floor(y/1E7);D+=f[w+B]-(y-1E7*J);y=J;0>D?(f[w+B]=D+1E7,D=-1):(f[w+B]=D,D=0)}for(;0!==D;){--r;for(B=y=0;B<G;B++)y+=f[w+B]-1E7+u[B],0>y?(f[w+B]=y+
1E7,y=0):(f[w+B]=y,y=1);D+=y}p[w]=r}f=Q(f,z)[0];h=[ia(p),ia(f)]}else{p=f.length;E=h.length;z=[];for(u=[];p;)if(u.unshift(f[--p]),0>F(u,h))z.push(0);else{r=u.length;w=1E7*u[r-1]+u[r-2];y=1E7*h[E-1]+h[E-2];r>E&&(w=1E7*(w+1));r=Math.ceil(w/y);do{w=U(h,r);if(0>=F(w,u))break;r--}while(r);z.push(r);u=W(u,w)}z.reverse();h=[ia(z),ia(u)]}f=h[0];d=b.sign!==d.sign;h=h[1];b=b.sign;"number"===typeof f?(d&&(f=-f),f=new m(f)):f=new g(f,d);"number"===typeof h?(b&&(h=-h),h=new m(h)):h=new g(h,b);return[f,h]}function F(b,
d){if(b.length!==d.length)return b.length>d.length?1:-1;for(var f=b.length-1;0<=f;f--)if(b[f]!==d[f])return b[f]>d[f]?1:-1;return 0}function P(b){b=b.abs();if(b.isUnit())return!1;if(b.equals(2)||b.equals(3)||b.equals(5))return!0;if(b.isEven()||b.isDivisibleBy(3)||b.isDivisibleBy(5))return!1;if(b.lesser(25))return!0}function z(b){return("number"===typeof b||"string"===typeof b)&&1E7>=+Math.abs(b)||b instanceof g&&1>=b.value.length}function B(b,d,f){d=A(d);var g=b.isNegative(),h=d.isNegative(),l=g?
b.not():b,m=h?d.not():d;d=[];b=[];for(var p=!1,r=!1;!p||!r;)l.isZero()?(p=!0,d.push(g?1:0)):g?d.push(l.isEven()?1:0):d.push(l.isEven()?0:1),m.isZero()?(r=!0,b.push(h?1:0)):h?b.push(m.isEven()?1:0):b.push(m.isEven()?0:1),l=l.over(2),m=m.over(2);g=[];for(h=0;h<d.length;h++)g.push(f(d[h],b[h]));for(f=bigInt(g.pop()).negate().times(bigInt(2).pow(g.length));g.length;)f=f.add(bigInt(g.pop()).times(bigInt(2).pow(g.length)));return f}function J(b){b=b.value;b="number"===typeof b?b|1073741824:b[0]+1E7*b[1]|
1073758208;return b&-b}function ta(b,d){b=A(b);d=A(d);return b.greater(d)?b:d}function la(b,d){b=A(b);d=A(d);return b.lesser(d)?b:d}function aa(b,d){b=A(b).abs();d=A(d).abs();if(b.equals(d))return b;if(b.isZero())return d;if(d.isZero())return b;for(var f=I[1],g;b.isEven()&&d.isEven();)g=Math.min(J(b),J(d)),b=b.divide(g),d=d.divide(g),f=f.multiply(g);for(;b.isEven();)b=b.divide(J(b));do{for(;d.isEven();)d=d.divide(J(d));b.greater(d)&&(g=d,d=b,b=g);d=d.subtract(b)}while(!d.isZero());return f.isUnit()?
b:b.multiply(f)}function ra(b){b=b.value;"number"===typeof b&&(b=[b]);return 1===b.length&&35>=b[0]?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(b[0]):"<"+b+">"}function na(b,d){d=bigInt(d);if(d.isZero()){if(b.isZero())return"0";throw Error("Cannot convert nonzero numbers to base 0.");}if(d.equals(-1))return b.isZero()?"0":b.isNegative()?Array(1-b).join("10"):"1"+Array(+b).join("01");var f="";b.isNegative()&&d.isPositive()&&(f="-",b=b.abs());if(d.equals(1))return b.isZero()?"0":f+Array(+b+1).join(1);
for(var g=[],h;b.isNegative()||0<=b.compareAbs(d);)h=b.divmod(d),b=h.quotient,h=h.remainder,h.isNegative()&&(h=d.minus(h).abs(),b=b.next()),g.push(ra(h));g.push(ra(b));return f+g.reverse().join("")}function sa(b){if(r(+b)){var d=+b;if(d===ma(d))return new m(d);throw"Invalid integer: "+b;}(d="-"===b[0])&&(b=b.slice(1));var f=b.split(/e/i);if(2<f.length)throw Error("Invalid integer: "+h.join("e"));if(2===f.length){b=f[1];"+"===b[0]&&(b=b.slice(1));b=+b;if(b!==ma(b)||!r(b))throw Error("Invalid integer: "+
b+" is not a valid exponent.");var h=f[0];f=h.indexOf(".");0<=f&&(b-=h.length-f-1,h=h.slice(0,f)+h.slice(f+1));if(0>b)throw Error("Cannot include negative exponent part for integers");b=h+=Array(b+1).join("0")}if(!/^([0-9][0-9]*)$/.test(b))throw Error("Invalid integer: "+b);h=[];for(var f=b.length,l=f-7;0<f;)h.push(+b.slice(l,f)),l-=7,0>l&&(l=0),f-=7;M(h);return new g(h,d)}function A(b){return"number"===typeof b?(b=r(b)?new m(b):sa(b.toString()),b):"string"===typeof b?sa(b):b}var da=l(9007199254740992),
ka=Math.log(9007199254740992);g.prototype.add=function(b){b=A(b);if(this.sign!==b.sign)return this.subtract(b.negate());var d=this.value,f=b.value;return b.isSmall?new g(pa(d,Math.abs(f)),this.sign):new g(Z(d,f),this.sign)};g.prototype.plus=g.prototype.add;m.prototype.add=function(b){b=A(b);var d=this.value;if(0>d!==b.sign)return this.subtract(b.negate());var f=b.value;if(b.isSmall){if(r(d+f))return new m(d+f);f=l(Math.abs(f))}return new g(pa(f,Math.abs(d)),0>d)};m.prototype.plus=m.prototype.add;
g.prototype.subtract=function(b){var d=A(b);if(this.sign!==d.sign)return this.add(d.negate());b=this.value;var f=d.value;if(d.isSmall)return O(b,Math.abs(f),this.sign);d=this.sign;0<=F(b,f)?b=W(b,f):(b=W(f,b),d=!d);b=ia(b);"number"===typeof b?(d&&(b=-b),b=new m(b)):b=new g(b,d);return b};g.prototype.minus=g.prototype.subtract;m.prototype.subtract=function(b){b=A(b);var d=this.value;if(0>d!==b.sign)return this.add(b.negate());var f=b.value;return b.isSmall?new m(d-f):O(f,Math.abs(d),0<=d)};m.prototype.minus=
m.prototype.subtract;g.prototype.negate=function(){return new g(this.value,!this.sign)};m.prototype.negate=function(){var b=this.sign,d=new m(-this.value);d.sign=!b;return d};g.prototype.abs=function(){return new g(this.value,!1)};m.prototype.abs=function(){return new m(Math.abs(this.value))};g.prototype.multiply=function(b){var d=A(b);b=this.value;var f=d.value,m=this.sign!==d.sign;if(d.isSmall){if(0===f)return I[0];if(1===f)return this;if(-1===f)return this.negate();f=Math.abs(f);if(1E7>f)return new g(U(b,
f),m);f=l(f)}var d=b.length,p=f.length;return 0<-.012*d-.012*p+1.5E-5*d*p?new g(w(b,f),m):new g(h(b,f),m)};g.prototype.times=g.prototype.multiply;m.prototype._multiplyBySmall=function(b){return r(b.value*this.value)?new m(b.value*this.value):y(Math.abs(b.value),l(Math.abs(this.value)),this.sign!==b.sign)};g.prototype._multiplyBySmall=function(b){return 0===b.value?I[0]:1===b.value?this:-1===b.value?this.negate():y(Math.abs(b.value),this.value,this.sign!==b.sign)};m.prototype.multiply=function(b){return A(b)._multiplyBySmall(this)};
m.prototype.times=m.prototype.multiply;g.prototype.square=function(){return new g(D(this.value),!1)};m.prototype.square=function(){var b=this.value*this.value;return r(b)?new m(b):new g(D(l(Math.abs(this.value))),!1)};g.prototype.divmod=function(b){b=R(this,b);return{quotient:b[0],remainder:b[1]}};m.prototype.divmod=g.prototype.divmod;g.prototype.divide=function(b){return R(this,b)[0]};m.prototype.over=m.prototype.divide=g.prototype.over=g.prototype.divide;g.prototype.mod=function(b){return R(this,
b)[1]};m.prototype.remainder=m.prototype.mod=g.prototype.remainder=g.prototype.mod;g.prototype.pow=function(b){var d=A(b),f=this.value;b=d.value;var g;if(0===b)return I[1];if(0===f)return I[0];if(1===f)return I[1];if(-1===f)return d.isEven()?I[1]:I[-1];if(d.sign)return I[0];if(!d.isSmall)throw Error("The exponent "+d.toString()+" is too large.");if(this.isSmall&&r(g=Math.pow(f,b)))return new m(ma(g));g=this;for(d=I[1];;){b&1&&(d=d.times(g),--b);if(0===b)break;b/=2;g=g.square()}return d};m.prototype.pow=
g.prototype.pow;g.prototype.modPow=function(b,d){b=A(b);d=A(d);if(d.isZero())throw Error("Cannot take modPow with modulus 0");for(var f=I[1],g=this.mod(d);b.isPositive();){if(g.isZero())return I[0];b.isOdd()&&(f=f.multiply(g).mod(d));b=b.divide(2);g=g.square().mod(d)}return f};m.prototype.modPow=g.prototype.modPow;g.prototype.compareAbs=function(b){b=A(b);return b.isSmall?1:F(this.value,b.value)};m.prototype.compareAbs=function(b){b=A(b);var d=Math.abs(this.value),f=b.value;return b.isSmall?(f=Math.abs(f),
d===f?0:d>f?1:-1):-1};g.prototype.compare=function(b){if(Infinity===b)return-1;if(-Infinity===b)return 1;b=A(b);return this.sign!==b.sign?b.sign?1:-1:b.isSmall?this.sign?-1:1:F(this.value,b.value)*(this.sign?-1:1)};g.prototype.compareTo=g.prototype.compare;m.prototype.compare=function(b){if(Infinity===b)return-1;if(-Infinity===b)return 1;b=A(b);var d=this.value,f=b.value;return b.isSmall?d==f?0:d>f?1:-1:0>d!==b.sign?0>d?-1:1:0>d?1:-1};m.prototype.compareTo=m.prototype.compare;g.prototype.equals=function(b){return 0===
this.compare(b)};m.prototype.eq=m.prototype.equals=g.prototype.eq=g.prototype.equals;g.prototype.notEquals=function(b){return 0!==this.compare(b)};m.prototype.neq=m.prototype.notEquals=g.prototype.neq=g.prototype.notEquals;g.prototype.greater=function(b){return 0<this.compare(b)};m.prototype.gt=m.prototype.greater=g.prototype.gt=g.prototype.greater;g.prototype.lesser=function(b){return 0>this.compare(b)};m.prototype.lt=m.prototype.lesser=g.prototype.lt=g.prototype.lesser;g.prototype.greaterOrEquals=
function(b){return 0<=this.compare(b)};m.prototype.geq=m.prototype.greaterOrEquals=g.prototype.geq=g.prototype.greaterOrEquals;g.prototype.lesserOrEquals=function(b){return 0>=this.compare(b)};m.prototype.leq=m.prototype.lesserOrEquals=g.prototype.leq=g.prototype.lesserOrEquals;g.prototype.isEven=function(){return 0===(this.value[0]&1)};m.prototype.isEven=function(){return 0===(this.value&1)};g.prototype.isOdd=function(){return 1===(this.value[0]&1)};m.prototype.isOdd=function(){return 1===(this.value&
1)};g.prototype.isPositive=function(){return!this.sign};m.prototype.isPositive=function(){return 0<this.value};g.prototype.isNegative=function(){return this.sign};m.prototype.isNegative=function(){return 0>this.value};g.prototype.isUnit=function(){return!1};m.prototype.isUnit=function(){return 1===Math.abs(this.value)};g.prototype.isZero=function(){return!1};m.prototype.isZero=function(){return 0===this.value};g.prototype.isDivisibleBy=function(b){b=A(b);var d=b.value;return 0===d?!1:1===d?!0:2===
d?this.isEven():this.mod(b).equals(I[0])};m.prototype.isDivisibleBy=g.prototype.isDivisibleBy;g.prototype.isPrime=function(){var b=P(this);if(b!==p)return b;for(var b=this.abs(),d=b.prev(),f=[2,3,5,7,11,13,17,19],g=d,h,l,m,r;g.isEven();)g=g.divide(2);for(m=0;m<f.length;m++)if(r=bigInt(f[m]).modPow(g,b),!r.equals(I[1])&&!r.equals(d)){l=!0;for(h=g;l&&h.lesser(d);h=h.multiply(2))r=r.square().mod(b),r.equals(d)&&(l=!1);if(l)return!1}return!0};m.prototype.isPrime=g.prototype.isPrime;g.prototype.isProbablePrime=
function(b){var d=P(this);if(d!==p)return d;d=this.abs();b=b===p?5:b;for(var f=0;f<b;f++)if(!bigInt.randBetween(2,d.minus(2)).modPow(d.prev(),d).isUnit())return!1;return!0};m.prototype.isProbablePrime=g.prototype.isProbablePrime;g.prototype.next=function(){var b=this.value;return this.sign?O(b,1,this.sign):new g(pa(b,1),this.sign)};m.prototype.next=function(){var b=this.value;return 9007199254740992>b+1?new m(b+1):new g(da,!1)};g.prototype.prev=function(){var b=this.value;return this.sign?new g(pa(b,
1),!0):O(b,1,this.sign)};m.prototype.prev=function(){var b=this.value;return-9007199254740992<b-1?new m(b-1):new g(da,!0)};for(var ga=[1];1E7>=ga[ga.length-1];)ga.push(2*ga[ga.length-1]);var G=ga.length,ba=ga[G-1];g.prototype.shiftLeft=function(b){if(!z(b))throw Error(String(b)+" is too large for shifting.");b=+b;if(0>b)return this.shiftRight(-b);for(var d=this;b>=G;)d=d.multiply(ba),b-=G-1;return d.multiply(ga[b])};m.prototype.shiftLeft=g.prototype.shiftLeft;g.prototype.shiftRight=function(b){var d;
if(!z(b))throw Error(String(b)+" is too large for shifting.");b=+b;if(0>b)return this.shiftLeft(-b);for(d=this;b>=G;){if(d.isZero())return d;d=R(d,ba);d=d[1].isNegative()?d[0].prev():d[0];b-=G-1}d=R(d,ga[b]);return d[1].isNegative()?d[0].prev():d[0]};m.prototype.shiftRight=g.prototype.shiftRight;g.prototype.not=function(){return this.negate().prev()};m.prototype.not=g.prototype.not;g.prototype.and=function(b){return B(this,b,function(b,f){return b&f})};m.prototype.and=g.prototype.and;g.prototype.or=
function(b){return B(this,b,function(b,f){return b|f})};m.prototype.or=g.prototype.or;g.prototype.xor=function(b){return B(this,b,function(b,f){return b^f})};m.prototype.xor=g.prototype.xor;g.prototype.toString=function(b){b===p&&(b=10);if(10!==b)return na(this,b);b=this.value;for(var d=b.length,f=String(b[--d]),g;0<=--d;)g=String(b[d]),f+="0000000".slice(g.length)+g;return(this.sign?"-":"")+f};m.prototype.toString=function(b){b===p&&(b=10);return 10!=b?na(this,b):String(this.value)};g.prototype.valueOf=
function(){return+this.toString()};g.prototype.toJSNumber=g.prototype.valueOf;m.prototype.valueOf=function(){return this.value};m.prototype.toJSNumber=m.prototype.valueOf;for(var I=function(b,d){if("undefined"===typeof b)return I[0];if("undefined"!==typeof d){if(10===+d)b=A(b);else{var f=I[0],g=I[1],h=b.length;if(2<=d&&36>=d&&h<=ka/Math.log(d))b=new m(parseInt(b,d));else{d=A(d);var h=[],l,p="-"===b[0];for(l=p?1:0;l<b.length;l++){var r=b[l].toLowerCase(),w=r.charCodeAt(0);if(48<=w&&57>=w)h.push(A(r));
else if(97<=w&&122>=w)h.push(A(r.charCodeAt(0)-87));else if("<"===r){r=l;do l++;while(">"!==b[l]);h.push(A(b.slice(r+1,l)))}else throw Error(r+" is not a valid character");}h.reverse();for(l=0;l<h.length;l++)f=f.add(h[l].times(g)),g=g.times(d);b=p?f.negate():f}}return b}return A(b)},ja=0;1E3>ja;ja++)I[ja]=new m(ja),0<ja&&(I[-ja]=new m(-ja));I.one=I[1];I.zero=I[0];I.minusOne=I[-1];I.max=ta;I.min=la;I.gcd=aa;I.lcm=function(b,d){b=A(b).abs();d=A(d).abs();return b.divide(aa(b,d)).multiply(d)};I.isInstance=
function(b){return b instanceof g||b instanceof m};I.randBetween=function(b,d){b=A(b);d=A(d);var f=la(b,d);b=ta(b,d).subtract(f);if(b.isSmall)return f.add(Math.round(Math.random()*b));d=[];for(var h=!0,l=b.value.length-1;0<=l;l--){var p=h?b.value[l]:1E7,r=ma(Math.random()*p);d.unshift(r);r<p&&(h=!1)}d=ia(d);return f.add("number"===typeof d?new m(d):new g(d,!1))};return I}()});"undefined"!==typeof module&&(module.exports=nerdamer);
