var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(u,h,b){u!=Array.prototype&&u!=Object.prototype&&(u[h]=b.value)};$jscomp.getGlobal=function(u){return"undefined"!=typeof window&&window===u?u:"undefined"!=typeof global&&null!=global?global:u};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(u){return $jscomp.SYMBOL_PREFIX+(u||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var u=$jscomp.global.Symbol.iterator;u||(u=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[u]&&$jscomp.defineProperty(Array.prototype,u,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(u){var h=0;return $jscomp.iteratorPrototype(function(){return h<u.length?{done:!1,value:u[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(u){$jscomp.initSymbolIterator();u={next:u};u[$jscomp.global.Symbol.iterator]=function(){return this};return u};$jscomp.iteratorFromArray=function(u,h){$jscomp.initSymbolIterator();u instanceof String&&(u+="");var b=0,x={next:function(){if(b<u.length){var J=b++;return{value:h(J,u[J]),done:!1}}x.next=function(){return{done:!0,value:void 0}};return x.next()}};x[Symbol.iterator]=function(){return x};return x};
$jscomp.polyfill=function(u,h,b,x){if(h){b=$jscomp.global;u=u.split(".");for(x=0;x<u.length-1;x++){var J=u[x];J in b||(b[J]={});b=b[J]}u=u[u.length-1];x=b[u];h=h(x);h!=x&&null!=h&&$jscomp.defineProperty(b,u,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.keys",function(u){return u?u:function(){return $jscomp.iteratorFromArray(this,function(h){return h})}},"es6-impl","es3");
"undefined"!==typeof module&&"undefined"===typeof nerdamer&&(nerdamer=require("./nerdamer.core.js"),require("./Algebra.js"));
(function(){function u(b){this.message=b||""}var h=nerdamer.getCore(),b=h.PARSER,x=h.Frac,J=h.Utils.isSymbol,z=h.groups.FN,n=h.Symbol,C=h.Utils.text,K=h.Utils.inBrackets,ma=h.Utils.isInt,v=h.Utils.format,na=h.Utils.even,ba=h.groups.N,D=h.groups.S,z=h.groups.FN,W=h.groups.PL,P=h.groups.CP,S=h.groups.CB,Q=h.groups.EX,fa=h.groups.P;u.prototype=Error();n.prototype.hasIntegral=function(){return this.containsFunction("integrate")};n.prototype.fnTransform=function(){var a=this.args[0];if(this.isLinear())switch(this.fname){case "sinh":a=
b.parse(v("(e^({0})-e^(-({0})))/2",a));break;case "cosh":a=b.parse(v("(e^({0})+e^(-({0})))/2",a));break;case "tanh":a=b.parse(v("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",a));break;case "tan":a=b.parse(v("sin({0})/cos({0})",a));break;case "csc":a=b.parse(v("1/sin({0})",a));break;case "sec":a=b.parse(v("1/cos({0})",a));break;default:a=this}else if(this.power.equals(2))switch(this.fname){case "sin":a=b.parse(v("1/2-cos(2*({0}))/2",a));break;case "cos":a=b.parse(v("1/2+cos(2*({0}))/2",a));break;case "tan":a=
b.parse(v("sin({0})^2/cos({0})^2",a));break;case "cosh":a=b.parse(v("1/2+cosh(2*({0}))/2",a));break;case "sinh":a=b.parse(v("-1/2+cosh(2*({0}))/2",a));break;case "tanh":a=b.parse(v("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",a));break;case "sec":a=b.parse(v("(1-cos(2*({0})))/(1+cos(2*({0})))+1",a));break;default:a=this}else a="sec"===this.fname?b.parse(v("1/cos({0})^({1})",this.args[0],this.power)):"csc"===this.fname?b.parse(v("1/sin({0})^({1})",this.args[0],this.power)):"tan"===this.fname?this.power.lessThan(0)?
b.parse(v("cos({0})^({1})/sin({0})^({1})",this.args[0],this.power.clone().negate())):b.parse(v("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power)):"sin"===this.fname&&this.power.lessThan(0)?b.parse(v("csc({0})^({1})",this.args[0],this.power.clone().negate())):"cos"===this.fname&&this.power.lessThan(0)?b.parse(v("sec({0})^({1})",this.args[0],this.power.clone().negate())):"sin"===this.fname&&this.power.equals(3)?b.parse(v("(3*sin({0})-sin(3*({0})))/4",this.args[0])):"cos"===this.fname&&this.power.equals(3)?
b.parse(v("(cos(3*({0}))+3*cos({0}))/4",this.args[0])):this;return a};n.unwrapPARENS=function(b){if(b.group===z&&!b.fname){var a=b.args[0];a.power=a.power.multiply(b.power);a.multiplier=a.multiplier.multiply(b.multiplier);return a}return b};h.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()};h.Utils.in_inverse_trig=function(b){return-1!=="asin acos atan acsc asec acot".split(" ").indexOf(b)};h.Utils.in_trig=function(b){return-1!=="cos sin tan sec csc cot".split(" ").indexOf(b)};
h.Utils.in_htrig=function(b){return-1!==["sinh","cosh","tanh"].indexOf(b)};var Ja=h.Utils.all_functions=function(b){for(var a=0,e=b.length;a<e;a++)if(b[a].group!==z)return!1;return!0},ga=h.Utils.cosAsinBtranform=function(a,d){a=a.args[0].clone();d=d.args[0].clone();return b.parse(v("(sin(({0})+({1}))-sin(({0})-({1})))/2",a,d))},ca=h.Utils.cosAsinAtranform=function(a,d){a=a.args[0].clone();return b.parse(v("(sin(2*({0})))/2",a))},oa=h.Utils.cosAsinBtranform=function(a,d){a=a.args[0].clone();d=d.args[0].clone();
return b.parse(v("(cos(({0})+({1}))-cos(({0})-({1})))/2",a,d))},Ea=h.Utils.trigTransform=function(a){for(var d={},e,h=new n(1),k=0,m=a.length;k<m;k++)if(e=a[k],e.group===z){var f=e.fname;"cos"===f&&d.sin?(e=d.sin.args[0].toString()!==e.args[0].toString()?ga(e,d.sin):ca(e,d.sin),delete d.sin,h=b.multiply(h,e)):"sin"===f&&d.cos?(e=d.cos.args[0].toString()!==e.args[0].toString()?ga(e,d.cos):ca(e,d.cos),delete d.cos,h=b.multiply(h,e)):"sin"===f&&d.sin?(e=d.sin.args[0].toString()!==e.args[0].toString()?
oa(e,d.sin):b.multiply(e,d.sin),delete d.sin,h=e):d[f]=e}else h=b.multiply(h,e);for(var g in d)h=b.multiply(h,d[g]);return h};h.Settings.integration_depth=10;var d=h.Calculus={version:"1.4.2",sum:function(a,d,e,r){if(d.group!==h.groups.S)throw Error("Index must be symbol. "+C(d)+" provided");d=d.value;if(h.Utils.isNumericSymbol(e)&&h.Utils.isNumericSymbol(r)){e=e.multiplier;r=r.multiplier;var p=h.Utils.variables(a);if(1===p.length&&d===p[0]){var m=h.Utils.build(a);p=0;for(var f=e;f<=r;f++)p+=m.call(void 0,
f);p=new n(p)}else{m=a.text();var g={"~":!0};p=new h.Symbol(0);for(f=e;f<=r;f++)g[d]=new n(f),p=b.add(p,b.parse(m,g))}}else p=b.symfunction("sum",arguments);return p},product:function(a,d,e,r){if(d.group!==h.groups.S)throw Error("Index must be symbol. "+C(d)+" provided");d=d.value;if(h.Utils.isNumericSymbol(e)&&h.Utils.isNumericSymbol(r)){e=e.multiplier;r=r.multiplier;var p=a.text(),m={};var f=new h.Symbol(1);for(var g=e;g<=r;g++)m[d]=new n(g),f=b.multiply(f,b.parse(p,m))}else f=b.symfunction("product",
arguments);return f},diff:function(a,p,e){function r(b){if(b.value===w||b.contains(w,!0))b.multiplier=b.multiplier.multiply(b.power),b.power=b.power.subtract(new x(1)),b.power.equals(0)&&(b=n(b.multiplier));return b}function k(a){var c=a.group;if(c===ba||c===D&&a.value!==w||c===fa)a=n(0);else if(c===D)a=r(a);else{if(c===S){var e=a.multiplier.clone();a.toUnitMultiplier();a=b.multiply(f(a),r(a.clone()));a.multiplier=a.multiplier.multiply(e);return a}if(c===z&&a.power.equals(1))switch(a.fname){case "log":e=
a.clone();a=a.args[0].clone();a.power=a.power.negate();a.multiplier=e.multiplier.divide(a.multiplier);break;case "cos":a.fname="sin";a.multiplier.negate();break;case "sin":a.fname="cos";break;case "tan":a.fname="sec";a.power=new x(2);break;case "sec":a=m(a,"tan");break;case "csc":a=m(a,"-cot");break;case "cot":a.fname="csc";a.multiplier.negate();a.power=new x(2);break;case "asin":a=b.parse("(sqrt(1-("+C(a.args[0])+")^2))^(-1)");break;case "acos":a=b.parse("-(sqrt(1-("+C(a.args[0])+")^2))^(-1)");break;
case "atan":a=b.parse("(1+("+C(a.args[0])+")^2)^(-1)");break;case "abs":e=a.multiplier.clone();a.toUnitMultiplier();c=a.args[0].clone();c.toUnitMultiplier();a=b.parse(K(C(a.args[0]))+"/abs"+K(C(c)));a.multiplier=e;break;case "parens":a=n(1);break;case "cosh":a.fname="sinh";break;case "sinh":a.fname="cosh";break;case "tanh":a.fname="sech";a.power=new x(2);break;case "sech":a=m(a,"-tanh");break;case "asinh":a=b.parse("(sqrt(1+("+C(a.args[0])+")^2))^(-1)");break;case "acosh":a=b.parse("(sqrt(-1+("+C(a.args[0])+
")^2))^(-1)");break;case "atanh":a=b.parse("(1-("+C(a.args[0])+")^2)^(-1)");break;case "Si":a=a.args[0];a=b.parse("sin("+a+")/("+a+")");break;case "Shi":a=a.args[0];a=b.parse("sinh("+a+")/("+a+")");break;case "Ci":a=a.args[0];a=b.parse("cos("+a+")/("+a+")");break;case "Chi":a=a.args[0];a=b.parse("cosh("+a+")/("+a+")");break;case "Ei":a=a.args[0],a=b.parse("e^("+a+")/("+a+")")}else if(c===Q||c===z&&J(a.power))e=c===Q?a.value:c===z&&a.contains(w)?a.fname+K(C(a.args[0])):a.value+K(C(a.args[0])),b.multiply(b.parse("log"+
K(e)),a.power.clone()),c=d.diff(b.multiply(b.parse("log"+K(e)),a.power.clone()),w),a=b.multiply(a,c);else if(c===z&&!a.power.equals(1))c=a.clone(),c.toLinear(),c.toUnitMultiplier(),a=b.multiply(r(a.clone(),w),k(c));else if(c===P||c===W){c=new n(0);for(e in a.symbols)c=b.add(c,d.diff(a.symbols[e].clone(),w));a=b.multiply(r(a.clone()),c)}}a.updateHash();return a}function m(a,c,d){return b.multiply(a,b.parse(c+K(d||C(a.args[0]))))}function f(a){a=a.collectSymbols();for(var c=new n(0),e=a.length,f=0;f<
e;f++){for(var g=d.diff(a[f].clone(),w),h=0;h<e;h++)f!==h&&(g=b.multiply(g,a[h].clone()));c=b.add(c,g)}return c}if(h.Utils.isVector(a)){var g=new h.Vector([]);a.each(function(b){g.elements.push(d.diff(b,p))});return g}var w=J(p)?p.text():p;e=J(e)?e.multiplier:e||1;void 0===w&&(w=h.Utils.variables(a)[0]);if(a.group===z&&"sqrt"===a.fname){var c=a.args[0],O=a.power.clone();if(c.group!==ba||c.group!==fa)c.power=J(c.power)?b.multiply(c.power,b.multiply(new n(.5)),O):c.power.multiply(new x(.5)).multiply(O),
c.multiplier=c.multiplier.multiply(a.multiplier);a=c}a.group!==z||J(a.power)?a=k(a):(c=k(a),a=d.diff(a.args[0].clone(),w),a=b.multiply(c,a));1<e&&(e--,a=d.diff(a,p,e));return a},integration:{u_substitution:function(a,p){function e(a,c,e){a=e?e(a,c):b.divide(a.clone(),d.diff(c,p));return a.contains(p,!0)?null:a}function r(a,c){a=d.integrate(b.symfunction(a,[new n(g)]),g,0);a=a.sub(new n(g),c);a.updateHash();return a}var k=a[0].clone();a=a[1].clone();var m=k.group;var f=a.group;var g="__u__";if(m===
z&&f!==z){f=k.args[0];if(m=e(a,f.clone()))return b.multiply(m,r(k.fname,f));if(m=e(a,k))return d.integration.poly_integrate(k)}else if(f===z&&m!==z){if(f=a.args[0],m=e(k,f.clone()))return b.multiply(m,r(a.fname,f))}else if(m===z&&m===z){if((m=e(k.clone(),a.clone()))||(m=e(a.clone(),k.clone())))return b.multiply(d.integration.poly_integrate(a),m)}else{if(m===Q&&f!==Q){var w=k.power;m=e(a,w.clone());if(!m){f=d.integration.decompose_arg(w.clone(),p);var c=d.diff(f[2].clone(),p),c=d.integration.decompose_arg(c.clone(),
p);if(b.multiply(f[1],c[1]).power.equals(a.power))return a=b.divide(f[0].clone(),c[0].clone()),k=b.multiply(a.clone(),b.pow(new n(k.value),b.multiply(f[0],new n(g)))),k=b.multiply(k,new n(g)),d.integration.by_parts(k,g,0,{}).sub(g,f[1].clone())}k=d.integrate(k.sub(w.clone(),new n(g)),g,0);return b.multiply(k.sub(new n(g),w),m)}if(f===Q&&m!==Q)return w=a.power,m=e(k,w.clone()),k=d.integrate(a.sub(w,new n(g)),g,0),b.multiply(k.sub(new n(g),w),m);if(k.isComposite()||a.isComposite()){f=function(a,c){a=
h.Algebra.Factor.factor(a);c=h.Algebra.Factor.factor(d.diff(c,p));return b.divide(a,c)};w=k.isComposite()?k.clone().toLinear():k.clone();c=a.isComposite()?a.clone().toLinear():a.clone();if(m=e(w.clone(),c.clone(),f))return b.multiply(d.integration.poly_integrate(a),m);if(m=e(c.clone(),w.clone(),f))return b.multiply(d.integration.poly_integrate(k),m)}}},poly_integrate:function(a){var d=a.power.toString(),e=a.multiplier.toDecimal();a=a.toUnitMultiplier().toLinear();return-1===Number(d)?b.multiply(new n(e),
b.symfunction("log",[a])):b.parse(v("({0})*({1})^(({2})+1)/(({2})+1)",e,a,d))},stop:function(b){throw new u(b||"Stopping!");},partial_fraction:function(a,p,e,r){var k=new n(a.multiplier);if(J(a)){var m=a.getDenom().invert();var f=a.getNum()}else f=a[0],m=a[1];if(f.isConstant()){var g=m.clone().toLinear();var w=g.stripVar(p);w=b.subtract(g.clone(),w);if(w.group===D&&w.isLinear())return d.integration.poly_integrate(a);m.power.greaterThan(1)&&(m=b.expand(m))}a=h.Algebra.div(f,m.clone());w=new h.Matrix;
g=new h.Matrix;var c=a[1].toArray(p);f=a[1];var O=n.unwrapPARENS(h.Algebra.Factor.factor(m)),u=[],t=a[0].equals(0)?a[0]:d.integrate(a[0],p,e||0);if(O.group!==P)O.each(function(a){a=n.unwrapPARENS(a);a.power.lessThan(0)&&a.invert();a.isConstant()?k=b.multiply(k,a):u.push(a)});else return a[1].isComposite()?a[1].each(function(a){a=b.divide(a.clone(),O.clone());t=b.add(t,d.integrate(a,p,e||0))}):(g=O.clone().toLinear(),c=d.integration.decompose_arg(g,p),f=c[1],w=c[0],c=c[3],f.isLinear()||d.integration.stop(),
O.power.greaterThan(0)?(t=a[1].isConstant()?d.integration.poly_integrate(b.divide(a[1],O)):b.add(d.integrate(b.divide(g.clone(),O.clone()),p,e||0),d.integrate(b.divide(c.negate(),O.clone()),p,e||0)),t=b.divide(t,w)):t=d.integration.by_parts(b.divide(a[1],O.clone()),p,h.Settings.integration_depth,r)),t;r=u.length;if(1===r)return a=b.divide(a[1],u[0]),a=d.integrate(a,p,e||0),a=b.divide(a,k),t=b.add(t,a);for(f=0;f<r;f++){m=new n(1);for(var v=0;v<r;v++)f!==v&&(m=b.multiply(m,u[v].clone()));m=b.expand(m).toArray(p);
v=c[f];g.elements[f]=v?[v]:[n(0)];w.elements[f]=m}w=w.transpose().invert().multiply(g);for(f=0;f<r;f++)g=d.integrate(b.divide(a[1].clone(),u[f]),p,e||0),c=b.expand(w.elements[f][0]),c=b.divide(c,k.clone()),t=b.add(t,b.multiply(g,c));return t},get_udv:function(a){var p=[[],[],[],[],[]],e=function(b){var a=b.group;a===z?(a=b.fname,h.Utils.in_trig(a)||h.Utils.in_htrig(a)?p[3].push(b):h.Utils.in_inverse_trig(a)?p[1].push(b):"log"===a?p[0].push(b):d.integration.stop()):a===D||b.isComposite()&&b.isLinear()||
a===S&&b.isLinear()?p[2].push(b):a===Q||b.isComposite()&&!b.isLinear()?p[4].push(b):d.integration.stop()};a.group===S?a.each(function(b){e(n.unwrapSQRT(b,!0))}):e(a);for(var r,k=new n(1),m=0;5>m;m++){var f=p[m],g=f.length;if(0<g){if(1<g){var w=new n(1);for(var c=0;c<g;c++)w=b.multiply(w,f[c].clone())}else w=f[0].clone();r?k=b.multiply(k,w):(r=w,r.multiplier=r.multiplier.multiply(a.multiplier))}}return[r,k]},by_parts:function(a,p,e,r){r.previous=r.previous||[];a=d.integration.get_udv(a);var k=a[0];
var m=a[1];var f=n.unwrapSQRT(b.expand(d.diff(k.clone(),p)),!0);a=f.clone().stripVar(p);f=b.divide(f,a.clone());var g=d.integrate(m.clone(),p,e||0);f=b.multiply(g.clone(),f);var w=f.toString();if(-1!==r.previous.indexOf(w)&&h.Utils.in_trig(k.fname)&&m.isE())return r.is_cyclic=!0,new n(1);r.previous.push(w);k=b.multiply(k,g);m=f.multiplier.clone();f.toUnitMultiplier();e=b.multiply(d.integrate(f.clone(),p,e,r),a);e.multiplier=e.multiplier.multiply(m);e=b.subtract(k,e);if(r.is_cyclic&&(r.previous.pop(),
0===r.previous.length)){e=b.expand(e);var c=new n(0);e.each(function(a){a.contains(p)||(c=b.add(c,a.clone()))});e=b.divide(b.subtract(e,c.clone()),b.subtract(new n(1),c))}return e},decompose_arg:function(a,d){if(a.group===P){var e=b.expand(a.clone()).stripVar(d);a=b.subtract(a.clone(),e.clone())}else a=a.clone();d=a.stripVar(d);var h=b.divide(a.clone(),d.clone());return[d,h,a,e]}},integrate:function(a,p,e,r){if(!p){var k=h.Utils.variables(a);1===k.length&&(p=k[0])}if(h.Utils.isVector(a)){var m=new h.Vector([]);
a.each(function(b){m.elements.push(d.integrate(b,p))});return m}isNaN(p)||b.error("variable expected but received "+p);r=r||{};return h.Utils.block("PARSE2NUMBER",function(){e=e||0;var f=J(p)?p.toString():p,g=n.unwrapSQRT(a.clone(),!0),m=g.group;try{++e>h.Settings.integration_depth&&d.integration.stop("Maximum depth reached. Exiting!");if(!g.contains(f,!0))var c=b.multiply(g.clone(),b.parse(f));else if(m===D)c=d.integration.poly_integrate(g,f,e);else if(m===Q)if(g.contains(f)&&g.previousGroup!==z)g.power.contains(f)?
d.integration.stop():c=d.integration.poly_integrate(g,f,e);else{var k=d.diff(g.power.clone(),f);if(k.contains(f)){var C=k.stripVar(f);var t=b.divide(k.clone(),C.clone());if(t.group===D&&t.isLinear())return C.multiplier=C.multiplier.divide(new x(2)),b.parse(v("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",C,f,g.multiplier));d.integration.stop()}if(g.isE())c=g;else{var K=b.symfunction("log",[b.parse(g.value)]);c=b.divide(g,K)}c=b.divide(c,k)}else if(g.isComposite()&&g.isLinear())c=new n(0),g.each(function(a){c=
b.add(c,d.integrate(a,f,e))});else if(m===P)if(g.power.greaterThan(1)&&(g=b.expand(g)),g.power.equals(1))c=new n(0),g.each(function(a){c=b.add(c,d.integrate(a,f,e))},!0);else{var E=Number(g.power);var Z=g.multiplier.clone();g.toUnitMultiplier();var ha=g.clone().toLinear();var F=d.integration.decompose_arg(ha,f);var I=F[3];var ba=F[2];k=F[0];t=F[1];if(-1===E&&t.group!==W)if(t.group===D&&t.power.equals(2)){var R=function(a){var c=new n(1);a.each(function(a){c=b.multiply(c,"abs"===a.fname?a.args[0]:
a)});return c},pa=k.clone(),qa=I.clone(),pa=b.pow(pa,new n(.5)),qa=b.pow(qa,new n(.5));K=b.multiply(R(qa),R(pa));var fa=b.symfunction("atan",[b.divide(b.multiply(k,t.toLinear()),K.clone())]);c=b.divide(fa,K)}else c=t.group===D&&t.isLinear()?b.divide(d.integration.poly_integrate(g),k):d.integration.partial_fraction(g,f,e);else if(-.5===E)if(t.group===D&&t.power.equals(2))if(ba.multiplier.lessThan(0)&&!I.multiplier.lessThan(0))if(k.negate(),I.isConstant()&&k.isConstant()){K=b.symfunction("sqrt",[k.clone()]);
var ga=b.symfunction("sqrt",[b.multiply(k.clone(),I)]);c=b.divide(b.symfunction("asin",[b.divide(ba.toLinear(),ga)]),K)}else{var ca=b.symfunction("sqrt",[k]),oa=b.multiply(ca.clone(),t.clone().toLinear());c=b.divide(b.symfunction("atan",[b.divide(oa,b.symfunction("sqrt",[ha.clone()]))]),ca)}else d.integration.stop();else d.integration.stop();else-2===E?d.integration.stop():c=t.isLinear()&&t.group!==W?b.divide(d.integration.poly_integrate(g),k):g.group===S||g.power.lessThan(0)?d.integration.partial_fraction(g,
f,e,r):d.integration.by_parts(g,f,e,r);c.multiplier=c.multiplier.multiply(Z)}else if(m===z){var y=g.args[0];Z=g.multiplier.clone();g.toUnitMultiplier();F=d.integration.decompose_arg(y,f);k=F[0];t=F[1];var A=g.fname;if("log"===A||"asin"===A||"acos"===A||"atan"===A&&t.isLinear())E=g.power.toString(),ma(E)&&(e-=E),c=d.integration.by_parts(g,f,e,r);else{if("tan"===A&&g.power.lessThan(0)){var T=g.clone();T.power.negate();T.fname="cot";return d.integrate(T,f,e)}if(!k.contains(f,!0)&&g.isLinear())if("abs"===
A)if(t=b.divide(y.clone(),k.clone()),t.group!==D||t.power.lessThan(0))d.integration.stop();else if(h.Utils.even(t.power))c=d.integrate(y,f,e);else{var ra=d.integrate(t,f,e);ra.power=ra.power.subtract(new x(1));c=b.multiply(b.multiply(b.symfunction("abs",[t.toLinear()]),ra),k)}else{var sa=g.args[0].group,Ka=d.integration.decompose_arg(y,f);(sa!==P&&sa!==D&&sa!==S||!Ka[1].power.equals(1)||y.hasFunc())&&d.integration.stop();switch(A){case "cos":c=b.symfunction("sin",[y]);break;case "sin":c=b.symfunction("cos",
[y]);c.negate();break;case "tan":c=b.parse(v("log(sec({0}))",y));break;case "sec":c=b.parse(v("log(tan({0})+sec({0}))",y));break;case "csc":c=b.parse(v("-log(csc({0})+cot({0}))",y));break;case "cot":c=b.parse(v("log(sin({0}))",y));break;case "sinh":c=b.symfunction("cosh",[y]);break;case "cosh":c=b.symfunction("sinh",[y]);break;case "tanh":c=b.parse(v("log(cosh({0}))",y));break;case "exp":c=d.integrate(b.parse(v("e^({0})",y)),f,e);break;case "erf":y=g.args[0].clone();var U=d.integration.decompose_arg(y,
f);var ta=U[1];var ua=U[0];c=b.parse(v("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",ua,ta,y));break;default:d.integration.stop()}c=b.divide(c,k)}else if(t.isLinear())if("cos"===A||"sin"===A)if(E=Number(g.power),0>E)g.fname="sin"===A?"csc":"sec",g.invert().updateHash(),c=d.integrate(g,f,e);else{y=g.args[0];var va=g.clone(),wa=g.clone(),La=new n((E-1)/E),Ma=b.multiply(k.clone(),new n(E)).invert();va.power=va.power.subtract(new x(1));wa.power=wa.power.subtract(new x(2));var B=b.symfunction("cos"===
A?"sin":"cos",[y.clone()]);"sin"===A&&B.negate();c=b.add(b.multiply(b.multiply(Ma,va),B),b.multiply(La,d.integrate(b.parse(wa),f,e)))}else if("tan"===A||"cot"===A){if(g.args[0].isLinear(f)){var X=g.power.subtract(new x(1)).toString();var G=g.clone().toUnitMultiplier();var xa=b.parse(v(("cot"===A?"-":"")+"1/({2}*{0})*{3}({1})^({0})",X,y,k,A));G.power=G.power.subtract(new x(2));G.power.equals(0)&&(G=b.parse(G));c=b.subtract(xa,d.integrate(G,f,e))}}else if("sec"===A||"csc"===A){var Fa=g.power.subtract(new x(1)).toString(),
Ga=g.power.subtract(new x(2)).toString(),R="sec"===A?"tan":"cot";G=g.clone().toUnitMultiplier();var Na=v(("csc"===A?"-":"")+"1/({0}*{1})*{4}({3})^({2})*{5}({3})",k,Fa,Ga,y,A,R);xa=b.parse(Na);G.power=G.power.subtract(new x(2));G.power.equals(0)&&(G=b.parse(G));c=b.add(xa,b.multiply(new n(Ga/Fa),d.integrate(G,f,e)))}else"cosh"!==A&&"sinh"!==A||!g.power.equals(2)?d.integration.stop():c=d.integrate(g.fnTransform(),f,e);else d.integration.stop();c.multiplier=c.multiplier.multiply(Z)}}else if(m===W)c=
d.integration.partial_fraction(g,f,e);else if(m===S){var R=g.stripVar(f),ya=b.divide(g.clone(),R.clone());if(ya.group!==S)c=d.integrate(ya,f,e);else{var H=ya.collectSymbols().sort(function(b,a){return b.group===a.group?Number(b.power)===Number(a.power)?b<a?1:-1:a.power-b.power:a.group-b.group}).map(function(a){a=n.unwrapSQRT(a,!0);return"exp"===a.fname?b.parse(v("({1})*e^({0})",a.args[0],a.multiplier)):a}),ja=H.length;if(2===ja){try{c=d.integration.u_substitution(H,f)}catch(ia){}if(!c){var Y=H[0].group,
aa=H[1].group,l=H[0],q=H[1],L=l.fname,M=q.fname,g=b.multiply(l.clone(),q.clone());if(Y===z&&aa===z)if("log"===L||"log"===M)c=d.integration.by_parts(g.clone(),f,e,r);else{H.sort(function(b,a){return a.fname>b.fname});var V=l.args[0];(!V.isLinear()||V.group!==P&&V.group!==S&&V.group!==D)&&d.integration.stop();F=d.integration.decompose_arg(V,f);t=F[1];k=F[0];t.isLinear()||d.integration.stop();if(V.equals(q.args[0]))if("sin"===L&&"cos"===M||"cos"===L&&"sin"===M)if(l.power.lessThan(0)&&d.integration.stop(),
"sin"===L&&l.power.add(q.power).equals(0))l.fname="tan",l.updateHash(),c=d.integrate(l,f,e);else if(na(l.power)&&"cos"===M&&q.power.lessThan(0)){X=Number(l.power)/2;var za=b.parse(v("(1-cos({0})^2)^({1})",l.args[0],X));c=d.integrate(b.expand(b.multiply(za,q.clone())),f,e,r)}else if(na(l.power)&&"sin"===M&&q.power.lessThan(0))X=Number(l.power)/2,za=b.parse(v("(1-sin({0})^2)^({1})",l.args[0],X)),c=d.integrate(b.expand(b.multiply(za,q.clone())),f,e,r);else{var Ha=h.Utils.even(l.power),Oa=h.Utils.even(q.power);
c=new n(0);if(Ha&&Oa)return Z=function(a){var c=a.power/2;return b.parse("cos"===a.fname?"((1/2)+(cos(2*("+a.args[0]+"))/2))^"+c:"((1/2)-(cos(2*("+a.args[0]+"))/2))^"+c)},k=Z(l),I=Z(q),B=b.multiply(k,I),T=b.expand(B),T.each(function(a){c=b.add(c,d.integrate(a,f,e))}),b.multiply(c,R);if(Ha){var N=l;G=q}else N=q,G=l;var Pa="cos"===N.fname?-1:1;X=G.power;k=(X-1)/2;var Qa=b.parse("(1-"+N.fname+h.Utils.inBrackets(V)+"^2)^"+k);T=b.expand(b.multiply(new n(Pa),b.multiply(N.clone(),Qa)));T.each(function(a){c=
b.add(c,d.integration.poly_integrate(a.clone()))})}else"sec"===L&&"tan"===M&&t.isLinear()&&q.isLinear()?c=b.parse(v("sec({0})^({1})/({1})",l.args[0],l.power)):"tan"===L&&"sec"===M&&t.isLinear()?l.isLinear()&&q.isLinear()?c=b.divide(b.symfunction("sec",[V.clone()]),k):na(l.power)?(E=Number(l.power)/2,B=b.parse(v("(sec({0})^2-1)^({1})",l.args[0],E)),c=d.integrate(b.expand(b.multiply(B,q)),f,e)):d.integration.stop():"sec"===L&&"cos"===M?(l.fname="cos",l.invert().updateHash(),c=d.integrate(b.multiply(l,
q),f,e)):"sin"===L&&"csc"===M?(q.fname="sin",q.invert().updateHash(),c=d.integrate(b.multiply(l,q),f,e)):(B="tan"!==L||"cos"!==M&&"sin"!==M||!q.power.lessThan(0)?b.multiply(l.fnTransform(),q.fnTransform()):b.multiply(l.fnTransform(),q),c=d.integrate(b.expand(B),f,e));else if("sin"!==L&&"cos"!==L||"sin"!==M&&"cos"!==M)d.integration.stop();else{var Aa=Ea(H);c=d.integrate(b.expand(Aa),f,e)}}else if(Y===z&&aa===D){var ka=l.isLinear();"cos"===l.fname&&ka&&q.power.equals(-1)?c=b.symfunction("Ci",[l.args[0]]):
"cos"===l.fname&&q.power.equals(-1)?c=d.integrate(b.multiply(l.fnTransform(),q.clone()),f,e):"cosh"===l.fname&&ka&&q.power.equals(-1)?c=b.symfunction("Chi",[l.args[0]]):"cosh"===l.fname&&q.power.equals(-1)?c=d.integrate(b.multiply(l.fnTransform(),q.clone()),f,e):"sin"===l.fname&&ka&&q.power.equals(-1)?c=b.symfunction("Si",[l.args[0]]):"sin"===l.fname&&q.power.equals(-1)?c=d.integrate(b.multiply(l.fnTransform(),q.clone()),f,e):"sinh"===l.fname&&ka&&q.power.equals(-1)?c=b.symfunction("Shi",[l.args[0]]):
"sinh"===l.fname&&q.power.equals(-1)?c=d.integrate(b.multiply(l.fnTransform(),q.clone()),f,e):"log"===l.fname&&q.power.equals(-1)?c=d.integration.poly_integrate(l,f,e):"erf"===l.fname?q.power.equals(1)&&(U=d.integration.decompose_arg(l.args[0],f),ua=U[0],ta=U[1],y=l.args[0].toString(),c=b.parse(v("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",ua,ta,y))):c=d.integration.by_parts(g,f,e,r)}else if(Y===Q&&aa===D)t="log"===L?d.integration.decompose_arg(l.args[0],
f)[1]:null,c=l.isE()&&(l.power.group===D||l.power.group===S)&&q.power.equals(-1)?b.symfunction("Ei",[l.power.clone()]):"log"===L&&t.value===q.value?d.integration.poly_integrate(l,f,e):d.integration.by_parts(g,f,e,r);else if(Y===W&&aa===D){if(q.value===l.value&&l.power.equals(-1)){var Ra=Math.min.apply(null,h.Utils.keys(l.symbols)),Sa=Math.min(Ra,q.power),Ba=q.clone();Ba.power=new x(Sa);q=b.divide(q,Ba.clone());B=new n(0);l.each(function(a){B=b.add(B,b.divide(a.clone(),Ba.clone()))});B.multiplier=
l.multiplier;g=b.divide(q,B)}c=d.integration.partial_fraction(g,f,e)}else if(Y===P&&aa===D)if(l.power.equals(-.5)){if(F=d.integration.decompose_arg(l.clone().toLinear(),f),k=F[0].negate(),t=F[1],I=F[3],E=Number(q.power),ma(E)&&h.Utils.even(E)&&t.power.equals(2)){var da=b.divide(b.multiply(b.pow(I.clone(),new n(2)),b.symfunction("sqrt",[b.divide(I.clone(),k.clone())])),b.pow(k.clone(),new n(2)));da=b.multiply(da,b.symfunction("sqrt",[I]).invert());var Ca=b.parse("sin(u)");Ca.power=Ca.power.multiply(q.power);
var Da=d.integrate(Ca,"u",e);var Ta=b.parse("asin(sqrt("+k+"/"+I+")*"+f+")");c=b.multiply(da,Da.sub(new n("u"),Ta))}}else if(l.power.equals(-1)&&q.isLinear())c=d.integration.partial_fraction(g,f,e);else if(!l.power.lessThan(0)&&ma(l.power)){var Ua=b.expand(l);c=new n(0);Ua.each(function(a){a.group===W?a.each(function(a){c=b.add(c,d.integrate(b.multiply(q.clone(),a),f,e))}):c=b.add(c,d.integrate(b.multiply(q.clone(),a),f,e))})}else if(l.power.lessThan(-2))c=d.integration.by_parts(g,f,e,r);else if(l.power.lessThan(0)&&
q.power.greaterThan(1))if(F=d.integration.decompose_arg(l.clone().toLinear(),f),k=F[0].negate(),t=F[1],I=F[3],ha=l.clone().toLinear(),t.group!==W&&t.isLinear()){E=Number(q.power);var la="_u_";N=new n(la);var Va=b.expand(b.divide(b.pow(b.subtract(N.clone(),I.clone()),new n(E)),N.clone()));k={};k[la]=ha;var Wa=b.parse(Va,k);c=d.integrate(Wa,f,0)}else if(q.power.greaterThan(t.power)||q.power.equals(t.power)){var Ia=new h.Algebra.Classes.Factors,l=h.Algebra.Factor.coeffFactor(l.invert(),Ia);c=new n(0);
h.Algebra.divide(q,l).each(function(a){c=b.add(c,d.integrate(a,f,e))});Ia.each(function(a){c=b.divide(c,a)});c=b.expand(c)}else c=d.integration.partial_fraction(g,f,e);else if(l.power.den.equals(2)){if(U=d.integration.decompose_arg(l.clone().toLinear(),f),k=U[3],t=U[1],I=U[0],t.power.equals(2)&&I.lessThan(0)){k.equals(1)||(R=b.multiply(R,b.pow(k,new n(2))));N=f;da=b.divide(b.pow(I.clone().negate(),new n(.5)),b.pow(k,new n(.5)));la=b.symfunction("cos",[new n(N)]);var Xa=b.pow(b.symfunction("cos",[new n(N)]),
new n(l.power.num)),Ya=b.pow(b.symfunction("sin",[new n(N)]),new n(q.power)),Za=b.multiply(b.multiply(Xa,la),Ya);Da=d.integrate(Za,N,e);c=Da.sub(N,b.symfunction("asin",[b.multiply(new n(f),da)]))}}else c=d.integration.partial_fraction(g,f,e);else if(l.isComposite()&&q.isComposite())if(c=new n(0),l.power.greaterThan(0)&&q.power.greaterThan(0))T=b.expand(g),T.each(function(a){c=b.add(c,d.integrate(a,f,e))},!0);else{var $a=Number(q.power);0>Number(l.power)&&0<$a&&(B=l,l=q,q=B);l.each(function(a){c=b.add(c,
d.integrate(b.multiply(a,q.clone()),f,e))})}else Y===P?(l=b.expand(l),c=new n(0),l.each(function(a){c=b.add(c,d.integrate(b.multiply(a,q.clone()),f,e))},!0)):Y===z&&aa===Q&&h.Utils.in_htrig(l.fname)?(l=l.fnTransform(),c=d.integrate(b.expand(b.multiply(l,q)),f,e)):c=d.integration.by_parts(g,f,e,r)}}else if(3===ja&&(H[2].group===D&&H[2].power.lessThan(2)||H[0].group===P)){var ea=H[0];ea.group===P?(ea.power.greaterThan(1)&&(ea=b.expand(ea)),G=b.multiply(H[1],H[2]),c=new n(0),ea.each(function(a){a=b.multiply(a,
G.clone());a=d.integrate(a,f,e);c=b.add(c,a)},!0)):c=d.integration.by_parts(g,f,e,r)}else if(Ja(H)){B=new n(1);k=0;for(ja=H.length;k<ja;k++)B=b.multiply(B,H[k].fnTransform());B=b.expand(B);c=d.integrate(B,f,e)}else Aa=Ea(H),c=d.integrate(b.expand(Aa),f,e)}c=b.multiply(c,R)}if(c)return c}catch(ia){if(!(ia instanceof u||ia instanceof h.exceptions.DivisionByZero))throw ia;}return b.symfunction("integrate",[a,p])},!1)},defint:function(a,p,e,n){var k=h.Utils.variables(a),m=d.integrate(a,n);1===k.length&&
(n=k[0]);m.hasIntegral()?1===k.length&&p.isConstant()&&e.isConstant()?(m=h.Utils.build(a),p=h.Math2.num_integrate(m,Number(p),Number(e))):p=b.symfunction("defint",[a,p,e,n]):(k={},a={},k[n]=e,a[n]=p,p=b.parse(m,k),e=b.parse(m,a),p=b.subtract(p,e));return p}};nerdamer.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return d.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return d.sum}},{name:"product",visible:!0,numargs:4,build:function(){return d.product}},{name:"integrate",
visible:!0,numargs:[1,2],build:function(){return d.integrate}},{name:"defint",visible:!0,numargs:[3,4],build:function(){return d.defint}}]);nerdamer.api()})();
