var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(h,w,m){h!=Array.prototype&&h!=Object.prototype&&(h[w]=m.value)};$jscomp.getGlobal=function(h){return"undefined"!=typeof window&&window===h?h:"undefined"!=typeof global&&null!=global?global:h};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(h){return $jscomp.SYMBOL_PREFIX+(h||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.iterator;h||(h=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[h]&&$jscomp.defineProperty(Array.prototype,h,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(h){var w=0;return $jscomp.iteratorPrototype(function(){return w<h.length?{done:!1,value:h[w++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(h){$jscomp.initSymbolIterator();h={next:h};h[$jscomp.global.Symbol.iterator]=function(){return this};return h};$jscomp.iteratorFromArray=function(h,w){$jscomp.initSymbolIterator();h instanceof String&&(h+="");var m=0,g={next:function(){if(m<h.length){var k=m++;return{value:w(k,h[k]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill=function(h,w,m,g){if(w){m=$jscomp.global;h=h.split(".");for(g=0;g<h.length-1;g++){var k=h[g];k in m||(m[k]={});m=m[k]}h=h[h.length-1];g=m[h];w=w(g);w!=g&&null!=w&&$jscomp.defineProperty(m,h,{configurable:!0,writable:!0,value:w})}};$jscomp.polyfill("Array.prototype.keys",function(h){return h?h:function(){return $jscomp.iteratorFromArray(this,function(h){return h})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(h){return h?h:function(h,m,g){var k=this.length||0;0>m&&(m=Math.max(0,k+m));if(null==g||g>k)g=k;g=Number(g);0>g&&(g=Math.max(0,k+g));for(m=Number(m||0);m<g;m++)this[m]=h;return this}},"es6-impl","es3");$jscomp.polyfill("Math.sign",function(h){return h?h:function(h){h=Number(h);return 0===h||isNaN(h)?h:0<h?1:-1}},"es6-impl","es3");"undefined"!==typeof module&&(nerdamer=require("./nerdamer.core.js"),require("./Calculus.js"));
(function(){function h(a,b,c){if(g.Utils.isSymbol(a))this.parse(a);else if(isNaN(a))"string"===typeof a&&this.parse(k.parse(a));else{if(void 0===b)throw Error("Polynomial expects a variable name when creating using order");this.coeffs=[];this.coeffs[c||0]=a;this.fill(a)}}function w(){this.factors={}}function m(a,b,c){this.terms=b||[];this.coeff=a;this.map=c;this.sum=new g.Frac(0);this.image=void 0}var g=nerdamer.getCore(),k=g.PARSER,Aa=g.groups.N,Za=g.groups.P,B=g.groups.S,Ma=g.groups.EX,H=g.groups.FN,
J=g.groups.PL,K=g.groups.CP,I=g.groups.CB,L=g.Utils.keys,S=g.Utils.variables,Na=g.Utils.round,r=g.Frac,la=g.Utils.isInt,u=g.Symbol,Oa=g.Settings.CONST_HASH;h.fromArray=function(a,b){if("undefined"===typeof b)throw Error("A variable name must be specified when creating polynomial from array");var c=new h;c.coeffs=a;c.variable=b;return c};h.fit=function(a,b,c,d,f,e){var g=Array(f+1);g[0]=b;g[f]=a;a=c-b-a*Math.pow(d,f);for(--f;0<f;f--)b=Math.pow(d,f),c=a/b,c=Math.sign(c)*Math.floor(Math.abs(c)),a-=c*
b,g[f]=c;if(0!==a)return null;for(f=0;f<g.length;f++)g[f]=new r(g[f]);return h.fromArray(g,e)};h.prototype={parse:function(a,b){this.variable=S(a)[0];if(!a.isPoly())throw Error("Polynomial Expected! Received "+g.Utils.text(a));b=b||[];a.power.absEquals(1)||(a=k.expand(a));if(a.group===g.groups.N)b[0]=a.multiplier;else if(a.group===g.groups.S)b[a.power.toDecimal()]=a.multiplier;else for(var c in a.symbols){var d=a.symbols[c],f=d.power;if(g.Utils.isSymbol(f))throw Error("power cannot be a Symbol");
f=d.group===Aa?0:f.toDecimal();d.symbols?this.parse(d,b):b[f]=d.multiplier}this.coeffs=b;this.fill()},fill:function(a){a=Number(a)||0;for(var b=this.coeffs.length,c=0;c<b;c++)void 0===this.coeffs[c]&&(this.coeffs[c]=new r(a));return this},trim:function(){for(var a=this.coeffs.length;a--;){var b=this.coeffs[a],c=b.equals(0);if(b&&c){if(0===a)break;this.coeffs.pop()}else break}return this},modP:function(a){for(var b=this.coeffs.length,c=0;c<b;c++){var d=this.coeffs[c];if(0>d){for(var f,e=c;e<b;e++)if(0<
this.coeffs[e]){f=this.coeffs[e];break}if(f){for(e;e>c;e--)this.coeffs[e]=this.coeffs[e].subtract(new r(1)),this.coeffs[e-1]=this.coeffs[e-1].add(new r(a));d=this.coeffs[c]}}e=d.mod(a);d=d.subtract(e).divide(a);if(!d.equals(0)){var g=c+1,h=this.coeffs[g]||new r(0),h=h.add(d);this.coeffs[g]=new r(h);this.coeffs[c]=new r(e)}}return this},add:function(a){for(var b=Math.max(this.coeffs.length,a.coeffs.length),c=0;c<b;c++){var d=this.coeffs[c]||new r(0),f=a.coeffs[c]||new r(0);this.coeffs[c]=d.add(f)}return this},
subtract:function(a){for(var b=Math.max(this.coeffs.length,a.coeffs.length),c=0;c<b;c++){var d=this.coeffs[c]||new r(0),f=a.coeffs[c]||new r(0);this.coeffs[c]=d.subtract(f)}return this},divide:function(a){var b=this.variable,c=g.Utils.arrayClone(this.coeffs),d=g.Utils.arrayClone(a.coeffs),f=c.length,e=d.length-1;a=[];for(var z=0;z<f;z++){var k=f-(z+1),v=k-e,k=c[k].divide(d[e]);if(0>v)break;a[v]=k;for(var l=0;l<=e;l++)c[l+v]=c[l+v].subtract(d[l].multiply(k))}c=h.fromArray(c,b||"x").trim();return[h.fromArray(a,
b||"x"),c]},multiply:function(a){for(var b=this.coeffs.length,c=a.coeffs.length,d=[],f=0;f<b;f++)for(var e=this.coeffs[f],g=0;g<c;g++){var h=f+g,k=a.coeffs[g],l=d[h]||new r(0);d[h]=l.add(e.multiply(k))}this.coeffs=d;return this},isZero:function(){for(var a=this.coeffs.length,b=0;b<a;b++)if(!this.coeffs[b].equals(0))return!1;return!0},sub:function(a){for(var b=new r(0),c=this.coeffs.length,d=0;d<c;d++){var f=this.coeffs[d];f.equals(0)||(b=b.add(f.multiply(new r(Math.pow(a,d)))))}return b},clone:function(){var a=
new h;a.coeffs=this.coeffs;a.variable=this.variable;return a},deg:function(){this.trim();return this.coeffs.length-1},lc:function(){return this.coeffs[this.deg()].clone()},monic:function(){for(var a=this.lc(),b=this.coeffs.length,c=0;c<b;c++)this.coeffs[c]=this.coeffs[c].divide(a);return this},gcd:function(a){var b;if(this.coeffs.length-1<a.coeffs.length-1)return a.gcd(this);for(b=this;!a.isZero();){var c=a.clone();b=b.clone();b=b.divide(c);a=b[1];b=c}c=g.Math2.QGCD.apply(null,b.coeffs);if(!c.equals(1)){a=
b.coeffs.length;for(var d=0;d<a;d++)b.coeffs[d]=b.coeffs[d].divide(c)}return b},diff:function(){for(var a=[],b=this.coeffs.length,c=1;c<b;c++)a.push(this.coeffs[c].multiply(new r(c)));this.coeffs=a;return this},integrate:function(){for(var a=[0],b=this.coeffs.length,c=0;c<b;c++){var d=new r(c+1);a[d]=this.coeffs[c].divide(d)}this.coeffs=a;return this},gcf:function(a){for(var b=[],c=0;c<this.coeffs.length;c++){var d=this.coeffs[c];d.equals(0)||-1!==b.indexOf(d)||b.push(d)}b=[g.Math2.QGCD.apply(void 0,
b),function(a){for(var b=0;b<a.length;b++)if(!a[b].equals(0))return b}(this.coeffs)].toDecimal();a&&(a=[],a[b[1]-1]=b[0],b=h.fromArray(a,this.variable).fill());return b},quad:function(a){var b=[];if(3<this.coeffs.length)throw Error("Cannot calculate quadratic order of "+(this.coeffs.length-1));if(0===this.coeffs.length)throw Error("Polynomial array has no terms");var c=this.coeffs[2]||0,d=this.coeffs[1]||0,f=d*d-4*c*this.coeffs[0];0>f&&!a||(b[0]=(-d+Math.sqrt(f))/(2*c),b[1]=(-d-Math.sqrt(f))/(2*c));
return b},squareFree:function(){for(var a=this.clone(),b=1,c=a.clone().diff(),c=a.clone().gcd(c),d=a.divide(c)[0],a=h.fromArray([new r(1)],a.variable);!c.equalsNumber(1);){var f=d.gcd(c),d=d.divide(f)[0];if(!d.equalsNumber(1)&&1<b){for(var e=d.clone(),g=1;g<b;g++)e.multiply(d.clone());d=e}a=a.multiply(d);b++;d=f;c=c.divide(f)[0]}return[a,d,b]},toSymbol:function(){var a=this.coeffs.length,b=this.variable;if(0===a)return new g.Symbol(0);for(var c=a-1,d="",f=0;f<a;f++){var e=f===c?"":"+",h=this.coeffs[f];
h.equals(0)||(d+=h+"*"+b+"^"+f+e)}return k.parse(d)},equalsNumber:function(a){this.trim();return 1===this.coeffs.length&&this.coeffs[0].toDecimal()===a},toString:function(){return this.toSymbol().toString()}};u.prototype.coeffs=function(a,b){b&&!this.isPoly(!0)&&k.error("Polynomial expected when requesting coefficients with order");a=a||[];var c=this.clone().distributeMultiplier();if(c.isComposite())for(var d in c.symbols){var f=c.symbols[d];f.isComposite()?f.clone().distributeMultiplier().coeffs(a,
b):b?a[f.isConstant()?0:f.power.toDecimal()]=f.multiplier:a.push(f.multiplier)}else b?a[c.isConstant()?0:c.power.toDecimal()]=c.multiplier:a.push(c.multiplier);if(b)for(b=0;b<a.length;b++)void 0===a[b]&&(a[b]=new r(0));return a};u.prototype.tBase=function(a){if("undefined"===typeof a)throw Error("Symbol.tBase requires a map object!");for(var b=[],c=this.collectSymbols(null,null,null,!0),d=c.length,f=0;f<d;f++){var e=c[f],g=e.group,h=new m(e.multiplier,[],a);if(g===I)for(var k in e.symbols)h.terms[a[k]]=
e.symbols[k].power;else h.terms[a[e.value]]=e.power;b.push(h.fill());h.updateCount()}return b};u.prototype.altVar=function(a){var b=this.multiplier.toString(),c=this.power.toString();return("1"===b?"":b+"*")+a+("1"===c?"":"^"+c)};u.prototype.sameVars=function(a){if(!this.symbols&&this.group!==a.group)return!1;for(var b in this.symbols){var c=a.symbols[b];if(!c||this.symbols[b].value!==c.value)return!1}return!0};w.prototype.add=function(a){if(a.equals(0))return this;if(a.group===I){var b=this;a.multiplier.equals(1)||
b.add(new u(a.multiplier));a.each(function(a){b.add(a)})}else{this.preAdd&&(a=this.preAdd(a));this.pFactor&&(a=k.pow(a,new u(this.pFactor)));var c=a.isConstant();if(c&&a.equals(1))return this;c=c?a.value:a.text();this.factors[c]=c in this.factors?k.multiply(this.factors[c],a):a}return this};w.prototype.toSymbol=function(){var a=new u(1),b;for(b in this.factors)var c=this.factors[b].power.equals(1)?k.symfunction(g.PARENTHESIS,[this.factors[b]]):this.factors[b],a=k.multiply(a,c);return a};w.prototype.merge=
function(a){for(var b in a)this.factors[b]=b in this.factors?k.multiply(this.factors[b],a[b]):a[b];return this};w.prototype.each=function(a){for(var b in this.factors){var c=this.factors[b];c.fname===g.PARENTHESIS&&c.isLinear()&&(c=c.args[0]);a.call(this,c,b)}return this};w.prototype.count=function(){return L(this.factors).length};w.prototype.toString=function(){return this.toSymbol().toString()};m.prototype.updateCount=function(){this.count=this.count||0;for(var a=0;a<this.terms.length;a++)this.terms[a].equals(0)||
this.count++;return this};m.prototype.getVars=function(){for(var a=[],b=0;b<this.terms.length;b++){var c=this.terms[b];this.getRevMap();c.equals(0)||a.push(this.rev_map[b])}return a.join(" ")};m.prototype.len=function(){"undefined"===typeof this.count&&this.updateCount();return this.count};m.prototype.toSymbol=function(a){a=a||this.getRevMap();for(var b=new u(this.coeff),c=0;c<this.terms.length;c++){var d=a[c],f=this.terms[c];f.equals(0)||d===Oa||(d=new u(d),d.power=f,b=k.multiply(b,d))}return b};
m.prototype.getRevMap=function(){if(this.rev_map)return this.rev_map;var a={},b;for(b in this.map)a[this.map[b]]=b;return this.rev_map=a};m.prototype.generateImage=function(){this.image=this.terms.join(" ");return this};m.prototype.getImg=function(){this.image||this.generateImage();return this.image};m.prototype.fill=function(){for(var a=this.map.length,b=0;b<a;b++)"undefined"===typeof this.terms[b]?this.terms[b]=new g.Frac(0):this.sum=this.sum.add(this.terms[b]);return this};m.prototype.divide=function(a){for(var b=
this.coeff.divide(a.coeff),c=this.terms.length,b=new m(b,[],this.map),d=0;d<c;d++)b.terms[d]=this.terms[d].subtract(a.terms[d]),b.sum=b.sum.add(b.terms[d]);return b};m.prototype.multiply=function(a){for(var b=this.coeff.multiply(a.coeff),c=this.terms.length,b=new m(b,[],this.map),d=0;d<c;d++)b.terms[d]=this.terms[d].add(a.terms[d]),b.sum=b.sum.add(b.terms[d]);return b};m.prototype.isZero=function(){return this.coeff.equals(0)};m.prototype.toString=function(){return"{ coeff: "+this.coeff.toString()+
", terms: ["+this.terms.join(",")+"]: sum: "+this.sum.toString()+", count: "+this.count+"}"};g.Utils.toMapObj=function(a){for(var b=0,c={},d=0;d<a.length;d++){var f=a[d];"undefined"===typeof c[f]&&(c[f]=b,b++)}c.length=b;return c};g.Utils.filledArray=function(a,b,c){for(var d=[];b--;)d[b]=c?new c(a):a;return d};g.Utils.arrSum=function(a){for(var b=0,c=a.length,d=0;d<c;d++)b+=a[d];return b};g.Utils.subFunctions=function(a,b){b=b||{};var c=[];a.each(function(a){if(a.group===H||a.previousGroup===H){var d=
g.Utils.text(a,"hash"),e=b[d];e||(e=a.fname+L(b).length,b[d]=e);c.push(a.altVar(e))}else a.group===I||a.group===J||a.group===K?c.push(g.Utils.subFunctions(a,b)):c.push(a.text())});return a.group===K||a.group===J?a.altVar(g.Utils.inBrackets(c.join("+"))):a.group===I?a.altVar(g.Utils.inBrackets(c.join("*"))):a.text()};g.Utils.getFunctionsSubs=function(a){var b={},c;for(c in a)b[a[c]]=k.parse(c);return b};var n=g.Algebra={version:"1.4.2",init:void 0,proots:function(a,b){function c(a,c,d){function f(a,
b,c,d,f,e){f[0]=e.b=d[0];f[1]=e.a=-(b*e.b)+d[1];for(var g=2;g<a;g++)f[g]=-(b*e.a+c*e.b)+d[g],e.b=e.a,e.a=f[g]}function e(a,b,c,d,e,g,h,k,l){var F={},z=3;F.b=F.a=0;f(b,h,k,g,l,F);e.c=F.a;e.d=F.b;if(Math.abs(e.c)<=100*a*Math.abs(g[b-1])&&Math.abs(e.d)<=100*a*Math.abs(g[b-2]))return z;e.h=k*d;Math.abs(e.d)>=Math.abs(e.c)?(z=2,e.e=c/e.d,e.f=e.c/e.d,e.g=h*d,e.a3=e.e*(e.g+c)+d/e.d*e.h,e.a1=-c+e.f*d,e.a7=e.h+(e.f+h)*c):(z=1,e.e=c/e.c,e.f=e.d/e.c,e.g=e.e*h,e.a3=e.e*c+(e.g+e.h/e.c)*d,e.a1=-(e.d/e.c*c)+d,e.a7=
e.g*e.d+e.h*e.f+c);return z}function g(a,b,c,d,e,f,g,h,k){if(3==c)for(g[1]=g[0]=0,a=2;a<b;a++)g[a]=h[a-2];else if(Math.abs(f.a1)>10*a*Math.abs(1==c?e:d))for(f.a7/=f.a1,f.a3/=f.a1,g[0]=k[0],g[1]=-(k[0]*f.a7)+k[1],a=2;a<b;a++)g[a]=-(k[a-1]*f.a7)+h[a-2]*f.a3+k[a];else for(g[0]=0,g[1]=-(k[0]*f.a7),a=2;a<b;a++)g[a]=-(k[a-1]*f.a7)+h[a-2]*f.a3}function h(a,b,c,d,e,f,g,h,k,l,z,m,p,t,n,Y,M){b.b=b.a=0;3!=a&&(2!=a?(a=c+p*g+m*l,k=h+(p+t*l)*k):(a=(c+z)*l+m,k=(l+p)*h+t*k),h=-(n[Y-1]/M[Y]),n=-(n[Y-2]+h*M[Y-1])/
M[Y],Y=h*f,e*=h*h,M=-(Y+e)+t*n*d,a=-M+k+h*a,0!=a&&(b.a=-((p*(e+Y)+t*(h*d+n*f))/a)+p,b.b=t*(1+M/a)))}function k(a,b,c,d){d.sr=d.si=d.lr=d.li=0;if(0==a)d.sr=0!=b?-(c/b):d.sr;else if(0==c)d.lr=-(b/a);else{b/=2;if(Math.abs(b)<Math.abs(c)){var e=-(0<=c?a:-a)+b/Math.abs(c)*b;var f=Math.sqrt(Math.abs(e))*Math.sqrt(Math.abs(c))}else e=-(a/b*(c/b))+1,f=Math.sqrt(Math.abs(e))*Math.abs(b);0<=e?(d.lr=(-b+(0<=b?-f:f))/a,d.sr=0!=d.lr?c/d.lr/a:d.sr):(d.lr=d.sr=-(b/a),d.si=Math.abs(f/a),d.li=-d.si)}}c=a.slice(0);
a.unshift(d);if(100<d)throw Error("This utility accepts polynomials of degree up to 100. ");a=[];var z={};z.Degree=d;for(l=0;l<d;l++)a.push(0);d=a.slice(0);(function(a,b,c,d){var l=a.Degree,z=Math.LN2,m=a.Degree+1,p=Array(m),t=Array(m),Y=Array(m),n=Array(m),M={},F={},v,u,r;var x=1;do{var nb=x;x/=2;var w=1+x}while(1<w);var Fb=Number.MIN_VALUE/nb,E=Math.cos(1.6406094968746698),C=Math.sin(1.6406094968746698),Ba=Math.sqrt(.5),$a=-Ba;F.NZ=v=0;for(F.szr=F.szi=F.lzr=F.lzi=0;0==b[l];)c[v]=d[v]=0,l--,v++;
for(r=l+1;1<=l;){if(2>=l){2>l?(c[a.Degree-1]=-(b[1]/b[0]),d[a.Degree-1]=0):(M.li=M.lr=M.si=M.sr=0,k(b[0],b[1],b[2],M),c[a.Degree-2]=M.sr,d[a.Degree-2]=M.si,c[a.Degree-1]=M.lr,d[a.Degree-1]=M.li);break}var T=0;var ab=Number.MAX_VALUE;for(q=0;q<r;q++){var G=Math.abs(b[q]);G>T&&(T=G);0!=G&&G<ab&&(ab=G)}var B=Fb/ab;if(1>=B&&10<=T||1<B&&Number.MAX_VALUE/B>=T){B=0==B?Number.MIN_VALUE:B;var I=Math.floor(Math.log(B)/z+.5);var ob=Math.pow(2,I);if(1!=ob)for(q=0;q<r;q++)b[q]*=ob}for(var q=0;q<r;q++)t[q]=Math.abs(b[q]);
t[l]=-t[l];var W=l-1;G=Math.exp((Math.log(-t[l])-Math.log(t[0]))/l);if(0!=t[W]){var K=-t[l]/t[W];G=K<G?K:G}K=G;do{G=K;K=.1*G;var Z=t[0];for(q=1;q<r;q++)Z=Z*K+t[q]}while(0<Z);do{var L=Z=t[0];for(q=1;q<l;q++)Z=G*Z+t[q],L=G*L+Z;Z=G*Z+t[l];var S=Z/L;G-=S}while(.005<Math.abs(S/G));var H=G;for(q=1;q<l;q++)p[q]=(l-q)*b[q]/l;p[0]=b[0];x=b[l];w=b[W];var J=0==p[W]?1:0;for(u=0;5>u;u++){var Gb=p[W];if(J){for(q=0;q<W;q++)v=W-q,p[v]=p[v-1];p[0]=0;J=0==p[W]?1:0}else{var Hb=-x/Gb;for(q=0;q<W;q++)v=W-q,p[v]=Hb*p[v-
1]+b[v];p[0]=b[0];J=Math.abs(p[W])<=Math.abs(w)*nb*10?1:0}}for(q=0;q<l;q++)n[q]=p[q];for(u=1;20>=u;u++){var Aa=-(C*$a)+E*Ba;$a=C*Ba+E*$a;Ba=Aa;var la=H*Ba;var Ma=-(2*la);a:{var bb,cb,db,Pa,N,eb,ma,fb=void 0,gb=void 0,hb,na=nb,Na=20*u,Oa=la,ga=H,U=p,P=l,oa=b,Qa=r,Ca=Y,pa=Ma,Da=F,O={},D={},qa=Array(m),ib=Array(m),Ea=1;Da.NZ=0;var pb=hb=.25;var qb=Oa;var rb=ga;O.b=O.a=0;f(Qa,pa,ga,oa,Ca,O);var ra=O.a;var sa=O.b;D.h=D.g=D.f=D.e=D.d=D.c=D.a7=D.a3=D.a1=0;var Fa=e(na,P,ra,sa,D,U,pa,ga,qa);for(Pa=0;Pa<Na;Pa++){var sb=
1;g(na,P,Fa,ra,sa,D,U,qa,Ca);Fa=e(na,P,ra,sa,D,U,pa,ga,qa);h(Fa,O,ra,D.a1,D.a3,D.a7,sa,D.c,D.d,D.f,D.g,D.h,pa,ga,U,P,oa);var tb=O.a;var Ra=eb=O.b;var Ga=0!=U[P-1]?-(oa[P]/U[P-1]):0;var Ha=ma=1;if(0!=Pa&&3!=Fa){ma=0!=Ra?Math.abs((Ra-rb)/Ra):ma;Ha=0!=Ga?Math.abs((Ga-qb)/Ga):Ha;var ub=ma<fb?ma*fb:1;var vb=Ha<gb?Ha*gb:1;var jb=ub<pb?1:0;if((db=vb<hb?1:0)||jb){for(N=0;N<P;N++)ib[N]=U[N];var ta=Ga;for(cb=bb=0;;){if(!sb||0!=(sb=0)||!db||jb&&!(vb<ub)){var ua=void 0,ha=void 0,Sa=void 0,va=void 0,Q=void 0,
wb=void 0,X=void 0,Ta=void 0,ia=void 0,xb=void 0,Ua=void 0,ea=void 0,fa=na,ja=P,V=Da,Za=tb,Ib=eb,wa=Ca,yb=Qa,A=O,kb=oa,Ia=qa,R=D,xa=U,ca={},Va=0,zb=0;V.NZ=0;X=Za;Q=Ib;do{ca.li=ca.lr=ca.si=ca.sr=0;k(1,X,Q,ca);V.szr=ca.sr;V.szi=ca.si;V.lzr=ca.lr;V.lzi=ca.li;if(Math.abs(Math.abs(V.szr)-Math.abs(V.lzr))>.01*Math.abs(V.lzr))break;f(yb,X,Q,kb,wa,A);Ua=Math.abs(-(V.szr*A.b)+A.a)+Math.abs(V.szi*A.b);Sa=Math.sqrt(Math.abs(Q));ea=2*Math.abs(wa[0]);Ta=-(V.szr*A.b);for(ha=1;ha<ja;ha++)ea=ea*Sa+Math.abs(wa[ha]);
ea=ea*Sa+Math.abs(Ta+A.a);ea=(9*ea+2*Math.abs(Ta)-7*(Math.abs(A.a+Ta)+Sa*Math.abs(A.b)))*fa;if(Ua<=20*ea){V.NZ=2;break}Va++;if(20<Va)break;if(2<=Va&&.01>=ia&&Ua>=xb&&!zb){ia=ia<fa?Math.sqrt(fa):Math.sqrt(ia);X-=X*ia;Q+=Q*ia;f(yb,X,Q,kb,wa,A);for(ha=0;5>ha;ha++)ua=e(fa,ja,A.a,A.b,R,xa,X,Q,Ia),g(fa,ja,ua,A.a,A.b,R,xa,Ia,wa);zb=1;Va=0}xb=Ua;ua=e(fa,ja,A.a,A.b,R,xa,X,Q,Ia);g(fa,ja,ua,A.a,A.b,R,xa,Ia,wa);ua=e(fa,ja,A.a,A.b,R,xa,X,Q,Ia);h(ua,A,A.a,R.a1,R.a3,R.a7,A.b,R.c,R.d,R.f,R.g,R.h,X,Q,xa,ja,kb);wb=
A.a;va=A.b;0!=va&&(ia=Math.abs((-Q+va)/va),X=wb,Q=va)}while(0!=va);if(0<Da.NZ)break a;Ea=bb=1;pb*=.25;if(cb||!db)Ea=0;else for(N=0;N<P;N++)U[N]=ib[N]}if(0!=Ea){O.a=ta;var Wa=void 0,y=void 0,lb=void 0,ya=void 0,da=void 0,ka=void 0,Ab=void 0,Bb=void 0,Ja=void 0,aa=void 0,Xa=void 0,mb=na,Ka=Da,Jb=O,La=P,Cb=oa,Db=Qa,za=Ca,ba=U,Ya=qa,Eb=La-1;Ka.NZ=Wa=lb=0;for(da=Jb.a;;){ka=Cb[0];za[0]=ka;for(y=1;y<Db;y++)za[y]=ka=ka*da+Cb[y];Ja=Math.abs(ka);Bb=Math.abs(da);Xa=.5*Math.abs(za[0]);for(y=1;y<Db;y++)Xa=Xa*
Bb+Math.abs(za[y]);if(Ja<=20*mb*(2*Xa-Ja)){Ka.NZ=1;Ka.szr=da;Ka.szi=0;break}Wa++;if(10<Wa)break;if(2<=Wa&&Math.abs(ya)<=.001*Math.abs(-ya+da)&&Ja>Ab){lb=1;Ka.a=da;break}Ab=Ja;Ya[0]=aa=ba[0];for(y=1;y<La;y++)Ya[y]=aa=aa*da+ba[y];if(Math.abs(aa)>10*Math.abs(ba[Eb])*mb)for(ya=-(ka/aa),ba[0]=za[0],y=1;y<La;y++)ba[y]=ya*Ya[y-1]+za[y];else for(ba[0]=0,y=1;y<La;y++)ba[y]=Ya[y-1];aa=ba[0];for(y=1;y<La;y++)aa=aa*da+ba[y];ya=Math.abs(aa)>10*Math.abs(ba[Eb])*mb?-(ka/aa):0;da+=ya}Ea=lb;ta=O.a;if(0<Da.NZ)break a;
cb=1;hb*=.25;if(0!=Ea){tb=-(ta+ta);eb=ta*ta;continue}}for(N=0;N<P;N++)U[N]=ib[N];if(!jb||bb)break}f(Qa,pa,ga,oa,Ca,O);ra=O.a;sa=O.b;Fa=e(na,P,ra,sa,D,U,pa,ga,qa)}}rb=Ra;qb=Ga;fb=ma;gb=Ha}}if(0!=F.NZ){v=a.Degree-l;c[v]=F.szr;d[v]=F.szi;r-=F.NZ;l=r-1;for(q=0;q<r;q++)b[q]=Y[q];1!=F.NZ&&(c[v+1]=F.lzr,d[v+1]=F.lzi);break}else for(q=0;q<l;q++)p[q]=n[q]}if(20<u){a.Degree-=l;break}}})(z,c,d,a);c=a.length;for(l=0;l<c;l++){var z=Na(a[l],b+8),m=Na(d[l],b),m=2<b-String(m).length?m:d[l],p=0>z?"-":"";0===m&&(m=
"");0===z&&(z="");z=1===Math.abs(z)?p+"i":z?z+"*i":"";d[l]=(m&&z?m+"+"+z:m+z).replace(/\+\-/g,"-")}return d}b=b||7;var d=function(a,b,d){a=c(a,b,d);for(b=0;0>b;b++)a.unshift(0);return a};if(a instanceof u&&a.isPoly()){if(a.group===g.groups.S)return[0];if(a.group===g.groups.PL){var f=L(a.symbols);f=g.Utils.arrayMin(f);a=g.PARSER.divide(a,g.PARSER.parse(a.value+"^"+f))}f=L(a.symbols).sort().pop();var e=a.group===g.groups.PL?a.symbols:a.symbols[f],h=e.group;f=h===B?[e.power.toDecimal()]:L(e.symbols);
var k=[];var m=g.Utils.arrayMax(f);for(var l=1;l<=m;l++){var t=0;-1!==f.indexOf(l+"")&&(t=h===B?e.multiplier:e.symbols[l].multiplier);k.unshift(t)}k.push(a.symbols["#"].multiplier);e.group===B&&(k[0]=e.multiplier);return d(k,f,m)}if(g.Utils.isArray(a)){k=[];f=[];for(l=h=0;l<a.length;l++){m=a[l][0];e=a[l][1];h=e-h-1;for(t=0;t<h;t++)k.unshift(0);k.unshift(m);0!==e&&f.push(e);h=e}m=Math.max.apply(void 0,f);return d(k,f,m)}throw Error("Cannot calculate roots. Symbol must be a polynomial!");},roots:function(a){a=
n.proots(a).map(function(a){return k.parse(a)});return g.Vector.fromArray(a)},froot:function(a,b,c){b=Number(b);c=c?c:g.Utils.build(g.Calculus.diff(a.clone()));a=a instanceof Function?a:g.Utils.build(a);for(var d=!1,f=0;!d;){var e=b-a(b)/c(b),h=Math.abs(Math.abs(e)-Math.abs(b));b=e;1E-12>h?d=!0:1E4<f&&(b=null,d=!0);f++}return b},quad:function(a,b,c){var d=function(a,b,c,d){return k.parse("-("+b+"+"+d+"*sqrt(("+b+")^2-4*("+a+")*("+c+")))/(2*"+a+")")};return[d(a,b,c,1),d(a,b,c,-1)]},sumProd:function(a,
b){return n.quad(-b,a,-1).map(function(a){return a.invert()})},coeffs:function(a,b,c){b=String(b);a=k.expand(a);c=c||[];a.group===Ma&&a.contains(b,!0)&&k.error("Unable to get coefficients using expression "+a.toString());var d=S(a);if(1>=d.length&&d[0]===b)for(var f=(new h(a)).coeffs.map(function(a){return new u(a)}),e=0,g=f.length;e<g;e++)d=f[e],(a=c[e])&&(d=k.add(a,d)),c[e]=d;else b||k.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),-1===d.indexOf(b)?
c[0]=a:(c=c||[],a.group===I?((d=a.symbols[b])||k.error("Expression is not a polynomial!"),f=Number(d.power),d=k.divide(a.clone(),d.clone()),(d.contains(b,!0)||0>f||!la(f))&&k.error("Expression is not a polynomial!"),(a=c[f])&&(d=k.add(a,d)),c[f]=d):a.group===K&&a.each(function(a){n.coeffs(a.clone(),b,c)},!0));e=0;for(g=c.length;e<g;e++)"undefined"===typeof c[e]&&(c[e]=new u(0));return c},polyPowers:function(a,b,c){c=c||[];var d=d=a.group;if(d===J&&b===a.value)c=c.concat(L(a.symbols));else if(d===
K)for(var f in a.symbols){var e=a.symbols[f];d=e.group;var h=e.value;d===B&&b===h?c.push(e.power):d===J||d===K?c=n.polyPowers(e,b,c):d===I&&e.contains(b)?(d=e.symbols[b])&&c.push(d.power):d!==Aa&&b===h||c.push(0)}return g.Utils.arrayUnique(c).sort()},Factor:{mix:function(a,b){for(var c=L(a),d=c.length,f=[],e=0;e<d;e++){for(var g=c[e],h=a[g],k=f.length,l=0;l<k;l++){var m=f[l]*g;f.push(m);b&&f.push(-m)}for(l=1;l<=h;l++)f.push(Math.pow(g,l))}return f},common:function(a,b){try{if(a.group===K){for(var c=
k.expand(a.clone(),!0).collectSymbols(null,null,function(a,b){return(b.length||1)-(a.length||1)}),d={},f=[],e=0;e<c.length;e++){var h=c[e];f.push(h.multiplier.clone());h.each(function(a){var b=Number(a.power);if(isNaN(b))throw Error("exiting");a.value in d?(b<d[a.value][0]&&(d[a.value][0]=b),d[a.value][1].push(a)):d[a.value]=[b,[a]]})}var m=new u(1),v;for(v in d)d[v][1].length===c.length&&(m=k.multiply(m,k.pow(new u(v),new u(d[v][0]))));var l=g.Math2.QGCD.apply(null,f);if(!l.equals(1))for(b.add(new u(l)),
e=0;e<c.length;e++)c[e].multiplier=c[e].multiplier.divide(l);if(!m.equals(1))for(b.add(m),a=new u(0),e=0;e<c.length;e++)a=k.add(a,k.divide(c[e],m.clone()))}}catch(t){}return a},factor:function(a,b){a.group===H&&(a=g.Utils.evaluate(a));try{if(a.group===I){b=b||new w;var c=!0;b.add(new u(a.multiplier));a.each(function(a){a.group!==B&&(c=!1);b.add(n.Factor.factor(a.clone()))});return c?a:b.toSymbol()}if(a.group===B)return a;if(a.isConstant())return g.Math2.factor(a);var d=a.power.clone();if(la(d)){a.toLinear();
b=b||new w;var f={};a=k.parse(g.Utils.subFunctions(a,f));0<L(f).length&&(b.preAdd=function(a){return k.parse(a,g.Utils.getFunctionsSubs(f))});a.isLinear()||(b.pFactor=a.power.toString(),a.toLinear());var e=S(a),h=1<e.length;h&&a.clone();if(h){var m=c=!0;a.each(function(a){a.group!==B&&(c=!1);a.multiplier.equals(1)||(m=!1)});if(c&&m)return k.pow(a,k.parse(d))}a=n.Factor.coeffFactor(a,b);a=n.Factor.powerFactor(a,b);1===e.length?(a=n.Factor.squareFree(a,b),a=n.Factor.trialAndError(a,b)):a=n.Factor.mfactor(a,
b);a=k.parse(a,g.Utils.getFunctionsSubs(f));b.add(a);var v=b.toSymbol();return k.pow(v,k.parse(d))}return a}catch(l){return a}},squareFree:function(a,b){if(a.isConstant()||a.group===B)return a;var c=(new h(a)).squareFree(),d=c[2];return 1!==d?(a=c[1].toSymbol(),a.power=a.power.multiply(new r(d)),b.add(n.Factor.factor(a)),n.Factor.squareFree(c[0].toSymbol(),b)):a},powerFactor:function(a,b){if(a.group!==J)return a;var c=g.Utils.arrayMin(L(a.symbols)),d=new u(0),f=k.parse(a.value+"^"+c);a.each(function(a){a=
k.divide(a,f.clone());d=k.add(d,a)});b.add(f);return d},coeffFactor:function(a,b){if(a.isComposite()){var c=g.Math2.QGCD.apply(null,a.coeffs());c.equals(1)||a.each(function(a){a.isComposite()?a.each(function(a){a.multiplier=a.multiplier.divide(c)}):a.multiplier=a.multiplier.divide(c)});a.updateHash();b&&b.add(new u(c))}return a},trialAndError:function(a,b){if(a.isConstant()||a.group===B)return a;var c=new h(a),d=g.Math2.ifactor(c.coeffs[0]);a=n.proots(a);for(var f=0;f<a.length;f++){var e=a[f],k=1;
if(!isNaN(e)){for(var m in d){var v=g.Utils.round(Math.log(m)/Math.log(Math.abs(e)),8);if(la(v)){e=m;k=v;break}}e=new r(e);v=[(new r(e.num)).negate()];v[k]=new r(e.den);k=h.fromArray(v,c.variable).fill();e=c.divide(k);e[1].equalsNumber(0)&&(c=e[0],b.add(k.toSymbol()))}}c.equalsNumber(1)||(c=n.Factor.search(c,b));return c.toSymbol()},search:function(a,b,c){c=c||10;var d=a.variable,f=function(e,f,g,k){return(e=h.fit(e,f,g,c,k,d))&&1<e.coeffs.length&&(f=a.divide(e),f[1].equalsNumber(0))?(b.add(e.toSymbol()),
[f[0],e]):null},e=a.coeffs[0],k=g.Math2.ifactor(e),m=a.lc(),v=g.Math2.ifactor(m),l=a.sub(c),l=n.Factor.mix(g.Math2.ifactor(l),0>l),t=Math.ceil(a.coeffs.length/2),m=m.lessThan(0),e=e.lessThan(0);v["1"]=1;for(k["1"]=1;t--;)for(var p in v)for(var r in k)for(var u=0;u<l.length;u++){var x=f(p,r,l[u],t);if(x)return a=x[0],g.Utils.isPrime(a.sub(c))||(a=n.Factor.search(a,b)),a;!x&&m?x=f(-p,r,l[u],t):!x&&e?x=f(p,-r,l[u],t):!x&&m&&e&&(x=f(-p,-r,l[u],t))}return a},mSqfrFactor:function(a,b){if(a.group!==H)for(var c=
S(a).reverse(),d=0;d<c.length;d++){do if(c[d]===a.value)b.add(a),a=new u(1);else{var f=n.Factor.coeffFactor(g.Calculus.diff(a,c[d]));if(f.equals(0))break;var e=n.div(a,f.clone());var h=e[1].equals(0);if(e[0].isConstant()){b.add(e[0]);break}h&&(b.add(e[0]),a=f)}while(h)}return a},mfactor:function(a,b){if(a.group===H)if("sqrt"===a.fname){b=new w;var c=n.Factor.common(a.args[0].clone(),b),c=n.Factor.coeffFactor(c,b);a=k.symfunction("sqrt",[c]);b.each(function(b){a=k.multiply(a,k.parse(g.Utils.format("sqrt({0})",
b)))})}else b.add(a);else{a=n.Factor.mSqfrFactor(a,b);var d=S(a);for(var f=a.collectSymbols().map(function(a){return u.unwrapSQRT(a)}),c={},e={},h=d.length,m=f.length,v=0;v<h;v++){var l=d[v];c[l]=new u(0);for(var t=0;t<m;t++){var p=f[t];if(p.contains(l)){var r=p.value===l?p.power.toDecimal():p.symbols[l].power.toDecimal();if(!e[l]||r<e[l])e[l]=r;c[l]=k.add(c[l],p.clone())}}}for(var B in c){d=k.parse(B+"^"+e[B]);d=k.expand(k.divide(c[B],d));d=n.div(a.clone(),d);if(d[0].equals(0))return d[1];if(d[1].equals(0))return b.add(d[0]),
d=n.div(a,d[0].clone())[0],d.isConstant()?(b.add(d),d):n.Factor.mfactor(d,b)}}return a}},allLinear:function(a){for(var b=a.length,c=0;c<b;c++)if(!n.isLinear(a[c]))return!1;return!0},isLinear:function(a){var b=!1,c=a.group;if(c===J||c===K){var b=!0,d;for(d in a.symbols){var c=a.symbols[d],f=c.group;if(f===H||f===Ma||f===I)b=!1;else if(f===J||f===K)b=n.isLinear(c);else if(c.group!==Aa&&"1"!==c.power.toString()){b=!1;break}}}else c===B&&1===a.power&&(b=!0);return b},gcd:function(a,b){if(a.group===I||
b.group===I){var c=k.divide(a.clone(),b.clone());c=k.multiply(b.clone(),c.getDenom());if(!c.equals(1))return c}if(a.group===H||a.group===Za)a=g.Utils.block("PARSE2NUMBER",function(){return k.parse(a)});b.group===H&&(b=g.Utils.block("PARSE2NUMBER",function(){return k.parse(b)}));if(a.isConstant()&&b.isConstant())return new u(g.Math2.QGCD(new r(+a),new r(+b)));a.length<b.length&&(c=a,a=b,b=c);c=S(a);var d=S(b);if(c.length===d.length&&1===c.length&&c[0]===d[0])return a=new h(a),b=new h(b),a.gcd(b).toSymbol();
for(;!b.equals(0);){c=b.clone();a=a.clone();d=n.div(a,c);b=d[1];if(d[0].equals(0))return new u(g.Math2.QGCD(a.multiplier,b.multiplier));a=c}var f=[];a.each(function(a){f.push(a.multiplier)});var e=g.Math2.QGCD.apply(void 0,f);e.equals(1)||a.each(function(a){a.multiplier=a.multiplier.divide(e)});return a},divide:function(a,b){a=n.div(a,b);b=k.divide(a[1],b);return k.add(a[0],b)},div:function(a,b){if(b.isConstant())return a.each(function(a){a.multiplier=a.multiplier.divide(b.multiplier)}),[a,new u(0)];
if(a.group===B&&b.group===K){var c=b.symbols[a.value];if(c&&b.isLinear()&&c.isLinear()&&a.isLinear())return[new u(1),k.subtract(a.clone(),b.clone())]}var d=a.hasFunc(),f=b.hasFunc(),c=!1;if(d||f){c=!0;var e={};a=k.parse(g.Utils.subFunctions(a,e));b=k.parse(g.Utils.subFunctions(b,e));e=g.Utils.getFunctionsSubs(e)}f=g.Utils.arrayUnique(S(a).concat(S(b)));if(1===f.length){var n=(new h(a)).divide(new h(b));f=n[0].toSymbol();d=n[1].toSymbol()}else{f.push(Oa);var d=function(a){for(var b=new u(0),c=0;c<
a.length;c++)var d=a[c].toSymbol(),b=k.add(b,d);return b},w=function(a,b){var c=Math.max.apply(null,a.terms),d=0;if(!b)for(var e=0;e<a.terms.length;e++){if(a.terms[e].equals(c)){var f=e;d++}if(1<d)return}if(b)for(e=0;e<a.terms.length;e++)if(a.terms[e].equals(c)){f=e;break}return[c,f,a]},v=function(a,b){b=b||0;var c=a[b],d=a.length;if(c){for(var e=w(c),f=b+1;f<d;f++){var g=a[f],h=c.sum.equals(g.sum);if(!h&&e)break;if(h){for(var k,l,m,n,e=c.terms.length,h=0;h<e;h++){var r=c.terms[h],u=g.terms[h];if("undefined"===
typeof k||r.greaterThan(k))k=r,m=h;if("undefined"===typeof l||u.greaterThan(l))l=u,n=h}e=k.subtract(g.terms[m]);h=l.subtract(c.terms[n]);if(h>e){e=[l,n,g];break}if(e>h){e=[k,m,c];break}}else if(e=w(g))break;e=w(g)}if(!e)return w(a[0],!0);for(var t,f=0;f<p.length;f++){d=p[f].terms;c=e[1];if(c===d.length-1)return;t=d[c];if(!t.equals(0))break}return t.equals(0)?v(a,++b):e}},l=g.Utils.toMapObj(f),t=function(a,b){return b.sum.subtract(a.sum)},f=function(a,b){if(!a||!b)return!1;for(var c=0;c<a.terms.length;c++)if(a.terms[c].lessThan(b.terms[c]))return!1;
return!0};a=a.tBase(l).sort(t);var p=b.tBase(l).sort(t),l=f(a[0],p[0])&&a[0].count>p[0].count?p:a,t=v(l),l=[];if(t){var L=t[1],t=function(a,b){return a[0].sum.equals(b[0].sum)?a.length>=b.length:!0},I=function(a,b){var c=a.len(),d=b.len();b=b.terms[L];a=a.terms[L];return d>c&&b.greaterThan(a)?d-c:b.subtract(a)};a.sort(I);p.sort(I);n=p[0];var x=a[0];var T=new m(new r(1),[],x.map);if(n.sum.greaterThan(x.sum)&&1<x.len())for(var E=0;E<x.terms.length;E++){var C=n.terms[E].subtract(x.terms[E]);if(C.equals(0))T.terms[E]=
new r(0);else{var H=C.add(new r(1));T.terms[E]=C;for(C=0;C<a.length;C++)a[C].terms[E]=a[C].terms[E].add(H)}}for(C=f(a[0],p[0]);C&&t(a,p);){n=a[0].divide(p[0]);l.push(n);a.shift();for(E=1;E<p.length;E++)for(x=p[E].multiply(n).generateImage(),H=a.length,0===H&&(x.coeff=x.coeff.neg(),a.push(x),a.sort(I)),C=0;C<H;C++){var J=a[C];if(J.getImg()===x.getImg()){J.coeff=J.coeff.subtract(x.coeff);J.coeff.equals(0)&&(g.Utils.remove(a,C),C--);break}C===H-1&&(x.coeff=x.coeff.neg(),a.push(x),a.sort(I))}C=f(a[0],
p[0]);if(!C&&a.length>=p.length)for(E=1;E<a.length;E++)if(C=f(a[E],p[0])){a.unshift(g.Utils.remove(a,E));break}}}f=d(l);d=d(a);"undefined"!==typeof T&&(T=T.toSymbol(),f=k.divide(f,T.clone()),d=k.divide(d,T))}c&&(f=k.parse(f.text(),e),d=k.parse(d.text(),e));return[f,d]},Classes:{Polynomial:h,Factors:w,MVTerm:m}};nerdamer.register([{name:"factor",visible:!0,numargs:1,build:function(){return n.Factor.factor}},{name:"gcd",visible:!0,numargs:2,build:function(){return n.gcd}},{name:"roots",visible:!0,numargs:-1,
build:function(){return n.roots}},{name:"divide",visible:!0,numargs:2,build:function(){return n.divide}},{name:"div",visible:!0,numargs:2,build:function(){return n.div}},{name:"coeffs",visible:!0,numargs:[1,2],build:function(){return n.coeffs}}]);nerdamer.api()})();
